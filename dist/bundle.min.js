/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/ts/factory/cube.ts":
/*!********************************!*\
  !*** ./src/ts/factory/cube.ts ***!
  \********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var cube_1 = __importDefault(__webpack_require__(/*! ../widgets/cube */ "./src/ts/widgets/cube.ts"));
var point_1 = __importDefault(__webpack_require__(/*! ./point */ "./src/ts/factory/point.ts"));
var CubeFactory = /** @class */ (function () {
    function CubeFactory() {
    }
    CubeFactory.create = function (relationPos, pos) {
        if (pos === void 0) { pos = point_1.default.createMin(); }
        return new cube_1.default(relationPos, pos);
    };
    return CubeFactory;
}());
exports.default = CubeFactory;


/***/ }),

/***/ "./src/ts/factory/gameWindow.ts":
/*!**************************************!*\
  !*** ./src/ts/factory/gameWindow.ts ***!
  \**************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __spreadArrays = (this && this.__spreadArrays) || function () {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var gameWindow_1 = __webpack_require__(/*! ../game/window/concrete/gameWindow */ "./src/ts/game/window/concrete/gameWindow.ts");
var GameWindowFactory = /** @class */ (function () {
    function GameWindowFactory() {
    }
    GameWindowFactory.create = function (type) {
        var _a;
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        //輸入的類別名稱為store紀錄的屬性時生成對應的Tetris
        var gameWindow = new ((_a = gameWindow_1.Types[type]).bind.apply(_a, __spreadArrays([void 0], args)))();
        return gameWindow;
    };
    return GameWindowFactory;
}());
exports.default = GameWindowFactory;


/***/ }),

/***/ "./src/ts/factory/point.ts":
/*!*********************************!*\
  !*** ./src/ts/factory/point.ts ***!
  \*********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var point_1 = __importDefault(__webpack_require__(/*! ../util/point */ "./src/ts/util/point.ts"));
var PointFactory = /** @class */ (function () {
    function PointFactory() {
    }
    PointFactory.create = function (x, y) {
        return new point_1.default(x, y);
    };
    PointFactory.createByPoint = function (p) {
        var x = p.x, y = p.y;
        return new point_1.default(x, y);
    };
    PointFactory.createMin = function () {
        return new point_1.default(Number.MIN_SAFE_INTEGER, Number.MIN_SAFE_INTEGER);
    };
    return PointFactory;
}());
exports.default = PointFactory;


/***/ }),

/***/ "./src/ts/factory/tetris.ts":
/*!**********************************!*\
  !*** ./src/ts/factory/tetris.ts ***!
  \**********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var tetrises_1 = __webpack_require__(/*! ../widgets/concrete/tetrises */ "./src/ts/widgets/concrete/tetrises.ts");
var point_1 = __importDefault(__webpack_require__(/*! ./point */ "./src/ts/factory/point.ts"));
var TetrisFactory = /** @class */ (function () {
    function TetrisFactory() {
    }
    TetrisFactory.create = function (tetrisType) {
        //輸入的類別名稱為store紀錄的屬性時生成對應的Tetris
        var tetris = new tetrises_1.Types[tetrisType]();
        return tetris;
    };
    TetrisFactory.createRandom = function (sceneColumn) {
        var tetris = TetrisFactory.randomPickTetris();
        var x = Math.floor(sceneColumn / 2 - tetris.width / 2);
        var rotateTimes = Math.floor(Math.random() * 4);
        //random rotate
        for (var i = 0; i < rotateTimes; i++) {
            tetris.rotate();
        }
        tetris.update();
        tetris.originPos = point_1.default.create(x, 0);
        return tetris;
    };
    TetrisFactory.randomPickTetris = function () {
        var types = Object.keys(tetrises_1.Types);
        var random = Math.floor(Math.random() * types.length);
        var pick = types[random];
        return TetrisFactory.create(pick);
    };
    return TetrisFactory;
}());
exports.default = TetrisFactory;


/***/ }),

/***/ "./src/ts/game/action/concrete/keyboard.ts":
/*!*************************************************!*\
  !*** ./src/ts/game/action/concrete/keyboard.ts ***!
  \*************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.actions = void 0;
var behaviorResolver_1 = __importDefault(__webpack_require__(/*! ../../behaviorResolver */ "./src/ts/game/behaviorResolver.ts"));
var moveLeft = function (event, context) {
    if (event.key === "ArrowLeft") {
        context.currTetris.left();
    }
};
var moveRight = function (event, context) {
    if (event.key === "ArrowRight") {
        context.currTetris.right();
    }
};
var rotate = function (event, context) {
    if (event.key === "ArrowUp") {
        context.currTetris.rotate();
    }
};
var hold = function (event, context) {
    if (event.key === "c" && context.canHold) {
        context.canHold = false;
        if (context.holdTetris) {
            var tempCurr = context.currTetris;
            context.currTetris = context.holdTetris;
            context.currTetris.posInitialize();
            context.holdTetris = tempCurr;
            context.tetrises = context.tetrises.filter(function (tetris) { return tetris !== context.holdTetris; });
            context.tetrises.push(context.currTetris);
        }
        else {
            context.holdTetris = context.currTetris;
            behaviorResolver_1.default.updateCurrAndPrepare(context);
            context.tetrises = context.tetrises.filter(function (tetris) { return tetris !== context.holdTetris; });
            context.currTetris.posInitialize();
            context.holdTetris.posInitialize();
        }
        context.holdWindow.render([context.holdTetris]);
    }
};
var softDrop = function (event, context) {
    if (event.key === "ArrowDown") {
        if (!context.softDown) {
            context.downTimer.ms = context.downTimer.ms - context.speedIncrease;
            context.softDown = true;
        }
    }
};
var restoreSoftDrop = function (event, context) {
    if (event.key === "ArrowDown") {
        if (context.softDown) {
            context.downTimer.ms = context.downTimer.ms + context.speedIncrease;
            context.softDown = false;
        }
    }
};
var hardDrop = function (event, context) {
    if (event.key === " ") {
        context.downTimer.ms = 0;
    }
};
var actions = {
    keydown: [moveLeft, moveRight, rotate, softDrop, hardDrop, hold],
    keyup: [restoreSoftDrop],
};
exports.actions = actions;


/***/ }),

/***/ "./src/ts/game/behaviorResolver.ts":
/*!*****************************************!*\
  !*** ./src/ts/game/behaviorResolver.ts ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var tetris_1 = __importDefault(__webpack_require__(/*! ../factory/tetris */ "./src/ts/factory/tetris.ts"));
var tetris_2 = __webpack_require__(/*! ../widgets/tetris */ "./src/ts/widgets/tetris.ts");
var cubeEliminator_1 = __importDefault(__webpack_require__(/*! ./cubeEliminator */ "./src/ts/game/cubeEliminator.ts"));
var GameBehaviorResolver = /** @class */ (function () {
    function GameBehaviorResolver() {
    }
    GameBehaviorResolver.clearCubes = function (context) {
        context.downTimer.stop();
        var clearY = cubeEliminator_1.default.clear(context.gameWindow.width, context.gameWindow.height, context.tetrises);
        context.tetrises.forEach(function (tetris) {
            tetris.cubes.forEach(function (cube) {
                //下降量
                var down = clearY.filter(function (y) { return y > cube.pos.y; }).length;
                cube.pos = cube.pos.plusY(down);
            });
        });
        context.downTimer.start();
    };
    GameBehaviorResolver.updateCurrAndPrepare = function (context) {
        context.currTetris = context.prepareTetrises.shift();
        context.tetrises.push(context.currTetris);
        context.prepareTetrises.push(tetris_1.default.createRandom(context.gameWindow.width));
        GameBehaviorResolver.renderPrepareWindow(context);
    };
    GameBehaviorResolver.windowInit = function (context) {
        context.gameWindow.clear();
        context.gameWindow.renderGrid();
        context.prepareWindow.forEach(function (w) { return w.clear(); });
        context.holdWindow.clear();
    };
    GameBehaviorResolver.renderPrepareWindow = function (context) {
        context.prepareWindow.forEach(function (w, i) {
            w.render([context.prepareTetrises[i]]);
        });
    };
    GameBehaviorResolver.currTetrisDown = function (context) {
        context.currTetris.down();
    };
    GameBehaviorResolver.nextTick = function (context, isDown) {
        if (isDown === void 0) { isDown = false; }
        //未發生碰撞
        if (!context.collision.isCollision(context.currTetris, context.tetrises)) {
            context.currTetris.update(); //更新現在位置
            return;
        }
        //collision
        if (isDown) {
            //復原timer間隔
            context.downTimer.ms = context.downInterval;
            //gameover(發生碰撞且tetris的cubes的y都小於0)
            if (context.currTetris.cubes.filter(function (cube) { return cube.pos.y >= 0; }).length === 0) {
                context.gameWindow.renderTetris(context.tetrises);
                context.gameover = true;
                return;
            }
            //消除方塊
            GameBehaviorResolver.clearCubes(context);
            //產生新方塊
            GameBehaviorResolver.updateCurrAndPrepare(context);
            context.softDown = false;
            context.canHold = true;
            //取得上移量
            var upY = GameBehaviorResolver.upAmount(context);
            //需要上移
            if (upY > 0) {
                context.currTetris.up(upY);
                context.currTetris.update(); //更新現在位置
                context.gameWindow.renderTetris(context.tetrises);
                return;
            }
        }
        context.currTetris.back();
    };
    GameBehaviorResolver.upAmount = function (context) {
        var currTetris = context.currTetris, tetrises = context.tetrises;
        var topY = Number.MAX_SAFE_INTEGER;
        var up = 0;
        // find topY
        tetrises.forEach(function (tetris) {
            if (tetris !== currTetris) {
                var cubes = tetris.cubes;
                cubes.forEach(function (c) {
                    if (c.pos.y < topY) {
                        topY = c.pos.y;
                    }
                });
            }
        });
        var shape = currTetris.currentShape;
        var width = currTetris.width, height = currTetris.height;
        var last = height - 1;
        var bottomY = currTetris.pos.y + currTetris.height;
        //shape上移量
        for (var r = last; r >= 0; r--) {
            for (var c = 0; c < width; c++) {
                if (shape[r][c] === tetris_2.ShapeValue.DEFINED) {
                    bottomY - (last - r);
                    break;
                }
            }
        }
        var reserve = 1;
        if (topY <= bottomY) {
            up = Math.abs(bottomY - topY) + reserve;
        }
        return up;
    };
    return GameBehaviorResolver;
}());
exports.default = GameBehaviorResolver;


/***/ }),

/***/ "./src/ts/game/collision.ts":
/*!**********************************!*\
  !*** ./src/ts/game/collision.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.BoundaryType = void 0;
var BoundaryType;
(function (BoundaryType) {
    BoundaryType[BoundaryType["Top"] = 0] = "Top";
    BoundaryType[BoundaryType["Bottom"] = 1] = "Bottom";
    BoundaryType[BoundaryType["Left"] = 2] = "Left";
    BoundaryType[BoundaryType["Right"] = 3] = "Right";
})(BoundaryType = exports.BoundaryType || (exports.BoundaryType = {}));
var Collision = /** @class */ (function () {
    function Collision(boundary, ignore) {
        if (ignore === void 0) { ignore = []; }
        this._boundary = boundary;
        this._ignore = ignore;
    }
    Collision.prototype.isCollisionTetris = function (target, tetrises) {
        for (var i = 0; i < tetrises.length; i++) {
            var currTetris = tetrises[i];
            if (currTetris !== target) {
                for (var j = 0; j < target.nextCubes.length; j++) {
                    if (currTetris.findCubeByPos(target.nextCubes[j].pos)) {
                        return true;
                    }
                }
            }
        }
        return false;
    };
    Collision.prototype.isCollisionBoundary = function (target) {
        var _a = this._boundary, top = _a.top, bottom = _a.bottom, left = _a.left, right = _a.right;
        for (var i = 0; i < target.nextCubes.length; i++) {
            var _b = target.nextCubes[i].pos, x = _b.x, y = _b.y;
            if ((x < left && !this._ignore.includes(BoundaryType.Left)) ||
                (x > right && !this._ignore.includes(BoundaryType.Right)) ||
                (y < top && !this._ignore.includes(BoundaryType.Top)) ||
                (y > bottom && !this._ignore.includes(BoundaryType.Bottom))) {
                return true;
            }
        }
        return false;
    };
    Collision.prototype.isCollision = function (target, tetrises) {
        return this.isCollisionBoundary(target) || this.isCollisionTetris(target, tetrises);
    };
    return Collision;
}());
exports.default = Collision;


/***/ }),

/***/ "./src/ts/game/context.ts":
/*!********************************!*\
  !*** ./src/ts/game/context.ts ***!
  \********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var tetris_1 = __importDefault(__webpack_require__(/*! ../factory/tetris */ "./src/ts/factory/tetris.ts"));
var timer_1 = __importDefault(__webpack_require__(/*! ../util/timer */ "./src/ts/util/timer.ts"));
var collision_1 = __importStar(__webpack_require__(/*! ./collision */ "./src/ts/game/collision.ts"));
var GameContext = /** @class */ (function () {
    function GameContext(gameWindow, prepareWindow, holdWindow, downUpdate) {
        var _this = this;
        this.downInterval = 450;
        this.renderInterval = 50;
        this.speedIncrease = 400;
        this.tetrises = [];
        this.prepareTetrises = [];
        this.holdTetris = null;
        this.softDown = false;
        this.canHold = true;
        this.gameover = false;
        this.gameWindow = gameWindow;
        this.prepareWindow = prepareWindow;
        this.holdWindow = holdWindow;
        this.currTetris = tetris_1.default.createRandom(this.gameWindow.width);
        this.tetrises.push(this.currTetris);
        for (var i = 0; i < this.prepareWindow.length; i++) {
            this.prepareTetrises.push(tetris_1.default.createRandom(this.gameWindow.width));
        }
        this.downTimer = new timer_1.default(function () {
            downUpdate();
        }, this.downInterval);
        this.renderTimer = new timer_1.default(function () {
            ;
            _this.gameWindow.render(_this.tetrises);
        }, this.renderInterval);
        this.collision = new collision_1.default({
            top: 0,
            bottom: gameWindow.height - 1,
            left: 0,
            right: gameWindow.width - 1
        }, [
            collision_1.BoundaryType.Top
        ]);
    }
    return GameContext;
}());
exports.default = GameContext;


/***/ }),

/***/ "./src/ts/game/cubeEliminator.ts":
/*!***************************************!*\
  !*** ./src/ts/game/cubeEliminator.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var array_1 = __importDefault(__webpack_require__(/*! ../helper/array */ "./src/ts/helper/array.ts"));
var CubeEliminator = /** @class */ (function () {
    function CubeEliminator() {
    }
    CubeEliminator.clear = function (sceneWidth, sceneHeight, tetrises) {
        var clearY = CubeEliminator.clearableCubes(sceneWidth, sceneHeight, tetrises);
        CubeEliminator.removeClearableTetris(tetrises);
        return clearY;
    };
    //回傳這次應clear的y座標
    CubeEliminator.clearableCubes = function (sceneWidth, sceneHeight, tetrises) {
        var count = array_1.default.create2D(sceneHeight);
        var clearY = [];
        tetrises.forEach(function (tetris) {
            tetris.cubes.forEach(function (cube) {
                //若cube沒被清除則加入
                if (!cube.isClear && cube.pos.y >= 0) {
                    count[cube.pos.y].push(cube);
                }
            });
        });
        count.forEach(function (row, r) {
            //該列都有元素
            if (row.length === sceneWidth) {
                row.forEach(function (cube) {
                    cube.isClear = true;
                });
                clearY.push(r);
            }
        });
        return clearY;
    };
    CubeEliminator.removeClearableTetris = function (tetrises) {
        tetrises.forEach(function (target) {
            var existCubes = target.cubes.filter(function (cube) {
                return cube.isClear === false;
            });
            //cube.isClear 全是 false
            if (existCubes.length === 0) {
                //移除該tetris
                tetrises = tetrises.filter(function (tetris) { return tetris !== target; });
            }
        });
    };
    return CubeEliminator;
}());
exports.default = CubeEliminator;


/***/ }),

/***/ "./src/ts/game/game.ts":
/*!*****************************!*\
  !*** ./src/ts/game/game.ts ***!
  \*****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var context_1 = __importDefault(__webpack_require__(/*! ./context */ "./src/ts/game/context.ts"));
var behaviorResolver_1 = __importDefault(__webpack_require__(/*! ./behaviorResolver */ "./src/ts/game/behaviorResolver.ts"));
var keyboard_1 = __webpack_require__(/*! ./action/concrete/keyboard */ "./src/ts/game/action/concrete/keyboard.ts");
var Game = /** @class */ (function () {
    function Game(gameWindow, prepareWindow, holdWindow) {
        var _this = this;
        this.userKeyDownBehavior = function (event) {
            keyboard_1.actions.keydown.forEach(function (action) {
                action(event, _this._context);
            });
            behaviorResolver_1.default.nextTick(_this._context);
        };
        this.userKeyUpBehavior = function (event) {
            keyboard_1.actions.keyup.forEach(function (action) {
                action(event, _this._context);
            });
            behaviorResolver_1.default.nextTick(_this._context);
        };
        this.update = function () {
            behaviorResolver_1.default.currTetrisDown(_this._context);
            behaviorResolver_1.default.nextTick(_this._context, true);
            if (_this._context.gameover) {
                _this.stop();
                alert("gameover");
            }
        };
        this._context = new context_1.default(gameWindow, prepareWindow, holdWindow, this.update);
    }
    Game.prototype.registerUserBehavior = function () {
        document.addEventListener("keydown", this.userKeyDownBehavior);
        document.addEventListener("keyup", this.userKeyUpBehavior);
    };
    Game.prototype.removeUserBehavior = function () {
        document.removeEventListener("keydown", this.userKeyDownBehavior);
        document.removeEventListener("keyup", this.userKeyUpBehavior);
    };
    Game.prototype.start = function () {
        if (this._context.gameover) {
            this.initialize();
        }
        this._context.downTimer.start();
        this._context.renderTimer.start();
        behaviorResolver_1.default.renderPrepareWindow(this._context);
        this.registerUserBehavior();
    };
    Game.prototype.stop = function () {
        this._context.downTimer.stop();
        this._context.renderTimer.stop();
        this.removeUserBehavior();
    };
    Game.prototype.initialize = function () {
        var _a = this._context, gameWindow = _a.gameWindow, prepareWindow = _a.prepareWindow, holdWindow = _a.holdWindow;
        this._context = new context_1.default(gameWindow, prepareWindow, holdWindow, this.update);
        behaviorResolver_1.default.windowInit(this._context);
        this.removeUserBehavior();
    };
    return Game;
}());
exports.default = Game;


/***/ }),

/***/ "./src/ts/game/window/concrete/gameWindow.ts":
/*!***************************************************!*\
  !*** ./src/ts/game/window/concrete/gameWindow.ts ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Types = exports.HoldWindow = exports.PrepareWindow = exports.MainWindow = void 0;
var gameWindow_1 = __importDefault(__webpack_require__(/*! ../gameWindow */ "./src/ts/game/window/gameWindow.ts"));
var MainWindow = /** @class */ (function (_super) {
    __extends(MainWindow, _super);
    function MainWindow() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MainWindow.prototype.renderTetris = function (tetrises) {
        var _this = this;
        this._context.strokeStyle = "#555555";
        tetrises.forEach(function (tetris) {
            tetris.cubes.forEach(function (cube) {
                if (!cube.isClear) {
                    var p = cube.pos;
                    _this._context.beginPath();
                    var x = p.x * _this._unit;
                    var y = p.y * _this._unit;
                    _this._context.rect(x, y, _this._unit, _this._unit);
                    _this._context.fillStyle = tetris.color;
                    _this._context.fill();
                    _this._context.stroke();
                }
            });
        });
    };
    MainWindow.prototype.resize = function () {
        var width = this.width * this._unit;
        var height = this.height * this._unit;
        this._canvas.setAttribute("width", width.toString());
        this._canvas.setAttribute("height", height.toString());
    };
    MainWindow.prototype.renderDefine = function (tetrises) {
        this.renderTetris(tetrises);
        this.renderGrid();
    };
    MainWindow.prototype.initialize = function () {
        this.resize();
        this.renderGrid();
    };
    return MainWindow;
}(gameWindow_1.default));
exports.MainWindow = MainWindow;
var NotGridWindow = /** @class */ (function (_super) {
    __extends(NotGridWindow, _super);
    function NotGridWindow(canvas, unit) {
        return _super.call(this, canvas, 0, 0, unit) || this;
    }
    NotGridWindow.prototype.renderTetris = function (tetrises) {
        var _this = this;
        var tetris = tetrises[0];
        this._context.strokeStyle = "#555555";
        tetris.cubes.forEach(function (cube) {
            var tp = tetris.pos;
            var p = cube.pos;
            _this._context.beginPath();
            //偏移
            var x = (p.x - tp.x) * _this._unit;
            var y = (p.y - tp.y) * _this._unit;
            _this._context.rect(x, y, _this._unit, _this._unit);
            _this._context.fillStyle = tetris.color;
            _this._context.fill();
            _this._context.stroke();
        });
    };
    NotGridWindow.prototype.resize = function (tetris) {
        var width = tetris.originWidth * this._unit;
        var height = tetris.originHeight * this._unit;
        this._canvas.setAttribute("width", width.toString());
        this._canvas.setAttribute("height", height.toString());
    };
    NotGridWindow.prototype.renderDefine = function (tetrises) {
        this.resize(tetrises[0]);
        this.renderTetris(tetrises);
    };
    return NotGridWindow;
}(gameWindow_1.default));
var PrepareWindow = /** @class */ (function (_super) {
    __extends(PrepareWindow, _super);
    function PrepareWindow() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return PrepareWindow;
}(NotGridWindow));
exports.PrepareWindow = PrepareWindow;
var HoldWindow = /** @class */ (function (_super) {
    __extends(HoldWindow, _super);
    function HoldWindow() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return HoldWindow;
}(NotGridWindow));
exports.HoldWindow = HoldWindow;
exports.Types = { MainWindow: MainWindow, PrepareWindow: PrepareWindow, HoldWindow: HoldWindow };


/***/ }),

/***/ "./src/ts/game/window/gameWindow.ts":
/*!******************************************!*\
  !*** ./src/ts/game/window/gameWindow.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
var GameWindow = /** @class */ (function () {
    function GameWindow(canvas, width, height, unit) {
        this._canvas = canvas;
        this._context = canvas.getContext("2d");
        this._width = width;
        this._height = height;
        this._unit = unit;
    }
    Object.defineProperty(GameWindow.prototype, "width", {
        get: function () {
            return this._width;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(GameWindow.prototype, "height", {
        get: function () {
            return this._height;
        },
        enumerable: false,
        configurable: true
    });
    GameWindow.prototype.renderGrid = function () {
        this._context.strokeStyle = "#777777";
        for (var y = 0; y < this.height; y++) {
            this._context.beginPath();
            this._context.moveTo(0, y * this._unit + this._unit);
            this._context.lineTo(this.width * this._unit, y * this._unit + this._unit);
            this._context.stroke();
        }
        for (var x = 0; x < this.width; x++) {
            this._context.beginPath();
            this._context.moveTo(x * this._unit + this._unit, 0);
            this._context.lineTo(x * this._unit + this._unit, this._canvas.height);
            this._context.stroke();
        }
    };
    GameWindow.prototype.render = function (tetrises) {
        this.clear();
        this.renderDefine(tetrises);
    };
    GameWindow.prototype.clear = function () {
        this._context.clearRect(0, 0, this._canvas.width, this._canvas.height);
    };
    return GameWindow;
}());
exports.default = GameWindow;


/***/ }),

/***/ "./src/ts/helper/array.ts":
/*!********************************!*\
  !*** ./src/ts/helper/array.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
var ArrayHelper = /** @class */ (function () {
    function ArrayHelper() {
    }
    ArrayHelper.create2D = function (row, col, fill) {
        var arr = [];
        for (var r = 0; r < row; r++) {
            arr.push([]);
            if (col) {
                if (fill) {
                    arr[r] = new Array(col).fill(fill);
                }
            }
        }
        return arr;
    };
    return ArrayHelper;
}());
exports.default = ArrayHelper;


/***/ }),

/***/ "./src/ts/main.ts":
/*!************************!*\
  !*** ./src/ts/main.ts ***!
  \************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var gameWindow_1 = __importDefault(__webpack_require__(/*! ./factory/gameWindow */ "./src/ts/factory/gameWindow.ts"));
var gameWindow_2 = __webpack_require__(/*! ./game/window/concrete/gameWindow */ "./src/ts/game/window/concrete/gameWindow.ts");
var game_1 = __importDefault(__webpack_require__(/*! ./game/game */ "./src/ts/game/game.ts"));
// 禁止特定按鍵觸發頁面滾動
window.addEventListener("keydown", function (event) {
    var disableKey = ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight", " "];
    if (disableKey.includes(event.key)) {
        event.preventDefault();
    }
});
var canvas = document.querySelector("#gameWindow");
var prepareCanvas = document.querySelectorAll("#next-area > .canvas-wrapper > canvas");
var hold = document.querySelector("#hold");
var start = document.querySelector("#start");
var stop = document.querySelector("#stop");
var reset = document.querySelector("#reset");
var unit = 20;
var unit2 = 13;
var gameWindow = gameWindow_1.default.create(gameWindow_2.MainWindow.name, canvas, 14, 24, unit);
var prepareWindows = [];
prepareCanvas.forEach(function (c) {
    c.setAttribute("height", (unit2 * 4).toString());
    c.setAttribute("height", (unit2 * 4).toString());
    prepareWindows.push(gameWindow_1.default.create(gameWindow_2.PrepareWindow.name, c, unit2));
});
hold.setAttribute("height", (unit2 * 4).toString());
hold.setAttribute("height", (unit2 * 4).toString());
var holdWindow = gameWindow_1.default.create(gameWindow_2.HoldWindow.name, hold, unit2);
gameWindow.initialize();
var game = new game_1.default(gameWindow, prepareWindows, holdWindow);
start.addEventListener("click", function () {
    game.start();
    start.style.color = "white";
    stop.style.color = "#888888";
    reset.style.color = "#888888";
});
stop.addEventListener("click", function () {
    game.stop();
    stop.style.color = "white";
    start.style.color = "#888888";
    reset.style.color = "#888888";
});
reset.addEventListener("click", function (event) {
    game.stop();
    game.initialize();
    reset.style.color = "white";
    start.style.color = "#888888";
    stop.style.color = "#888888";
});
window.addEventListener("keydown", function (event) {
    if (event.key === "p") {
        stop.click();
    }
    if (event.key === "Enter") {
        start.click();
    }
    if (event.key === "r") {
        reset.click();
    }
});


/***/ }),

/***/ "./src/ts/util/point.ts":
/*!******************************!*\
  !*** ./src/ts/util/point.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
var Point = /** @class */ (function () {
    function Point(x, y) {
        this._x = x;
        this._y = y;
    }
    Object.defineProperty(Point.prototype, "x", {
        get: function () {
            return this._x;
        },
        enumerable: false,
        configurable: true
    });
    ;
    Object.defineProperty(Point.prototype, "y", {
        get: function () {
            return this._y;
        },
        enumerable: false,
        configurable: true
    });
    Point.prototype.plus = function (p) {
        var x = this._x + p.x;
        var y = this._y + p.y;
        return new Point(x, y);
    };
    Point.prototype.plusWith = function (x, y) {
        return new Point(this._x + x, this._y + y);
    };
    Point.prototype.subtract = function (p) {
        var x = this._x - p.x;
        var y = this._y - p.y;
        return new Point(x, y);
    };
    Point.prototype.subtractWith = function (x, y) {
        return new Point(this._x - x, this._y - y);
    };
    Point.prototype.plusX = function (x) {
        return new Point(this._x + x, this.y);
    };
    Point.prototype.plusY = function (y) {
        return new Point(this.x, this._y + y);
    };
    Point.prototype.subtractX = function (x) {
        return new Point(this._x - x, this.y);
    };
    Point.prototype.subtractY = function (y) {
        return new Point(this.x, this._y - y);
    };
    Point.prototype.equal = function (p) {
        return this.x === p.x && this.y === p.y;
    };
    return Point;
}());
exports.default = Point;


/***/ }),

/***/ "./src/ts/util/timer.ts":
/*!******************************!*\
  !*** ./src/ts/util/timer.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
var Timer = /** @class */ (function () {
    function Timer(handle, ms) {
        this._timerID = null;
        this._ms = ms;
        this._handle = handle;
    }
    Object.defineProperty(Timer.prototype, "ms", {
        get: function () {
            return this._ms;
        },
        set: function (val) {
            this._ms = val;
            this.stop();
            this.start();
        },
        enumerable: false,
        configurable: true
    });
    Timer.prototype.start = function () {
        if (!this._timerID) {
            this._timerID = setInterval(this._handle, this._ms);
        }
    };
    Timer.prototype.stop = function () {
        if (this._timerID) {
            clearInterval(this._timerID);
            this._timerID = null;
        }
    };
    return Timer;
}());
exports.default = Timer;


/***/ }),

/***/ "./src/ts/widgets/concrete/tetrises.ts":
/*!*********************************************!*\
  !*** ./src/ts/widgets/concrete/tetrises.ts ***!
  \*********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Types = exports.ZTetris = exports.TTetris = exports.STetris = exports.OTetris = exports.LTetris = exports.JTetris = exports.ITetris = void 0;
var tetris_1 = __importDefault(__webpack_require__(/*! ../tetris */ "./src/ts/widgets/tetris.ts"));
var ITetris = /** @class */ (function (_super) {
    __extends(ITetris, _super);
    function ITetris() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ITetris.prototype.colorDefine = function () {
        return "#42b0f5";
    };
    ITetris.prototype.shapeDefine = function () {
        return [
            [0, 0, 0, 0],
            [1, 1, 1, 1],
            [0, 0, 0, 0],
            [0, 0, 0, 0],
        ];
    };
    return ITetris;
}(tetris_1.default));
exports.ITetris = ITetris;
var JTetris = /** @class */ (function (_super) {
    __extends(JTetris, _super);
    function JTetris() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    JTetris.prototype.colorDefine = function () {
        return "#3874ff";
    };
    JTetris.prototype.shapeDefine = function () {
        return [
            [1, 0, 0],
            [1, 1, 1],
            [0, 0, 0],
        ];
    };
    return JTetris;
}(tetris_1.default));
exports.JTetris = JTetris;
var LTetris = /** @class */ (function (_super) {
    __extends(LTetris, _super);
    function LTetris() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LTetris.prototype.colorDefine = function () {
        return "#ff8e24";
    };
    LTetris.prototype.shapeDefine = function () {
        return [
            [0, 0, 1],
            [1, 1, 1],
            [0, 0, 0],
        ];
    };
    return LTetris;
}(tetris_1.default));
exports.LTetris = LTetris;
var OTetris = /** @class */ (function (_super) {
    __extends(OTetris, _super);
    function OTetris() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    OTetris.prototype.colorDefine = function () {
        return "#fff242";
    };
    OTetris.prototype.shapeDefine = function () {
        return [
            [1, 1],
            [1, 1],
        ];
    };
    return OTetris;
}(tetris_1.default));
exports.OTetris = OTetris;
var STetris = /** @class */ (function (_super) {
    __extends(STetris, _super);
    function STetris() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    STetris.prototype.colorDefine = function () {
        return "#00de3f";
    };
    STetris.prototype.shapeDefine = function () {
        return [
            [0, 1, 1],
            [1, 1, 0],
            [0, 0, 0],
        ];
    };
    return STetris;
}(tetris_1.default));
exports.STetris = STetris;
var TTetris = /** @class */ (function (_super) {
    __extends(TTetris, _super);
    function TTetris() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TTetris.prototype.colorDefine = function () {
        return "#e557f7";
    };
    TTetris.prototype.shapeDefine = function () {
        return [
            [0, 1, 0],
            [1, 1, 1],
            [0, 0, 0],
        ];
    };
    return TTetris;
}(tetris_1.default));
exports.TTetris = TTetris;
var ZTetris = /** @class */ (function (_super) {
    __extends(ZTetris, _super);
    function ZTetris() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ZTetris.prototype.colorDefine = function () {
        return "#ff1f1f";
    };
    ZTetris.prototype.shapeDefine = function () {
        return [
            [1, 1, 0],
            [0, 1, 1],
            [0, 0, 0],
        ];
    };
    return ZTetris;
}(tetris_1.default));
exports.ZTetris = ZTetris;
exports.Types = {
    ITetris: ITetris,
    JTetris: JTetris,
    LTetris: LTetris,
    OTetris: OTetris,
    STetris: STetris,
    TTetris: TTetris,
    ZTetris: ZTetris
};


/***/ }),

/***/ "./src/ts/widgets/cube.ts":
/*!********************************!*\
  !*** ./src/ts/widgets/cube.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
var Cube = /** @class */ (function () {
    function Cube(relationPos, pos) {
        this.isClear = false;
        this.relationPos = relationPos;
        this.pos = pos;
    }
    return Cube;
}());
exports.default = Cube;


/***/ }),

/***/ "./src/ts/widgets/tetris.ts":
/*!**********************************!*\
  !*** ./src/ts/widgets/tetris.ts ***!
  \**********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.ShapeValue = void 0;
var cube_1 = __importDefault(__webpack_require__(/*! ../factory/cube */ "./src/ts/factory/cube.ts"));
var point_1 = __importDefault(__webpack_require__(/*! ../factory/point */ "./src/ts/factory/point.ts"));
var array_1 = __importDefault(__webpack_require__(/*! ../helper/array */ "./src/ts/helper/array.ts"));
var ShapeValue;
(function (ShapeValue) {
    ShapeValue[ShapeValue["UNDEFINED"] = -1] = "UNDEFINED";
    ShapeValue[ShapeValue["DEFINED"] = 1] = "DEFINED";
    ShapeValue[ShapeValue["EMPTY"] = 0] = "EMPTY";
})(ShapeValue = exports.ShapeValue || (exports.ShapeValue = {}));
var Tetris = /** @class */ (function () {
    function Tetris() {
        this._originPos = point_1.default.createMin();
        this._pos = point_1.default.createMin();
        this._nextPos = point_1.default.createMin();
        this._cubes = [];
        this._color = this.colorDefine();
        this._originShape = this.shapeDefine();
        this._nextShape = this._originShape.slice();
        this._currentShape = this._originShape.slice();
    }
    Object.defineProperty(Tetris.prototype, "width", {
        get: function () {
            return this._currentShape[0].length;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "height", {
        get: function () {
            return this._currentShape.length;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "pos", {
        get: function () {
            return this._pos;
        },
        set: function (value) {
            this._pos = value;
            this._cubes = this.generateCubes(this.pos, this._currentShape);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "originPos", {
        get: function () {
            return this._originPos;
        },
        set: function (p) {
            if (this.originPos.x === Number.MIN_SAFE_INTEGER && this.originPos.y === Number.MIN_SAFE_INTEGER) {
                this._originPos = point_1.default.createByPoint(p);
                this.pos = point_1.default.createByPoint(p);
                this._nextPos = point_1.default.createByPoint(p);
            }
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "originWidth", {
        get: function () {
            return this._originShape[0].length;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "originHeight", {
        get: function () {
            return this._originShape.length;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "cubes", {
        get: function () {
            return this._cubes;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "nextCubes", {
        get: function () {
            return this.generateCubes(this._nextPos, this._nextShape);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "color", {
        get: function () {
            return this._color;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Tetris.prototype, "currentShape", {
        get: function () {
            return this._currentShape.slice();
        },
        enumerable: false,
        configurable: true
    });
    Tetris.prototype.generateCubes = function (pos, shape) {
        var cubes = [];
        shape.forEach(function (row, r) {
            row.forEach(function (element, c) {
                if (element === ShapeValue.DEFINED) {
                    var relationPos = point_1.default.create(c, r);
                    var position = relationPos.plus(pos);
                    cubes.push(cube_1.default.create(relationPos, position));
                }
            });
        });
        return cubes;
    };
    Tetris.prototype.findCubeByPos = function (pos, isClear) {
        if (isClear === void 0) { isClear = false; }
        var cube = this._cubes.find(function (cube) {
            return cube.pos.equal(pos) && cube.isClear === isClear;
        });
        return cube;
    };
    Tetris.prototype.findCube = function (cube) {
        return this._cubes.find(function (el) { return el === cube; });
    };
    Tetris.prototype.rotate = function () {
        var row = this.height;
        var col = this.width;
        var newShape = array_1.default.create2D(col, row, ShapeValue.EMPTY);
        var newRow = 0;
        for (var r = 0; r < row; r++) {
            newRow = 0;
            for (var c = 0; c < col; c++) {
                var val = this._currentShape[r][c];
                newShape[newRow][row - r - 1] = val;
                if (val === ShapeValue.DEFINED) {
                    var originCube = this.findCubeByPos(point_1.default.create(c, r));
                    if (originCube) {
                        var newCube = cube_1.default.create(point_1.default.create(r, newRow));
                        //tetris左上角之座標 + 偏移量
                        newCube.pos = this.pos.plusWith(r, c);
                    }
                }
                newRow++;
            }
        }
        this._nextShape = newShape;
    };
    Tetris.prototype.left = function (amount) {
        if (amount === void 0) { amount = 1; }
        this._nextPos = this.pos.subtractX(amount);
    };
    Tetris.prototype.right = function (amount) {
        if (amount === void 0) { amount = 1; }
        this._nextPos = this.pos.plusX(amount);
    };
    Tetris.prototype.up = function (amount) {
        if (amount === void 0) { amount = 1; }
        this._nextPos = this.pos.subtractY(amount);
    };
    Tetris.prototype.down = function (amount) {
        if (amount === void 0) { amount = 1; }
        this._nextPos = this.pos.plusY(amount);
    };
    Tetris.prototype.update = function () {
        this._currentShape = this._nextShape.slice();
        this.pos = point_1.default.createByPoint(this._nextPos);
    };
    Tetris.prototype.back = function () {
        this._nextShape = this._currentShape.slice();
        this._nextPos = point_1.default.createByPoint(this.pos);
    };
    Tetris.prototype.posInitialize = function () {
        this.pos = point_1.default.createByPoint(this.originPos);
        this._nextPos = point_1.default.createByPoint(this.originPos);
    };
    return Tetris;
}());
exports.default = Tetris;


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		if(__webpack_module_cache__[moduleId]) {
/******/ 			return __webpack_module_cache__[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		var execOptions = { id: moduleId, module: module, factory: __webpack_modules__[moduleId], require: __webpack_require__ };
/******/ 		__webpack_require__.i.forEach(function(handler) { handler(execOptions); });
/******/ 		module = execOptions.module;
/******/ 		execOptions.factory.call(module.exports, module, module.exports, execOptions.require);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = __webpack_modules__;
/******/ 	
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = __webpack_module_cache__;
/******/ 	
/******/ 	// expose the module execution interceptor
/******/ 	__webpack_require__.i = [];
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/get javascript update chunk filename */
/******/ 	(() => {
/******/ 		// This function allow to reference all chunks
/******/ 		__webpack_require__.hu = (chunkId) => {
/******/ 			// return url for filenames based on template
/******/ 			return "" + chunkId + "." + __webpack_require__.h() + ".hot-update.js";
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/get update manifest filename */
/******/ 	(() => {
/******/ 		__webpack_require__.hmrF = () => ("main." + __webpack_require__.h() + ".hot-update.json");
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/getFullHash */
/******/ 	(() => {
/******/ 		__webpack_require__.h = () => ("abba5f5e62d599434b90")
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/load script */
/******/ 	(() => {
/******/ 		var inProgress = {};
/******/ 		var dataWebpackPrefix = "Tetris:";
/******/ 		// loadScript function to load a script via script tag
/******/ 		__webpack_require__.l = (url, done, key, chunkId) => {
/******/ 			if(inProgress[url]) { inProgress[url].push(done); return; }
/******/ 			var script, needAttach;
/******/ 			if(key !== undefined) {
/******/ 				var scripts = document.getElementsByTagName("script");
/******/ 				for(var i = 0; i < scripts.length; i++) {
/******/ 					var s = scripts[i];
/******/ 					if(s.getAttribute("src") == url || s.getAttribute("data-webpack") == dataWebpackPrefix + key) { script = s; break; }
/******/ 				}
/******/ 			}
/******/ 			if(!script) {
/******/ 				needAttach = true;
/******/ 				script = document.createElement('script');
/******/ 		
/******/ 				script.charset = 'utf-8';
/******/ 				script.timeout = 120;
/******/ 				if (__webpack_require__.nc) {
/******/ 					script.setAttribute("nonce", __webpack_require__.nc);
/******/ 				}
/******/ 				script.setAttribute("data-webpack", dataWebpackPrefix + key);
/******/ 				script.src = url;
/******/ 			}
/******/ 			inProgress[url] = [done];
/******/ 			var onScriptComplete = (prev, event) => {
/******/ 				// avoid mem leaks in IE.
/******/ 				script.onerror = script.onload = null;
/******/ 				clearTimeout(timeout);
/******/ 				var doneFns = inProgress[url];
/******/ 				delete inProgress[url];
/******/ 				script.parentNode && script.parentNode.removeChild(script);
/******/ 				doneFns && doneFns.forEach((fn) => (fn(event)));
/******/ 				if(prev) return prev(event);
/******/ 			}
/******/ 			;
/******/ 			var timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);
/******/ 			script.onerror = onScriptComplete.bind(null, script.onerror);
/******/ 			script.onload = onScriptComplete.bind(null, script.onload);
/******/ 			needAttach && document.head.appendChild(script);
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hot module replacement */
/******/ 	(() => {
/******/ 		var currentModuleData = {};
/******/ 		var installedModules = __webpack_require__.c;
/******/ 		
/******/ 		// module and require creation
/******/ 		var currentChildModule;
/******/ 		var currentParents = [];
/******/ 		
/******/ 		// status
/******/ 		var registeredStatusHandlers = [];
/******/ 		var currentStatus = "idle";
/******/ 		
/******/ 		// while downloading
/******/ 		var blockingPromises;
/******/ 		
/******/ 		// The update info
/******/ 		var currentUpdateApplyHandlers;
/******/ 		var queuedInvalidatedModules;
/******/ 		
/******/ 		// eslint-disable-next-line no-unused-vars
/******/ 		__webpack_require__.hmrD = currentModuleData;
/******/ 		
/******/ 		__webpack_require__.i.push(function (options) {
/******/ 			var module = options.module;
/******/ 			var require = createRequire(options.require, options.id);
/******/ 			module.hot = createModuleHotObject(options.id, module);
/******/ 			module.parents = currentParents;
/******/ 			module.children = [];
/******/ 			currentParents = [];
/******/ 			options.require = require;
/******/ 		});
/******/ 		
/******/ 		__webpack_require__.hmrC = {};
/******/ 		__webpack_require__.hmrI = {};
/******/ 		
/******/ 		function createRequire(require, moduleId) {
/******/ 			var me = installedModules[moduleId];
/******/ 			if (!me) return require;
/******/ 			var fn = function (request) {
/******/ 				if (me.hot.active) {
/******/ 					if (installedModules[request]) {
/******/ 						var parents = installedModules[request].parents;
/******/ 						if (parents.indexOf(moduleId) === -1) {
/******/ 							parents.push(moduleId);
/******/ 						}
/******/ 					} else {
/******/ 						currentParents = [moduleId];
/******/ 						currentChildModule = request;
/******/ 					}
/******/ 					if (me.children.indexOf(request) === -1) {
/******/ 						me.children.push(request);
/******/ 					}
/******/ 				} else {
/******/ 					console.warn(
/******/ 						"[HMR] unexpected require(" +
/******/ 							request +
/******/ 							") from disposed module " +
/******/ 							moduleId
/******/ 					);
/******/ 					currentParents = [];
/******/ 				}
/******/ 				return require(request);
/******/ 			};
/******/ 			var createPropertyDescriptor = function (name) {
/******/ 				return {
/******/ 					configurable: true,
/******/ 					enumerable: true,
/******/ 					get: function () {
/******/ 						return require[name];
/******/ 					},
/******/ 					set: function (value) {
/******/ 						require[name] = value;
/******/ 					}
/******/ 				};
/******/ 			};
/******/ 			for (var name in require) {
/******/ 				if (Object.prototype.hasOwnProperty.call(require, name) && name !== "e") {
/******/ 					Object.defineProperty(fn, name, createPropertyDescriptor(name));
/******/ 				}
/******/ 			}
/******/ 			fn.e = function (chunkId) {
/******/ 				return trackBlockingPromise(require.e(chunkId));
/******/ 			};
/******/ 			return fn;
/******/ 		}
/******/ 		
/******/ 		function createModuleHotObject(moduleId, me) {
/******/ 			var hot = {
/******/ 				// private stuff
/******/ 				_acceptedDependencies: {},
/******/ 				_declinedDependencies: {},
/******/ 				_selfAccepted: false,
/******/ 				_selfDeclined: false,
/******/ 				_selfInvalidated: false,
/******/ 				_disposeHandlers: [],
/******/ 				_main: currentChildModule !== moduleId,
/******/ 				_requireSelf: function () {
/******/ 					currentParents = me.parents.slice();
/******/ 					currentChildModule = moduleId;
/******/ 					__webpack_require__(moduleId);
/******/ 				},
/******/ 		
/******/ 				// Module API
/******/ 				active: true,
/******/ 				accept: function (dep, callback) {
/******/ 					if (dep === undefined) hot._selfAccepted = true;
/******/ 					else if (typeof dep === "function") hot._selfAccepted = dep;
/******/ 					else if (typeof dep === "object" && dep !== null)
/******/ 						for (var i = 0; i < dep.length; i++)
/******/ 							hot._acceptedDependencies[dep[i]] = callback || function () {};
/******/ 					else hot._acceptedDependencies[dep] = callback || function () {};
/******/ 				},
/******/ 				decline: function (dep) {
/******/ 					if (dep === undefined) hot._selfDeclined = true;
/******/ 					else if (typeof dep === "object" && dep !== null)
/******/ 						for (var i = 0; i < dep.length; i++)
/******/ 							hot._declinedDependencies[dep[i]] = true;
/******/ 					else hot._declinedDependencies[dep] = true;
/******/ 				},
/******/ 				dispose: function (callback) {
/******/ 					hot._disposeHandlers.push(callback);
/******/ 				},
/******/ 				addDisposeHandler: function (callback) {
/******/ 					hot._disposeHandlers.push(callback);
/******/ 				},
/******/ 				removeDisposeHandler: function (callback) {
/******/ 					var idx = hot._disposeHandlers.indexOf(callback);
/******/ 					if (idx >= 0) hot._disposeHandlers.splice(idx, 1);
/******/ 				},
/******/ 				invalidate: function () {
/******/ 					this._selfInvalidated = true;
/******/ 					switch (currentStatus) {
/******/ 						case "idle":
/******/ 							currentUpdateApplyHandlers = [];
/******/ 							Object.keys(__webpack_require__.hmrI).forEach(function (key) {
/******/ 								__webpack_require__.hmrI[key](
/******/ 									moduleId,
/******/ 									currentUpdateApplyHandlers
/******/ 								);
/******/ 							});
/******/ 							setStatus("ready");
/******/ 							break;
/******/ 						case "ready":
/******/ 							Object.keys(__webpack_require__.hmrI).forEach(function (key) {
/******/ 								__webpack_require__.hmrI[key](
/******/ 									moduleId,
/******/ 									currentUpdateApplyHandlers
/******/ 								);
/******/ 							});
/******/ 							break;
/******/ 						case "prepare":
/******/ 						case "check":
/******/ 						case "dispose":
/******/ 						case "apply":
/******/ 							(queuedInvalidatedModules = queuedInvalidatedModules || []).push(
/******/ 								moduleId
/******/ 							);
/******/ 							break;
/******/ 						default:
/******/ 							// ignore requests in error states
/******/ 							break;
/******/ 					}
/******/ 				},
/******/ 		
/******/ 				// Management API
/******/ 				check: hotCheck,
/******/ 				apply: hotApply,
/******/ 				status: function (l) {
/******/ 					if (!l) return currentStatus;
/******/ 					registeredStatusHandlers.push(l);
/******/ 				},
/******/ 				addStatusHandler: function (l) {
/******/ 					registeredStatusHandlers.push(l);
/******/ 				},
/******/ 				removeStatusHandler: function (l) {
/******/ 					var idx = registeredStatusHandlers.indexOf(l);
/******/ 					if (idx >= 0) registeredStatusHandlers.splice(idx, 1);
/******/ 				},
/******/ 		
/******/ 				//inherit from previous dispose call
/******/ 				data: currentModuleData[moduleId]
/******/ 			};
/******/ 			currentChildModule = undefined;
/******/ 			return hot;
/******/ 		}
/******/ 		
/******/ 		function setStatus(newStatus) {
/******/ 			currentStatus = newStatus;
/******/ 			for (var i = 0; i < registeredStatusHandlers.length; i++)
/******/ 				registeredStatusHandlers[i].call(null, newStatus);
/******/ 		}
/******/ 		
/******/ 		function trackBlockingPromise(promise) {
/******/ 			switch (currentStatus) {
/******/ 				case "ready":
/******/ 					setStatus("prepare");
/******/ 					blockingPromises.push(promise);
/******/ 					waitForBlockingPromises(function () {
/******/ 						setStatus("ready");
/******/ 					});
/******/ 					return promise;
/******/ 				case "prepare":
/******/ 					blockingPromises.push(promise);
/******/ 					return promise;
/******/ 				default:
/******/ 					return promise;
/******/ 			}
/******/ 		}
/******/ 		
/******/ 		function waitForBlockingPromises(fn) {
/******/ 			if (blockingPromises.length === 0) return fn();
/******/ 			var blocker = blockingPromises;
/******/ 			blockingPromises = [];
/******/ 			return Promise.all(blocker).then(function () {
/******/ 				return waitForBlockingPromises(fn);
/******/ 			});
/******/ 		}
/******/ 		
/******/ 		function hotCheck(applyOnUpdate) {
/******/ 			if (currentStatus !== "idle") {
/******/ 				throw new Error("check() is only allowed in idle status");
/******/ 			}
/******/ 			setStatus("check");
/******/ 			return __webpack_require__.hmrM().then(function (update) {
/******/ 				if (!update) {
/******/ 					setStatus(applyInvalidatedModules() ? "ready" : "idle");
/******/ 					return null;
/******/ 				}
/******/ 		
/******/ 				setStatus("prepare");
/******/ 		
/******/ 				var updatedModules = [];
/******/ 				blockingPromises = [];
/******/ 				currentUpdateApplyHandlers = [];
/******/ 		
/******/ 				return Promise.all(
/******/ 					Object.keys(__webpack_require__.hmrC).reduce(function (
/******/ 						promises,
/******/ 						key
/******/ 					) {
/******/ 						__webpack_require__.hmrC[key](
/******/ 							update.c,
/******/ 							update.r,
/******/ 							update.m,
/******/ 							promises,
/******/ 							currentUpdateApplyHandlers,
/******/ 							updatedModules
/******/ 						);
/******/ 						return promises;
/******/ 					},
/******/ 					[])
/******/ 				).then(function () {
/******/ 					return waitForBlockingPromises(function () {
/******/ 						if (applyOnUpdate) {
/******/ 							return internalApply(applyOnUpdate);
/******/ 						} else {
/******/ 							setStatus("ready");
/******/ 		
/******/ 							return updatedModules;
/******/ 						}
/******/ 					});
/******/ 				});
/******/ 			});
/******/ 		}
/******/ 		
/******/ 		function hotApply(options) {
/******/ 			if (currentStatus !== "ready") {
/******/ 				return Promise.resolve().then(function () {
/******/ 					throw new Error("apply() is only allowed in ready status");
/******/ 				});
/******/ 			}
/******/ 			return internalApply(options);
/******/ 		}
/******/ 		
/******/ 		function internalApply(options) {
/******/ 			options = options || {};
/******/ 		
/******/ 			applyInvalidatedModules();
/******/ 		
/******/ 			var results = currentUpdateApplyHandlers.map(function (handler) {
/******/ 				return handler(options);
/******/ 			});
/******/ 			currentUpdateApplyHandlers = undefined;
/******/ 		
/******/ 			var errors = results
/******/ 				.map(function (r) {
/******/ 					return r.error;
/******/ 				})
/******/ 				.filter(Boolean);
/******/ 		
/******/ 			if (errors.length > 0) {
/******/ 				setStatus("abort");
/******/ 				return Promise.resolve().then(function () {
/******/ 					throw errors[0];
/******/ 				});
/******/ 			}
/******/ 		
/******/ 			// Now in "dispose" phase
/******/ 			setStatus("dispose");
/******/ 		
/******/ 			results.forEach(function (result) {
/******/ 				if (result.dispose) result.dispose();
/******/ 			});
/******/ 		
/******/ 			// Now in "apply" phase
/******/ 			setStatus("apply");
/******/ 		
/******/ 			var error;
/******/ 			var reportError = function (err) {
/******/ 				if (!error) error = err;
/******/ 			};
/******/ 		
/******/ 			var outdatedModules = [];
/******/ 			results.forEach(function (result) {
/******/ 				if (result.apply) {
/******/ 					var modules = result.apply(reportError);
/******/ 					if (modules) {
/******/ 						for (var i = 0; i < modules.length; i++) {
/******/ 							outdatedModules.push(modules[i]);
/******/ 						}
/******/ 					}
/******/ 				}
/******/ 			});
/******/ 		
/******/ 			// handle errors in accept handlers and self accepted module load
/******/ 			if (error) {
/******/ 				setStatus("fail");
/******/ 				return Promise.resolve().then(function () {
/******/ 					throw error;
/******/ 				});
/******/ 			}
/******/ 		
/******/ 			if (queuedInvalidatedModules) {
/******/ 				return internalApply(options).then(function (list) {
/******/ 					outdatedModules.forEach(function (moduleId) {
/******/ 						if (list.indexOf(moduleId) < 0) list.push(moduleId);
/******/ 					});
/******/ 					return list;
/******/ 				});
/******/ 			}
/******/ 		
/******/ 			setStatus("idle");
/******/ 			return Promise.resolve(outdatedModules);
/******/ 		}
/******/ 		
/******/ 		function applyInvalidatedModules() {
/******/ 			if (queuedInvalidatedModules) {
/******/ 				if (!currentUpdateApplyHandlers) currentUpdateApplyHandlers = [];
/******/ 				Object.keys(__webpack_require__.hmrI).forEach(function (key) {
/******/ 					queuedInvalidatedModules.forEach(function (moduleId) {
/******/ 						__webpack_require__.hmrI[key](
/******/ 							moduleId,
/******/ 							currentUpdateApplyHandlers
/******/ 						);
/******/ 					});
/******/ 				});
/******/ 				queuedInvalidatedModules = undefined;
/******/ 				return true;
/******/ 			}
/******/ 		}
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/publicPath */
/******/ 	(() => {
/******/ 		var scriptUrl;
/******/ 		if (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + "";
/******/ 		var document = __webpack_require__.g.document;
/******/ 		if (!scriptUrl && document) {
/******/ 			if (document.currentScript)
/******/ 				scriptUrl = document.currentScript.src
/******/ 			if (!scriptUrl) {
/******/ 				var scripts = document.getElementsByTagName("script");
/******/ 				if(scripts.length) scriptUrl = scripts[scripts.length - 1].src
/******/ 			}
/******/ 		}
/******/ 		// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration
/******/ 		// or pass an empty string ("") and set the __webpack_public_path__ variable from your code to use your own logic.
/******/ 		if (!scriptUrl) throw new Error("Automatic publicPath is not supported in this browser");
/******/ 		scriptUrl = scriptUrl.replace(/#.*$/, "").replace(/\?.*$/, "").replace(/\/[^\/]+$/, "/");
/******/ 		__webpack_require__.p = scriptUrl;
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/jsonp chunk loading */
/******/ 	(() => {
/******/ 		// no baseURI
/******/ 		
/******/ 		// object to store loaded and loading chunks
/******/ 		// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 		// Promise = chunk loading, 0 = chunk loaded
/******/ 		var installedChunks = {
/******/ 			"main": 0
/******/ 		};
/******/ 		
/******/ 		
/******/ 		// no chunk on demand loading
/******/ 		
/******/ 		// no prefetching
/******/ 		
/******/ 		// no preloaded
/******/ 		
/******/ 		var currentUpdatedModulesList;
/******/ 		var waitingUpdateResolves = {};
/******/ 		function loadUpdateChunk(chunkId) {
/******/ 			return new Promise((resolve, reject) => {
/******/ 				waitingUpdateResolves[chunkId] = resolve;
/******/ 				// start update chunk loading
/******/ 				var url = __webpack_require__.p + __webpack_require__.hu(chunkId);
/******/ 				// create error before stack unwound to get useful stacktrace later
/******/ 				var error = new Error();
/******/ 				var loadingEnded = (event) => {
/******/ 					if(waitingUpdateResolves[chunkId]) {
/******/ 						waitingUpdateResolves[chunkId] = undefined
/******/ 						var errorType = event && (event.type === 'load' ? 'missing' : event.type);
/******/ 						var realSrc = event && event.target && event.target.src;
/******/ 						error.message = 'Loading hot update chunk ' + chunkId + ' failed.\n(' + errorType + ': ' + realSrc + ')';
/******/ 						error.name = 'ChunkLoadError';
/******/ 						error.type = errorType;
/******/ 						error.request = realSrc;
/******/ 						reject(error);
/******/ 					}
/******/ 				};
/******/ 				__webpack_require__.l(url, loadingEnded);
/******/ 			});
/******/ 		}
/******/ 		
/******/ 		self["webpackHotUpdateTetris"] = (chunkId, moreModules, runtime) => {
/******/ 			for(var moduleId in moreModules) {
/******/ 				if(__webpack_require__.o(moreModules, moduleId)) {
/******/ 					currentUpdate[moduleId] = moreModules[moduleId];
/******/ 					if(currentUpdatedModulesList) currentUpdatedModulesList.push(moduleId);
/******/ 				}
/******/ 			}
/******/ 			if(runtime) currentUpdateRuntime.push(runtime);
/******/ 			if(waitingUpdateResolves[chunkId]) {
/******/ 				waitingUpdateResolves[chunkId]();
/******/ 				waitingUpdateResolves[chunkId] = undefined;
/******/ 			}
/******/ 		};
/******/ 		
/******/ 		var currentUpdateChunks;
/******/ 		var currentUpdate;
/******/ 		var currentUpdateRemovedChunks;
/******/ 		var currentUpdateRuntime;
/******/ 		function applyHandler(options) {
/******/ 			if (__webpack_require__.f) delete __webpack_require__.f.jsonpHmr;
/******/ 			currentUpdateChunks = undefined;
/******/ 			function getAffectedModuleEffects(updateModuleId) {
/******/ 				var outdatedModules = [updateModuleId];
/******/ 				var outdatedDependencies = {};
/******/ 		
/******/ 				var queue = outdatedModules.map(function (id) {
/******/ 					return {
/******/ 						chain: [id],
/******/ 						id: id
/******/ 					};
/******/ 				});
/******/ 				while (queue.length > 0) {
/******/ 					var queueItem = queue.pop();
/******/ 					var moduleId = queueItem.id;
/******/ 					var chain = queueItem.chain;
/******/ 					var module = __webpack_require__.c[moduleId];
/******/ 					if (
/******/ 						!module ||
/******/ 						(module.hot._selfAccepted && !module.hot._selfInvalidated)
/******/ 					)
/******/ 						continue;
/******/ 					if (module.hot._selfDeclined) {
/******/ 						return {
/******/ 							type: "self-declined",
/******/ 							chain: chain,
/******/ 							moduleId: moduleId
/******/ 						};
/******/ 					}
/******/ 					if (module.hot._main) {
/******/ 						return {
/******/ 							type: "unaccepted",
/******/ 							chain: chain,
/******/ 							moduleId: moduleId
/******/ 						};
/******/ 					}
/******/ 					for (var i = 0; i < module.parents.length; i++) {
/******/ 						var parentId = module.parents[i];
/******/ 						var parent = __webpack_require__.c[parentId];
/******/ 						if (!parent) continue;
/******/ 						if (parent.hot._declinedDependencies[moduleId]) {
/******/ 							return {
/******/ 								type: "declined",
/******/ 								chain: chain.concat([parentId]),
/******/ 								moduleId: moduleId,
/******/ 								parentId: parentId
/******/ 							};
/******/ 						}
/******/ 						if (outdatedModules.indexOf(parentId) !== -1) continue;
/******/ 						if (parent.hot._acceptedDependencies[moduleId]) {
/******/ 							if (!outdatedDependencies[parentId])
/******/ 								outdatedDependencies[parentId] = [];
/******/ 							addAllToSet(outdatedDependencies[parentId], [moduleId]);
/******/ 							continue;
/******/ 						}
/******/ 						delete outdatedDependencies[parentId];
/******/ 						outdatedModules.push(parentId);
/******/ 						queue.push({
/******/ 							chain: chain.concat([parentId]),
/******/ 							id: parentId
/******/ 						});
/******/ 					}
/******/ 				}
/******/ 		
/******/ 				return {
/******/ 					type: "accepted",
/******/ 					moduleId: updateModuleId,
/******/ 					outdatedModules: outdatedModules,
/******/ 					outdatedDependencies: outdatedDependencies
/******/ 				};
/******/ 			}
/******/ 		
/******/ 			function addAllToSet(a, b) {
/******/ 				for (var i = 0; i < b.length; i++) {
/******/ 					var item = b[i];
/******/ 					if (a.indexOf(item) === -1) a.push(item);
/******/ 				}
/******/ 			}
/******/ 		
/******/ 			// at begin all updates modules are outdated
/******/ 			// the "outdated" status can propagate to parents if they don't accept the children
/******/ 			var outdatedDependencies = {};
/******/ 			var outdatedModules = [];
/******/ 			var appliedUpdate = {};
/******/ 		
/******/ 			var warnUnexpectedRequire = function warnUnexpectedRequire(module) {
/******/ 				console.warn(
/******/ 					"[HMR] unexpected require(" + module.id + ") to disposed module"
/******/ 				);
/******/ 			};
/******/ 		
/******/ 			for (var moduleId in currentUpdate) {
/******/ 				if (__webpack_require__.o(currentUpdate, moduleId)) {
/******/ 					var newModuleFactory = currentUpdate[moduleId];
/******/ 					/** @type {TODO} */
/******/ 					var result;
/******/ 					if (newModuleFactory) {
/******/ 						result = getAffectedModuleEffects(moduleId);
/******/ 					} else {
/******/ 						result = {
/******/ 							type: "disposed",
/******/ 							moduleId: moduleId
/******/ 						};
/******/ 					}
/******/ 					/** @type {Error|false} */
/******/ 					var abortError = false;
/******/ 					var doApply = false;
/******/ 					var doDispose = false;
/******/ 					var chainInfo = "";
/******/ 					if (result.chain) {
/******/ 						chainInfo = "\nUpdate propagation: " + result.chain.join(" -> ");
/******/ 					}
/******/ 					switch (result.type) {
/******/ 						case "self-declined":
/******/ 							if (options.onDeclined) options.onDeclined(result);
/******/ 							if (!options.ignoreDeclined)
/******/ 								abortError = new Error(
/******/ 									"Aborted because of self decline: " +
/******/ 										result.moduleId +
/******/ 										chainInfo
/******/ 								);
/******/ 							break;
/******/ 						case "declined":
/******/ 							if (options.onDeclined) options.onDeclined(result);
/******/ 							if (!options.ignoreDeclined)
/******/ 								abortError = new Error(
/******/ 									"Aborted because of declined dependency: " +
/******/ 										result.moduleId +
/******/ 										" in " +
/******/ 										result.parentId +
/******/ 										chainInfo
/******/ 								);
/******/ 							break;
/******/ 						case "unaccepted":
/******/ 							if (options.onUnaccepted) options.onUnaccepted(result);
/******/ 							if (!options.ignoreUnaccepted)
/******/ 								abortError = new Error(
/******/ 									"Aborted because " + moduleId + " is not accepted" + chainInfo
/******/ 								);
/******/ 							break;
/******/ 						case "accepted":
/******/ 							if (options.onAccepted) options.onAccepted(result);
/******/ 							doApply = true;
/******/ 							break;
/******/ 						case "disposed":
/******/ 							if (options.onDisposed) options.onDisposed(result);
/******/ 							doDispose = true;
/******/ 							break;
/******/ 						default:
/******/ 							throw new Error("Unexception type " + result.type);
/******/ 					}
/******/ 					if (abortError) {
/******/ 						return {
/******/ 							error: abortError
/******/ 						};
/******/ 					}
/******/ 					if (doApply) {
/******/ 						appliedUpdate[moduleId] = newModuleFactory;
/******/ 						addAllToSet(outdatedModules, result.outdatedModules);
/******/ 						for (moduleId in result.outdatedDependencies) {
/******/ 							if (__webpack_require__.o(result.outdatedDependencies, moduleId)) {
/******/ 								if (!outdatedDependencies[moduleId])
/******/ 									outdatedDependencies[moduleId] = [];
/******/ 								addAllToSet(
/******/ 									outdatedDependencies[moduleId],
/******/ 									result.outdatedDependencies[moduleId]
/******/ 								);
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 					if (doDispose) {
/******/ 						addAllToSet(outdatedModules, [result.moduleId]);
/******/ 						appliedUpdate[moduleId] = warnUnexpectedRequire;
/******/ 					}
/******/ 				}
/******/ 			}
/******/ 			currentUpdate = undefined;
/******/ 		
/******/ 			// Store self accepted outdated modules to require them later by the module system
/******/ 			var outdatedSelfAcceptedModules = [];
/******/ 			for (var j = 0; j < outdatedModules.length; j++) {
/******/ 				var outdatedModuleId = outdatedModules[j];
/******/ 				if (
/******/ 					__webpack_require__.c[outdatedModuleId] &&
/******/ 					__webpack_require__.c[outdatedModuleId].hot._selfAccepted &&
/******/ 					// removed self-accepted modules should not be required
/******/ 					appliedUpdate[outdatedModuleId] !== warnUnexpectedRequire &&
/******/ 					// when called invalidate self-accepting is not possible
/******/ 					!__webpack_require__.c[outdatedModuleId].hot._selfInvalidated
/******/ 				) {
/******/ 					outdatedSelfAcceptedModules.push({
/******/ 						module: outdatedModuleId,
/******/ 						require: __webpack_require__.c[outdatedModuleId].hot._requireSelf,
/******/ 						errorHandler: __webpack_require__.c[outdatedModuleId].hot._selfAccepted
/******/ 					});
/******/ 				}
/******/ 			}
/******/ 		
/******/ 			var moduleOutdatedDependencies;
/******/ 		
/******/ 			return {
/******/ 				dispose: function () {
/******/ 					currentUpdateRemovedChunks.forEach(function (chunkId) {
/******/ 						delete installedChunks[chunkId];
/******/ 					});
/******/ 					currentUpdateRemovedChunks = undefined;
/******/ 		
/******/ 					var idx;
/******/ 					var queue = outdatedModules.slice();
/******/ 					while (queue.length > 0) {
/******/ 						var moduleId = queue.pop();
/******/ 						var module = __webpack_require__.c[moduleId];
/******/ 						if (!module) continue;
/******/ 		
/******/ 						var data = {};
/******/ 		
/******/ 						// Call dispose handlers
/******/ 						var disposeHandlers = module.hot._disposeHandlers;
/******/ 						for (j = 0; j < disposeHandlers.length; j++) {
/******/ 							disposeHandlers[j].call(null, data);
/******/ 						}
/******/ 						__webpack_require__.hmrD[moduleId] = data;
/******/ 		
/******/ 						// disable module (this disables requires from this module)
/******/ 						module.hot.active = false;
/******/ 		
/******/ 						// remove module from cache
/******/ 						delete __webpack_require__.c[moduleId];
/******/ 		
/******/ 						// when disposing there is no need to call dispose handler
/******/ 						delete outdatedDependencies[moduleId];
/******/ 		
/******/ 						// remove "parents" references from all children
/******/ 						for (j = 0; j < module.children.length; j++) {
/******/ 							var child = __webpack_require__.c[module.children[j]];
/******/ 							if (!child) continue;
/******/ 							idx = child.parents.indexOf(moduleId);
/******/ 							if (idx >= 0) {
/******/ 								child.parents.splice(idx, 1);
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 		
/******/ 					// remove outdated dependency from module children
/******/ 					var dependency;
/******/ 					for (var outdatedModuleId in outdatedDependencies) {
/******/ 						if (__webpack_require__.o(outdatedDependencies, outdatedModuleId)) {
/******/ 							module = __webpack_require__.c[outdatedModuleId];
/******/ 							if (module) {
/******/ 								moduleOutdatedDependencies =
/******/ 									outdatedDependencies[outdatedModuleId];
/******/ 								for (j = 0; j < moduleOutdatedDependencies.length; j++) {
/******/ 									dependency = moduleOutdatedDependencies[j];
/******/ 									idx = module.children.indexOf(dependency);
/******/ 									if (idx >= 0) module.children.splice(idx, 1);
/******/ 								}
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 				},
/******/ 				apply: function (reportError) {
/******/ 					// insert new code
/******/ 					for (var updateModuleId in appliedUpdate) {
/******/ 						if (__webpack_require__.o(appliedUpdate, updateModuleId)) {
/******/ 							__webpack_require__.m[updateModuleId] = appliedUpdate[updateModuleId];
/******/ 						}
/******/ 					}
/******/ 		
/******/ 					// run new runtime modules
/******/ 					for (var i = 0; i < currentUpdateRuntime.length; i++) {
/******/ 						currentUpdateRuntime[i](__webpack_require__);
/******/ 					}
/******/ 		
/******/ 					// call accept handlers
/******/ 					for (var outdatedModuleId in outdatedDependencies) {
/******/ 						if (__webpack_require__.o(outdatedDependencies, outdatedModuleId)) {
/******/ 							var module = __webpack_require__.c[outdatedModuleId];
/******/ 							if (module) {
/******/ 								moduleOutdatedDependencies =
/******/ 									outdatedDependencies[outdatedModuleId];
/******/ 								var callbacks = [];
/******/ 								var dependenciesForCallbacks = [];
/******/ 								for (var j = 0; j < moduleOutdatedDependencies.length; j++) {
/******/ 									var dependency = moduleOutdatedDependencies[j];
/******/ 									var acceptCallback =
/******/ 										module.hot._acceptedDependencies[dependency];
/******/ 									if (acceptCallback) {
/******/ 										if (callbacks.indexOf(acceptCallback) !== -1) continue;
/******/ 										callbacks.push(acceptCallback);
/******/ 										dependenciesForCallbacks.push(dependency);
/******/ 									}
/******/ 								}
/******/ 								for (var k = 0; k < callbacks.length; k++) {
/******/ 									try {
/******/ 										callbacks[k].call(null, moduleOutdatedDependencies);
/******/ 									} catch (err) {
/******/ 										if (options.onErrored) {
/******/ 											options.onErrored({
/******/ 												type: "accept-errored",
/******/ 												moduleId: outdatedModuleId,
/******/ 												dependencyId: dependenciesForCallbacks[k],
/******/ 												error: err
/******/ 											});
/******/ 										}
/******/ 										if (!options.ignoreErrored) {
/******/ 											reportError(err);
/******/ 										}
/******/ 									}
/******/ 								}
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 		
/******/ 					// Load self accepted modules
/******/ 					for (var o = 0; o < outdatedSelfAcceptedModules.length; o++) {
/******/ 						var item = outdatedSelfAcceptedModules[o];
/******/ 						var moduleId = item.module;
/******/ 						try {
/******/ 							item.require(moduleId);
/******/ 						} catch (err) {
/******/ 							if (typeof item.errorHandler === "function") {
/******/ 								try {
/******/ 									item.errorHandler(err);
/******/ 								} catch (err2) {
/******/ 									if (options.onErrored) {
/******/ 										options.onErrored({
/******/ 											type: "self-accept-error-handler-errored",
/******/ 											moduleId: moduleId,
/******/ 											error: err2,
/******/ 											originalError: err
/******/ 										});
/******/ 									}
/******/ 									if (!options.ignoreErrored) {
/******/ 										reportError(err2);
/******/ 									}
/******/ 									reportError(err);
/******/ 								}
/******/ 							} else {
/******/ 								if (options.onErrored) {
/******/ 									options.onErrored({
/******/ 										type: "self-accept-errored",
/******/ 										moduleId: moduleId,
/******/ 										error: err
/******/ 									});
/******/ 								}
/******/ 								if (!options.ignoreErrored) {
/******/ 									reportError(err);
/******/ 								}
/******/ 							}
/******/ 						}
/******/ 					}
/******/ 		
/******/ 					return outdatedModules;
/******/ 				}
/******/ 			};
/******/ 		}
/******/ 		__webpack_require__.hmrI.jsonp = function (moduleId, applyHandlers) {
/******/ 			if (!currentUpdate) {
/******/ 				currentUpdate = {};
/******/ 				currentUpdateRuntime = [];
/******/ 				currentUpdateRemovedChunks = [];
/******/ 				applyHandlers.push(applyHandler);
/******/ 			}
/******/ 			if (!__webpack_require__.o(currentUpdate, moduleId)) {
/******/ 				currentUpdate[moduleId] = __webpack_require__.m[moduleId];
/******/ 			}
/******/ 		};
/******/ 		__webpack_require__.hmrC.jsonp = function (
/******/ 			chunkIds,
/******/ 			removedChunks,
/******/ 			removedModules,
/******/ 			promises,
/******/ 			applyHandlers,
/******/ 			updatedModulesList
/******/ 		) {
/******/ 			applyHandlers.push(applyHandler);
/******/ 			currentUpdateChunks = {};
/******/ 			currentUpdateRemovedChunks = removedChunks;
/******/ 			currentUpdate = removedModules.reduce(function (obj, key) {
/******/ 				obj[key] = false;
/******/ 				return obj;
/******/ 			}, {});
/******/ 			currentUpdateRuntime = [];
/******/ 			chunkIds.forEach(function (chunkId) {
/******/ 				if (
/******/ 					__webpack_require__.o(installedChunks, chunkId) &&
/******/ 					installedChunks[chunkId] !== undefined
/******/ 				) {
/******/ 					promises.push(loadUpdateChunk(chunkId, updatedModulesList));
/******/ 					currentUpdateChunks[chunkId] = true;
/******/ 				}
/******/ 			});
/******/ 			if (__webpack_require__.f) {
/******/ 				__webpack_require__.f.jsonpHmr = function (chunkId, promises) {
/******/ 					if (
/******/ 						currentUpdateChunks &&
/******/ 						!__webpack_require__.o(currentUpdateChunks, chunkId) &&
/******/ 						__webpack_require__.o(installedChunks, chunkId) &&
/******/ 						installedChunks[chunkId] !== undefined
/******/ 					) {
/******/ 						promises.push(loadUpdateChunk(chunkId));
/******/ 						currentUpdateChunks[chunkId] = true;
/******/ 					}
/******/ 				};
/******/ 			}
/******/ 		};
/******/ 		
/******/ 		__webpack_require__.hmrM = () => {
/******/ 			if (typeof fetch === "undefined") throw new Error("No browser support: need fetch API");
/******/ 			return fetch(__webpack_require__.p + __webpack_require__.hmrF()).then((response) => {
/******/ 				if(response.status === 404) return; // no update available
/******/ 				if(!response.ok) throw new Error("Failed to fetch update manifest " + response.statusText);
/******/ 				return response.json();
/******/ 			});
/******/ 		};
/******/ 		
/******/ 		// no deferred startup
/******/ 		
/******/ 		// no jsonp function
/******/ 		
/******/ 		// no deferred startup
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// module cache are used so entry inlining is disabled
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	var __webpack_exports__ = __webpack_require__("./src/ts/main.ts");
/******/ 	
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvZmFjdG9yeS9jdWJlLnRzIiwid2VicGFjazovL1RldHJpcy8uL3NyYy90cy9mYWN0b3J5L2dhbWVXaW5kb3cudHMiLCJ3ZWJwYWNrOi8vVGV0cmlzLy4vc3JjL3RzL2ZhY3RvcnkvcG9pbnQudHMiLCJ3ZWJwYWNrOi8vVGV0cmlzLy4vc3JjL3RzL2ZhY3RvcnkvdGV0cmlzLnRzIiwid2VicGFjazovL1RldHJpcy8uL3NyYy90cy9nYW1lL2FjdGlvbi9jb25jcmV0ZS9rZXlib2FyZC50cyIsIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvZ2FtZS9iZWhhdmlvclJlc29sdmVyLnRzIiwid2VicGFjazovL1RldHJpcy8uL3NyYy90cy9nYW1lL2NvbGxpc2lvbi50cyIsIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvZ2FtZS9jb250ZXh0LnRzIiwid2VicGFjazovL1RldHJpcy8uL3NyYy90cy9nYW1lL2N1YmVFbGltaW5hdG9yLnRzIiwid2VicGFjazovL1RldHJpcy8uL3NyYy90cy9nYW1lL2dhbWUudHMiLCJ3ZWJwYWNrOi8vVGV0cmlzLy4vc3JjL3RzL2dhbWUvd2luZG93L2NvbmNyZXRlL2dhbWVXaW5kb3cudHMiLCJ3ZWJwYWNrOi8vVGV0cmlzLy4vc3JjL3RzL2dhbWUvd2luZG93L2dhbWVXaW5kb3cudHMiLCJ3ZWJwYWNrOi8vVGV0cmlzLy4vc3JjL3RzL2hlbHBlci9hcnJheS50cyIsIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvbWFpbi50cyIsIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvdXRpbC9wb2ludC50cyIsIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvdXRpbC90aW1lci50cyIsIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvd2lkZ2V0cy9jb25jcmV0ZS90ZXRyaXNlcy50cyIsIndlYnBhY2s6Ly9UZXRyaXMvLi9zcmMvdHMvd2lkZ2V0cy9jdWJlLnRzIiwid2VicGFjazovL1RldHJpcy8uL3NyYy90cy93aWRnZXRzL3RldHJpcy50cyIsIndlYnBhY2s6Ly9UZXRyaXMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vVGV0cmlzL3dlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCB1cGRhdGUgY2h1bmsgZmlsZW5hbWUiLCJ3ZWJwYWNrOi8vVGV0cmlzL3dlYnBhY2svcnVudGltZS9nZXQgdXBkYXRlIG1hbmlmZXN0IGZpbGVuYW1lIiwid2VicGFjazovL1RldHJpcy93ZWJwYWNrL3J1bnRpbWUvZ2V0RnVsbEhhc2giLCJ3ZWJwYWNrOi8vVGV0cmlzL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vVGV0cmlzL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vVGV0cmlzL3dlYnBhY2svcnVudGltZS9sb2FkIHNjcmlwdCIsIndlYnBhY2s6Ly9UZXRyaXMvd2VicGFjay9ydW50aW1lL2hvdCBtb2R1bGUgcmVwbGFjZW1lbnQiLCJ3ZWJwYWNrOi8vVGV0cmlzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL1RldHJpcy93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly9UZXRyaXMvd2VicGFjay9zdGFydHVwIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBYTtBQUNiO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0EsOENBQTZDLENBQUMsY0FBYyxFQUFDO0FBQzdELDZCQUE2QixtQkFBTyxDQUFDLGlEQUFpQjtBQUN0RCw4QkFBOEIsbUJBQU8sQ0FBQywwQ0FBUztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixtQ0FBbUM7QUFDaEU7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGVBQWU7Ozs7Ozs7Ozs7O0FDaEJGO0FBQ2I7QUFDQSxpREFBaUQsUUFBUTtBQUN6RCx3Q0FBd0MsUUFBUTtBQUNoRCx3REFBd0QsUUFBUTtBQUNo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Q0E7V0FDQTtXQUNBLE1BQU07V0FDTjtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsTUFBTTtXQUNOO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsR0FBRzs7V0FFSDtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxHQUFHO1dBQ0g7V0FDQTtXQUNBLEdBQUc7V0FDSDtXQUNBO1dBQ0E7V0FDQSxHQUFHOztXQUVIO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBO1dBQ0EsZ0JBQWdCLHFDQUFxQztXQUNyRDtXQUNBOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsSUFBSTtXQUNKO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7O1dBRUE7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsRUFBRTtXQUNGOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBOztXQUVBOztXQUVBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsSUFBSTtXQUNKO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxLQUFLO1dBQ0w7O1dBRUE7V0FDQTtXQUNBLElBQUk7V0FDSixHQUFHO1dBQ0gsRUFBRTtXQUNGOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsR0FBRztXQUNIO1dBQ0E7V0FDQTs7V0FFQTtXQUNBOztXQUVBOztXQUVBO1dBQ0E7V0FDQSxFQUFFO1dBQ0Y7O1dBRUE7V0FDQTtXQUNBO1dBQ0EsR0FBRztXQUNIOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsR0FBRztXQUNIOztXQUVBO1dBQ0E7O1dBRUE7V0FDQTtXQUNBLEVBQUU7O1dBRUY7V0FDQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsbUJBQW1CLG9CQUFvQjtXQUN2QztXQUNBO1dBQ0E7V0FDQTtXQUNBLEVBQUU7O1dBRUY7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLEdBQUc7V0FDSDs7V0FFQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLElBQUk7V0FDSjtXQUNBLEdBQUc7V0FDSDs7V0FFQTtXQUNBO1dBQ0E7O1dBRUE7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsSUFBSTtXQUNKLEdBQUc7V0FDSDtXQUNBO1dBQ0E7V0FDQSxDOzs7OztXQ3RXQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxrQzs7Ozs7V0NmQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7OztXQUdBOztXQUVBOztXQUVBOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsRUFBRTtXQUNGOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxHQUFHO1dBQ0g7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0Esa0JBQWtCLDJCQUEyQjtXQUM3QztXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsS0FBSztXQUNMO1dBQ0E7O1dBRUE7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7O1dBRUE7V0FDQSxpQkFBaUIsY0FBYztXQUMvQjtXQUNBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQTtXQUNBOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7O1dBRUE7V0FDQTtXQUNBO1dBQ0EsY0FBYyxLQUFLO1dBQ25CO1dBQ0E7V0FDQTtXQUNBLElBQUk7V0FDSjtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsY0FBYyxZQUFZO1dBQzFCO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBO1dBQ0EsZ0JBQWdCLDRCQUE0QjtXQUM1QztXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLElBQUk7V0FDSjtXQUNBOztXQUVBOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsSUFBSTtXQUNKOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTs7V0FFQTs7V0FFQTtXQUNBO1dBQ0EsZUFBZSw0QkFBNEI7V0FDM0M7V0FDQTtXQUNBOztXQUVBO1dBQ0E7O1dBRUE7V0FDQTs7V0FFQTtXQUNBOztXQUVBO1dBQ0EsZUFBZSw0QkFBNEI7V0FDM0M7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsaUJBQWlCLHVDQUF1QztXQUN4RDtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLEdBQUc7V0FDSDtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBLGtCQUFrQixpQ0FBaUM7V0FDbkQ7V0FDQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxxQkFBcUIsdUNBQXVDO1dBQzVEO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLHFCQUFxQixzQkFBc0I7V0FDM0M7V0FDQTtXQUNBLFFBQVE7V0FDUjtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxVQUFVO1dBQ1Y7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBOztXQUVBO1dBQ0Esa0JBQWtCLHdDQUF3QztXQUMxRDtXQUNBO1dBQ0E7V0FDQTtXQUNBLEtBQUs7V0FDTDtXQUNBO1dBQ0E7V0FDQSxPQUFPO1dBQ1A7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsU0FBUztXQUNUO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLE1BQU07V0FDTjtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EsUUFBUTtXQUNSO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBOztXQUVBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxFQUFFLElBQUk7V0FDTjtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxFQUFFO1dBQ0Y7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQTs7V0FFQTtXQUNBO1dBQ0E7V0FDQSxxQ0FBcUM7V0FDckM7V0FDQTtXQUNBLEVBQUU7V0FDRjs7V0FFQTs7V0FFQTs7V0FFQSxzQjs7Ozs7VUNoZUE7VUFDQTtVQUNBO1VBQ0EiLCJmaWxlIjoiYnVuZGxlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciBjdWJlXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4uL3dpZGdldHMvY3ViZVwiKSk7XHJcbnZhciBwb2ludF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL3BvaW50XCIpKTtcclxudmFyIEN1YmVGYWN0b3J5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ3ViZUZhY3RvcnkoKSB7XHJcbiAgICB9XHJcbiAgICBDdWJlRmFjdG9yeS5jcmVhdGUgPSBmdW5jdGlvbiAocmVsYXRpb25Qb3MsIHBvcykge1xyXG4gICAgICAgIGlmIChwb3MgPT09IHZvaWQgMCkgeyBwb3MgPSBwb2ludF8xLmRlZmF1bHQuY3JlYXRlTWluKCk7IH1cclxuICAgICAgICByZXR1cm4gbmV3IGN1YmVfMS5kZWZhdWx0KHJlbGF0aW9uUG9zLCBwb3MpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDdWJlRmFjdG9yeTtcclxufSgpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gQ3ViZUZhY3Rvcnk7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19zcHJlYWRBcnJheXMgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXlzKSB8fCBmdW5jdGlvbiAoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgZ2FtZVdpbmRvd18xID0gcmVxdWlyZShcIi4uL2dhbWUvd2luZG93L2NvbmNyZXRlL2dhbWVXaW5kb3dcIik7XHJcbnZhciBHYW1lV2luZG93RmFjdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEdhbWVXaW5kb3dGYWN0b3J5KCkge1xyXG4gICAgfVxyXG4gICAgR2FtZVdpbmRvd0ZhY3RvcnkuY3JlYXRlID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+i8uOWFpeeahOmhnuWIpeWQjeeoseeCunN0b3Jl57SA6YyE55qE5bGs5oCn5pmC55Sf5oiQ5bCN5oeJ55qEVGV0cmlzXHJcbiAgICAgICAgdmFyIGdhbWVXaW5kb3cgPSBuZXcgKChfYSA9IGdhbWVXaW5kb3dfMS5UeXBlc1t0eXBlXSkuYmluZC5hcHBseShfYSwgX19zcHJlYWRBcnJheXMoW3ZvaWQgMF0sIGFyZ3MpKSkoKTtcclxuICAgICAgICByZXR1cm4gZ2FtZVdpbmRvdztcclxuICAgIH07XHJcbiAgICByZXR1cm4gR2FtZVdpbmRvd0ZhY3Rvcnk7XHJcbn0oKSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IEdhbWVXaW5kb3dGYWN0b3J5O1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgcG9pbnRfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vdXRpbC9wb2ludFwiKSk7XHJcbnZhciBQb2ludEZhY3RvcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQb2ludEZhY3RvcnkoKSB7XHJcbiAgICB9XHJcbiAgICBQb2ludEZhY3RvcnkuY3JlYXRlID0gZnVuY3Rpb24gKHgsIHkpIHtcclxuICAgICAgICByZXR1cm4gbmV3IHBvaW50XzEuZGVmYXVsdCh4LCB5KTtcclxuICAgIH07XHJcbiAgICBQb2ludEZhY3RvcnkuY3JlYXRlQnlQb2ludCA9IGZ1bmN0aW9uIChwKSB7XHJcbiAgICAgICAgdmFyIHggPSBwLngsIHkgPSBwLnk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBwb2ludF8xLmRlZmF1bHQoeCwgeSk7XHJcbiAgICB9O1xyXG4gICAgUG9pbnRGYWN0b3J5LmNyZWF0ZU1pbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IHBvaW50XzEuZGVmYXVsdChOdW1iZXIuTUlOX1NBRkVfSU5URUdFUiwgTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQb2ludEZhY3Rvcnk7XHJcbn0oKSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IFBvaW50RmFjdG9yeTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIHRldHJpc2VzXzEgPSByZXF1aXJlKFwiLi4vd2lkZ2V0cy9jb25jcmV0ZS90ZXRyaXNlc1wiKTtcclxudmFyIHBvaW50XzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vcG9pbnRcIikpO1xyXG52YXIgVGV0cmlzRmFjdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRldHJpc0ZhY3RvcnkoKSB7XHJcbiAgICB9XHJcbiAgICBUZXRyaXNGYWN0b3J5LmNyZWF0ZSA9IGZ1bmN0aW9uICh0ZXRyaXNUeXBlKSB7XHJcbiAgICAgICAgLy/ovLjlhaXnmoTpoZ7liKXlkI3nqLHngrpzdG9yZee0gOmMhOeahOWxrOaAp+aZgueUn+aIkOWwjeaHieeahFRldHJpc1xyXG4gICAgICAgIHZhciB0ZXRyaXMgPSBuZXcgdGV0cmlzZXNfMS5UeXBlc1t0ZXRyaXNUeXBlXSgpO1xyXG4gICAgICAgIHJldHVybiB0ZXRyaXM7XHJcbiAgICB9O1xyXG4gICAgVGV0cmlzRmFjdG9yeS5jcmVhdGVSYW5kb20gPSBmdW5jdGlvbiAoc2NlbmVDb2x1bW4pIHtcclxuICAgICAgICB2YXIgdGV0cmlzID0gVGV0cmlzRmFjdG9yeS5yYW5kb21QaWNrVGV0cmlzKCk7XHJcbiAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHNjZW5lQ29sdW1uIC8gMiAtIHRldHJpcy53aWR0aCAvIDIpO1xyXG4gICAgICAgIHZhciByb3RhdGVUaW1lcyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpO1xyXG4gICAgICAgIC8vcmFuZG9tIHJvdGF0ZVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm90YXRlVGltZXM7IGkrKykge1xyXG4gICAgICAgICAgICB0ZXRyaXMucm90YXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRldHJpcy51cGRhdGUoKTtcclxuICAgICAgICB0ZXRyaXMub3JpZ2luUG9zID0gcG9pbnRfMS5kZWZhdWx0LmNyZWF0ZSh4LCAwKTtcclxuICAgICAgICByZXR1cm4gdGV0cmlzO1xyXG4gICAgfTtcclxuICAgIFRldHJpc0ZhY3RvcnkucmFuZG9tUGlja1RldHJpcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdHlwZXMgPSBPYmplY3Qua2V5cyh0ZXRyaXNlc18xLlR5cGVzKTtcclxuICAgICAgICB2YXIgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdHlwZXMubGVuZ3RoKTtcclxuICAgICAgICB2YXIgcGljayA9IHR5cGVzW3JhbmRvbV07XHJcbiAgICAgICAgcmV0dXJuIFRldHJpc0ZhY3RvcnkuY3JlYXRlKHBpY2spO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUZXRyaXNGYWN0b3J5O1xyXG59KCkpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBUZXRyaXNGYWN0b3J5O1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmFjdGlvbnMgPSB2b2lkIDA7XHJcbnZhciBiZWhhdmlvclJlc29sdmVyXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4uLy4uL2JlaGF2aW9yUmVzb2x2ZXJcIikpO1xyXG52YXIgbW92ZUxlZnQgPSBmdW5jdGlvbiAoZXZlbnQsIGNvbnRleHQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dMZWZ0XCIpIHtcclxuICAgICAgICBjb250ZXh0LmN1cnJUZXRyaXMubGVmdCgpO1xyXG4gICAgfVxyXG59O1xyXG52YXIgbW92ZVJpZ2h0ID0gZnVuY3Rpb24gKGV2ZW50LCBjb250ZXh0KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93UmlnaHRcIikge1xyXG4gICAgICAgIGNvbnRleHQuY3VyclRldHJpcy5yaWdodCgpO1xyXG4gICAgfVxyXG59O1xyXG52YXIgcm90YXRlID0gZnVuY3Rpb24gKGV2ZW50LCBjb250ZXh0KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93VXBcIikge1xyXG4gICAgICAgIGNvbnRleHQuY3VyclRldHJpcy5yb3RhdGUoKTtcclxuICAgIH1cclxufTtcclxudmFyIGhvbGQgPSBmdW5jdGlvbiAoZXZlbnQsIGNvbnRleHQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiY1wiICYmIGNvbnRleHQuY2FuSG9sZCkge1xyXG4gICAgICAgIGNvbnRleHQuY2FuSG9sZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChjb250ZXh0LmhvbGRUZXRyaXMpIHtcclxuICAgICAgICAgICAgdmFyIHRlbXBDdXJyID0gY29udGV4dC5jdXJyVGV0cmlzO1xyXG4gICAgICAgICAgICBjb250ZXh0LmN1cnJUZXRyaXMgPSBjb250ZXh0LmhvbGRUZXRyaXM7XHJcbiAgICAgICAgICAgIGNvbnRleHQuY3VyclRldHJpcy5wb3NJbml0aWFsaXplKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuaG9sZFRldHJpcyA9IHRlbXBDdXJyO1xyXG4gICAgICAgICAgICBjb250ZXh0LnRldHJpc2VzID0gY29udGV4dC50ZXRyaXNlcy5maWx0ZXIoZnVuY3Rpb24gKHRldHJpcykgeyByZXR1cm4gdGV0cmlzICE9PSBjb250ZXh0LmhvbGRUZXRyaXM7IH0pO1xyXG4gICAgICAgICAgICBjb250ZXh0LnRldHJpc2VzLnB1c2goY29udGV4dC5jdXJyVGV0cmlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuaG9sZFRldHJpcyA9IGNvbnRleHQuY3VyclRldHJpcztcclxuICAgICAgICAgICAgYmVoYXZpb3JSZXNvbHZlcl8xLmRlZmF1bHQudXBkYXRlQ3VyckFuZFByZXBhcmUoY29udGV4dCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQudGV0cmlzZXMgPSBjb250ZXh0LnRldHJpc2VzLmZpbHRlcihmdW5jdGlvbiAodGV0cmlzKSB7IHJldHVybiB0ZXRyaXMgIT09IGNvbnRleHQuaG9sZFRldHJpczsgfSk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuY3VyclRldHJpcy5wb3NJbml0aWFsaXplKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuaG9sZFRldHJpcy5wb3NJbml0aWFsaXplKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRleHQuaG9sZFdpbmRvdy5yZW5kZXIoW2NvbnRleHQuaG9sZFRldHJpc10pO1xyXG4gICAgfVxyXG59O1xyXG52YXIgc29mdERyb3AgPSBmdW5jdGlvbiAoZXZlbnQsIGNvbnRleHQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dEb3duXCIpIHtcclxuICAgICAgICBpZiAoIWNvbnRleHQuc29mdERvd24pIHtcclxuICAgICAgICAgICAgY29udGV4dC5kb3duVGltZXIubXMgPSBjb250ZXh0LmRvd25UaW1lci5tcyAtIGNvbnRleHQuc3BlZWRJbmNyZWFzZTtcclxuICAgICAgICAgICAgY29udGV4dC5zb2Z0RG93biA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG52YXIgcmVzdG9yZVNvZnREcm9wID0gZnVuY3Rpb24gKGV2ZW50LCBjb250ZXh0KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93RG93blwiKSB7XHJcbiAgICAgICAgaWYgKGNvbnRleHQuc29mdERvd24pIHtcclxuICAgICAgICAgICAgY29udGV4dC5kb3duVGltZXIubXMgPSBjb250ZXh0LmRvd25UaW1lci5tcyArIGNvbnRleHQuc3BlZWRJbmNyZWFzZTtcclxuICAgICAgICAgICAgY29udGV4dC5zb2Z0RG93biA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxudmFyIGhhcmREcm9wID0gZnVuY3Rpb24gKGV2ZW50LCBjb250ZXh0KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIiBcIikge1xyXG4gICAgICAgIGNvbnRleHQuZG93blRpbWVyLm1zID0gMDtcclxuICAgIH1cclxufTtcclxudmFyIGFjdGlvbnMgPSB7XHJcbiAgICBrZXlkb3duOiBbbW92ZUxlZnQsIG1vdmVSaWdodCwgcm90YXRlLCBzb2Z0RHJvcCwgaGFyZERyb3AsIGhvbGRdLFxyXG4gICAga2V5dXA6IFtyZXN0b3JlU29mdERyb3BdLFxyXG59O1xyXG5leHBvcnRzLmFjdGlvbnMgPSBhY3Rpb25zO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgdGV0cmlzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4uL2ZhY3RvcnkvdGV0cmlzXCIpKTtcclxudmFyIHRldHJpc18yID0gcmVxdWlyZShcIi4uL3dpZGdldHMvdGV0cmlzXCIpO1xyXG52YXIgY3ViZUVsaW1pbmF0b3JfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9jdWJlRWxpbWluYXRvclwiKSk7XHJcbnZhciBHYW1lQmVoYXZpb3JSZXNvbHZlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEdhbWVCZWhhdmlvclJlc29sdmVyKCkge1xyXG4gICAgfVxyXG4gICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIuY2xlYXJDdWJlcyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgY29udGV4dC5kb3duVGltZXIuc3RvcCgpO1xyXG4gICAgICAgIHZhciBjbGVhclkgPSBjdWJlRWxpbWluYXRvcl8xLmRlZmF1bHQuY2xlYXIoY29udGV4dC5nYW1lV2luZG93LndpZHRoLCBjb250ZXh0LmdhbWVXaW5kb3cuaGVpZ2h0LCBjb250ZXh0LnRldHJpc2VzKTtcclxuICAgICAgICBjb250ZXh0LnRldHJpc2VzLmZvckVhY2goZnVuY3Rpb24gKHRldHJpcykge1xyXG4gICAgICAgICAgICB0ZXRyaXMuY3ViZXMuZm9yRWFjaChmdW5jdGlvbiAoY3ViZSkge1xyXG4gICAgICAgICAgICAgICAgLy/kuIvpmY3ph49cclxuICAgICAgICAgICAgICAgIHZhciBkb3duID0gY2xlYXJZLmZpbHRlcihmdW5jdGlvbiAoeSkgeyByZXR1cm4geSA+IGN1YmUucG9zLnk7IH0pLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGN1YmUucG9zID0gY3ViZS5wb3MucGx1c1koZG93bik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnRleHQuZG93blRpbWVyLnN0YXJ0KCk7XHJcbiAgICB9O1xyXG4gICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIudXBkYXRlQ3VyckFuZFByZXBhcmUgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIGNvbnRleHQuY3VyclRldHJpcyA9IGNvbnRleHQucHJlcGFyZVRldHJpc2VzLnNoaWZ0KCk7XHJcbiAgICAgICAgY29udGV4dC50ZXRyaXNlcy5wdXNoKGNvbnRleHQuY3VyclRldHJpcyk7XHJcbiAgICAgICAgY29udGV4dC5wcmVwYXJlVGV0cmlzZXMucHVzaCh0ZXRyaXNfMS5kZWZhdWx0LmNyZWF0ZVJhbmRvbShjb250ZXh0LmdhbWVXaW5kb3cud2lkdGgpKTtcclxuICAgICAgICBHYW1lQmVoYXZpb3JSZXNvbHZlci5yZW5kZXJQcmVwYXJlV2luZG93KGNvbnRleHQpO1xyXG4gICAgfTtcclxuICAgIEdhbWVCZWhhdmlvclJlc29sdmVyLndpbmRvd0luaXQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIGNvbnRleHQuZ2FtZVdpbmRvdy5jbGVhcigpO1xyXG4gICAgICAgIGNvbnRleHQuZ2FtZVdpbmRvdy5yZW5kZXJHcmlkKCk7XHJcbiAgICAgICAgY29udGV4dC5wcmVwYXJlV2luZG93LmZvckVhY2goZnVuY3Rpb24gKHcpIHsgcmV0dXJuIHcuY2xlYXIoKTsgfSk7XHJcbiAgICAgICAgY29udGV4dC5ob2xkV2luZG93LmNsZWFyKCk7XHJcbiAgICB9O1xyXG4gICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIucmVuZGVyUHJlcGFyZVdpbmRvdyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgY29udGV4dC5wcmVwYXJlV2luZG93LmZvckVhY2goZnVuY3Rpb24gKHcsIGkpIHtcclxuICAgICAgICAgICAgdy5yZW5kZXIoW2NvbnRleHQucHJlcGFyZVRldHJpc2VzW2ldXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIuY3VyclRldHJpc0Rvd24gPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIGNvbnRleHQuY3VyclRldHJpcy5kb3duKCk7XHJcbiAgICB9O1xyXG4gICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIubmV4dFRpY2sgPSBmdW5jdGlvbiAoY29udGV4dCwgaXNEb3duKSB7XHJcbiAgICAgICAgaWYgKGlzRG93biA9PT0gdm9pZCAwKSB7IGlzRG93biA9IGZhbHNlOyB9XHJcbiAgICAgICAgLy/mnKrnmbznlJ/norDmkp5cclxuICAgICAgICBpZiAoIWNvbnRleHQuY29sbGlzaW9uLmlzQ29sbGlzaW9uKGNvbnRleHQuY3VyclRldHJpcywgY29udGV4dC50ZXRyaXNlcykpIHtcclxuICAgICAgICAgICAgY29udGV4dC5jdXJyVGV0cmlzLnVwZGF0ZSgpOyAvL+abtOaWsOePvuWcqOS9jee9rlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vY29sbGlzaW9uXHJcbiAgICAgICAgaWYgKGlzRG93bikge1xyXG4gICAgICAgICAgICAvL+W+qeWOn3RpbWVy6ZaT6ZqUXHJcbiAgICAgICAgICAgIGNvbnRleHQuZG93blRpbWVyLm1zID0gY29udGV4dC5kb3duSW50ZXJ2YWw7XHJcbiAgICAgICAgICAgIC8vZ2FtZW92ZXIo55m855Sf56Kw5pKe5LiUdGV0cmlz55qEY3ViZXPnmoR56YO95bCP5pa8MClcclxuICAgICAgICAgICAgaWYgKGNvbnRleHQuY3VyclRldHJpcy5jdWJlcy5maWx0ZXIoZnVuY3Rpb24gKGN1YmUpIHsgcmV0dXJuIGN1YmUucG9zLnkgPj0gMDsgfSkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdhbWVXaW5kb3cucmVuZGVyVGV0cmlzKGNvbnRleHQudGV0cmlzZXMpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5nYW1lb3ZlciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/mtojpmaTmlrnloYpcclxuICAgICAgICAgICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIuY2xlYXJDdWJlcyhjb250ZXh0KTtcclxuICAgICAgICAgICAgLy/nlKLnlJ/mlrDmlrnloYpcclxuICAgICAgICAgICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIudXBkYXRlQ3VyckFuZFByZXBhcmUoY29udGV4dCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc29mdERvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgY29udGV4dC5jYW5Ib2xkID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy/lj5blvpfkuIrnp7vph49cclxuICAgICAgICAgICAgdmFyIHVwWSA9IEdhbWVCZWhhdmlvclJlc29sdmVyLnVwQW1vdW50KGNvbnRleHQpO1xyXG4gICAgICAgICAgICAvL+mcgOimgeS4iuenu1xyXG4gICAgICAgICAgICBpZiAodXBZID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jdXJyVGV0cmlzLnVwKHVwWSk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJUZXRyaXMudXBkYXRlKCk7IC8v5pu05paw54++5Zyo5L2N572uXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdhbWVXaW5kb3cucmVuZGVyVGV0cmlzKGNvbnRleHQudGV0cmlzZXMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRleHQuY3VyclRldHJpcy5iYWNrKCk7XHJcbiAgICB9O1xyXG4gICAgR2FtZUJlaGF2aW9yUmVzb2x2ZXIudXBBbW91bnQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIHZhciBjdXJyVGV0cmlzID0gY29udGV4dC5jdXJyVGV0cmlzLCB0ZXRyaXNlcyA9IGNvbnRleHQudGV0cmlzZXM7XHJcbiAgICAgICAgdmFyIHRvcFkgPSBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUjtcclxuICAgICAgICB2YXIgdXAgPSAwO1xyXG4gICAgICAgIC8vIGZpbmQgdG9wWVxyXG4gICAgICAgIHRldHJpc2VzLmZvckVhY2goZnVuY3Rpb24gKHRldHJpcykge1xyXG4gICAgICAgICAgICBpZiAodGV0cmlzICE9PSBjdXJyVGV0cmlzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3ViZXMgPSB0ZXRyaXMuY3ViZXM7XHJcbiAgICAgICAgICAgICAgICBjdWJlcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGMucG9zLnkgPCB0b3BZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcFkgPSBjLnBvcy55O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHNoYXBlID0gY3VyclRldHJpcy5jdXJyZW50U2hhcGU7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gY3VyclRldHJpcy53aWR0aCwgaGVpZ2h0ID0gY3VyclRldHJpcy5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIGxhc3QgPSBoZWlnaHQgLSAxO1xyXG4gICAgICAgIHZhciBib3R0b21ZID0gY3VyclRldHJpcy5wb3MueSArIGN1cnJUZXRyaXMuaGVpZ2h0O1xyXG4gICAgICAgIC8vc2hhcGXkuIrnp7vph49cclxuICAgICAgICBmb3IgKHZhciByID0gbGFzdDsgciA+PSAwOyByLS0pIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB3aWR0aDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVbcl1bY10gPT09IHRldHJpc18yLlNoYXBlVmFsdWUuREVGSU5FRCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvdHRvbVkgLSAobGFzdCAtIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXNlcnZlID0gMTtcclxuICAgICAgICBpZiAodG9wWSA8PSBib3R0b21ZKSB7XHJcbiAgICAgICAgICAgIHVwID0gTWF0aC5hYnMoYm90dG9tWSAtIHRvcFkpICsgcmVzZXJ2ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVwO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBHYW1lQmVoYXZpb3JSZXNvbHZlcjtcclxufSgpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gR2FtZUJlaGF2aW9yUmVzb2x2ZXI7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuQm91bmRhcnlUeXBlID0gdm9pZCAwO1xyXG52YXIgQm91bmRhcnlUeXBlO1xyXG4oZnVuY3Rpb24gKEJvdW5kYXJ5VHlwZSkge1xyXG4gICAgQm91bmRhcnlUeXBlW0JvdW5kYXJ5VHlwZVtcIlRvcFwiXSA9IDBdID0gXCJUb3BcIjtcclxuICAgIEJvdW5kYXJ5VHlwZVtCb3VuZGFyeVR5cGVbXCJCb3R0b21cIl0gPSAxXSA9IFwiQm90dG9tXCI7XHJcbiAgICBCb3VuZGFyeVR5cGVbQm91bmRhcnlUeXBlW1wiTGVmdFwiXSA9IDJdID0gXCJMZWZ0XCI7XHJcbiAgICBCb3VuZGFyeVR5cGVbQm91bmRhcnlUeXBlW1wiUmlnaHRcIl0gPSAzXSA9IFwiUmlnaHRcIjtcclxufSkoQm91bmRhcnlUeXBlID0gZXhwb3J0cy5Cb3VuZGFyeVR5cGUgfHwgKGV4cG9ydHMuQm91bmRhcnlUeXBlID0ge30pKTtcclxudmFyIENvbGxpc2lvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENvbGxpc2lvbihib3VuZGFyeSwgaWdub3JlKSB7XHJcbiAgICAgICAgaWYgKGlnbm9yZSA9PT0gdm9pZCAwKSB7IGlnbm9yZSA9IFtdOyB9XHJcbiAgICAgICAgdGhpcy5fYm91bmRhcnkgPSBib3VuZGFyeTtcclxuICAgICAgICB0aGlzLl9pZ25vcmUgPSBpZ25vcmU7XHJcbiAgICB9XHJcbiAgICBDb2xsaXNpb24ucHJvdG90eXBlLmlzQ29sbGlzaW9uVGV0cmlzID0gZnVuY3Rpb24gKHRhcmdldCwgdGV0cmlzZXMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRldHJpc2VzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyVGV0cmlzID0gdGV0cmlzZXNbaV07XHJcbiAgICAgICAgICAgIGlmIChjdXJyVGV0cmlzICE9PSB0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGFyZ2V0Lm5leHRDdWJlcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyVGV0cmlzLmZpbmRDdWJlQnlQb3ModGFyZ2V0Lm5leHRDdWJlc1tqXS5wb3MpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgQ29sbGlzaW9uLnByb3RvdHlwZS5pc0NvbGxpc2lvbkJvdW5kYXJ5ID0gZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgIHZhciBfYSA9IHRoaXMuX2JvdW5kYXJ5LCB0b3AgPSBfYS50b3AsIGJvdHRvbSA9IF9hLmJvdHRvbSwgbGVmdCA9IF9hLmxlZnQsIHJpZ2h0ID0gX2EucmlnaHQ7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXJnZXQubmV4dEN1YmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBfYiA9IHRhcmdldC5uZXh0Q3ViZXNbaV0ucG9zLCB4ID0gX2IueCwgeSA9IF9iLnk7XHJcbiAgICAgICAgICAgIGlmICgoeCA8IGxlZnQgJiYgIXRoaXMuX2lnbm9yZS5pbmNsdWRlcyhCb3VuZGFyeVR5cGUuTGVmdCkpIHx8XHJcbiAgICAgICAgICAgICAgICAoeCA+IHJpZ2h0ICYmICF0aGlzLl9pZ25vcmUuaW5jbHVkZXMoQm91bmRhcnlUeXBlLlJpZ2h0KSkgfHxcclxuICAgICAgICAgICAgICAgICh5IDwgdG9wICYmICF0aGlzLl9pZ25vcmUuaW5jbHVkZXMoQm91bmRhcnlUeXBlLlRvcCkpIHx8XHJcbiAgICAgICAgICAgICAgICAoeSA+IGJvdHRvbSAmJiAhdGhpcy5faWdub3JlLmluY2x1ZGVzKEJvdW5kYXJ5VHlwZS5Cb3R0b20pKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIENvbGxpc2lvbi5wcm90b3R5cGUuaXNDb2xsaXNpb24gPSBmdW5jdGlvbiAodGFyZ2V0LCB0ZXRyaXNlcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlzQ29sbGlzaW9uQm91bmRhcnkodGFyZ2V0KSB8fCB0aGlzLmlzQ29sbGlzaW9uVGV0cmlzKHRhcmdldCwgdGV0cmlzZXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb2xsaXNpb247XHJcbn0oKSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IENvbGxpc2lvbjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KSk7XHJcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCkgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufSk7XHJcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcclxuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59O1xyXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciB0ZXRyaXNfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vZmFjdG9yeS90ZXRyaXNcIikpO1xyXG52YXIgdGltZXJfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vdXRpbC90aW1lclwiKSk7XHJcbnZhciBjb2xsaXNpb25fMSA9IF9faW1wb3J0U3RhcihyZXF1aXJlKFwiLi9jb2xsaXNpb25cIikpO1xyXG52YXIgR2FtZUNvbnRleHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBHYW1lQ29udGV4dChnYW1lV2luZG93LCBwcmVwYXJlV2luZG93LCBob2xkV2luZG93LCBkb3duVXBkYXRlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmRvd25JbnRlcnZhbCA9IDQ1MDtcclxuICAgICAgICB0aGlzLnJlbmRlckludGVydmFsID0gNTA7XHJcbiAgICAgICAgdGhpcy5zcGVlZEluY3JlYXNlID0gNDAwO1xyXG4gICAgICAgIHRoaXMudGV0cmlzZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnByZXBhcmVUZXRyaXNlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuaG9sZFRldHJpcyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zb2Z0RG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2FuSG9sZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5nYW1lb3ZlciA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZ2FtZVdpbmRvdyA9IGdhbWVXaW5kb3c7XHJcbiAgICAgICAgdGhpcy5wcmVwYXJlV2luZG93ID0gcHJlcGFyZVdpbmRvdztcclxuICAgICAgICB0aGlzLmhvbGRXaW5kb3cgPSBob2xkV2luZG93O1xyXG4gICAgICAgIHRoaXMuY3VyclRldHJpcyA9IHRldHJpc18xLmRlZmF1bHQuY3JlYXRlUmFuZG9tKHRoaXMuZ2FtZVdpbmRvdy53aWR0aCk7XHJcbiAgICAgICAgdGhpcy50ZXRyaXNlcy5wdXNoKHRoaXMuY3VyclRldHJpcyk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnByZXBhcmVXaW5kb3cubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5wcmVwYXJlVGV0cmlzZXMucHVzaCh0ZXRyaXNfMS5kZWZhdWx0LmNyZWF0ZVJhbmRvbSh0aGlzLmdhbWVXaW5kb3cud2lkdGgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kb3duVGltZXIgPSBuZXcgdGltZXJfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZG93blVwZGF0ZSgpO1xyXG4gICAgICAgIH0sIHRoaXMuZG93bkludGVydmFsKTtcclxuICAgICAgICB0aGlzLnJlbmRlclRpbWVyID0gbmV3IHRpbWVyXzEuZGVmYXVsdChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIDtcclxuICAgICAgICAgICAgX3RoaXMuZ2FtZVdpbmRvdy5yZW5kZXIoX3RoaXMudGV0cmlzZXMpO1xyXG4gICAgICAgIH0sIHRoaXMucmVuZGVySW50ZXJ2YWwpO1xyXG4gICAgICAgIHRoaXMuY29sbGlzaW9uID0gbmV3IGNvbGxpc2lvbl8xLmRlZmF1bHQoe1xyXG4gICAgICAgICAgICB0b3A6IDAsXHJcbiAgICAgICAgICAgIGJvdHRvbTogZ2FtZVdpbmRvdy5oZWlnaHQgLSAxLFxyXG4gICAgICAgICAgICBsZWZ0OiAwLFxyXG4gICAgICAgICAgICByaWdodDogZ2FtZVdpbmRvdy53aWR0aCAtIDFcclxuICAgICAgICB9LCBbXHJcbiAgICAgICAgICAgIGNvbGxpc2lvbl8xLkJvdW5kYXJ5VHlwZS5Ub3BcclxuICAgICAgICBdKTtcclxuICAgIH1cclxuICAgIHJldHVybiBHYW1lQ29udGV4dDtcclxufSgpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gR2FtZUNvbnRleHQ7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciBhcnJheV8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9oZWxwZXIvYXJyYXlcIikpO1xyXG52YXIgQ3ViZUVsaW1pbmF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDdWJlRWxpbWluYXRvcigpIHtcclxuICAgIH1cclxuICAgIEN1YmVFbGltaW5hdG9yLmNsZWFyID0gZnVuY3Rpb24gKHNjZW5lV2lkdGgsIHNjZW5lSGVpZ2h0LCB0ZXRyaXNlcykge1xyXG4gICAgICAgIHZhciBjbGVhclkgPSBDdWJlRWxpbWluYXRvci5jbGVhcmFibGVDdWJlcyhzY2VuZVdpZHRoLCBzY2VuZUhlaWdodCwgdGV0cmlzZXMpO1xyXG4gICAgICAgIEN1YmVFbGltaW5hdG9yLnJlbW92ZUNsZWFyYWJsZVRldHJpcyh0ZXRyaXNlcyk7XHJcbiAgICAgICAgcmV0dXJuIGNsZWFyWTtcclxuICAgIH07XHJcbiAgICAvL+WbnuWCs+mAmeasoeaHiWNsZWFy55qEeeW6p+aomVxyXG4gICAgQ3ViZUVsaW1pbmF0b3IuY2xlYXJhYmxlQ3ViZXMgPSBmdW5jdGlvbiAoc2NlbmVXaWR0aCwgc2NlbmVIZWlnaHQsIHRldHJpc2VzKSB7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gYXJyYXlfMS5kZWZhdWx0LmNyZWF0ZTJEKHNjZW5lSGVpZ2h0KTtcclxuICAgICAgICB2YXIgY2xlYXJZID0gW107XHJcbiAgICAgICAgdGV0cmlzZXMuZm9yRWFjaChmdW5jdGlvbiAodGV0cmlzKSB7XHJcbiAgICAgICAgICAgIHRldHJpcy5jdWJlcy5mb3JFYWNoKGZ1bmN0aW9uIChjdWJlKSB7XHJcbiAgICAgICAgICAgICAgICAvL+iLpWN1YmXmspLooqvmuIXpmaTliYfliqDlhaVcclxuICAgICAgICAgICAgICAgIGlmICghY3ViZS5pc0NsZWFyICYmIGN1YmUucG9zLnkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50W2N1YmUucG9zLnldLnB1c2goY3ViZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvdW50LmZvckVhY2goZnVuY3Rpb24gKHJvdywgcikge1xyXG4gICAgICAgICAgICAvL+ipsuWIl+mDveacieWFg+e0oFxyXG4gICAgICAgICAgICBpZiAocm93Lmxlbmd0aCA9PT0gc2NlbmVXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgcm93LmZvckVhY2goZnVuY3Rpb24gKGN1YmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdWJlLmlzQ2xlYXIgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjbGVhclkucHVzaChyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBjbGVhclk7XHJcbiAgICB9O1xyXG4gICAgQ3ViZUVsaW1pbmF0b3IucmVtb3ZlQ2xlYXJhYmxlVGV0cmlzID0gZnVuY3Rpb24gKHRldHJpc2VzKSB7XHJcbiAgICAgICAgdGV0cmlzZXMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHZhciBleGlzdEN1YmVzID0gdGFyZ2V0LmN1YmVzLmZpbHRlcihmdW5jdGlvbiAoY3ViZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1YmUuaXNDbGVhciA9PT0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL2N1YmUuaXNDbGVhciDlhajmmK8gZmFsc2VcclxuICAgICAgICAgICAgaWYgKGV4aXN0Q3ViZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvL+enu+mZpOipsnRldHJpc1xyXG4gICAgICAgICAgICAgICAgdGV0cmlzZXMgPSB0ZXRyaXNlcy5maWx0ZXIoZnVuY3Rpb24gKHRldHJpcykgeyByZXR1cm4gdGV0cmlzICE9PSB0YXJnZXQ7IH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEN1YmVFbGltaW5hdG9yO1xyXG59KCkpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBDdWJlRWxpbWluYXRvcjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIGNvbnRleHRfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9jb250ZXh0XCIpKTtcclxudmFyIGJlaGF2aW9yUmVzb2x2ZXJfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9iZWhhdmlvclJlc29sdmVyXCIpKTtcclxudmFyIGtleWJvYXJkXzEgPSByZXF1aXJlKFwiLi9hY3Rpb24vY29uY3JldGUva2V5Ym9hcmRcIik7XHJcbnZhciBHYW1lID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gR2FtZShnYW1lV2luZG93LCBwcmVwYXJlV2luZG93LCBob2xkV2luZG93KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnVzZXJLZXlEb3duQmVoYXZpb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAga2V5Ym9hcmRfMS5hY3Rpb25zLmtleWRvd24uZm9yRWFjaChmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb24oZXZlbnQsIF90aGlzLl9jb250ZXh0KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJlaGF2aW9yUmVzb2x2ZXJfMS5kZWZhdWx0Lm5leHRUaWNrKF90aGlzLl9jb250ZXh0KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMudXNlcktleVVwQmVoYXZpb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAga2V5Ym9hcmRfMS5hY3Rpb25zLmtleXVwLmZvckVhY2goZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uKGV2ZW50LCBfdGhpcy5fY29udGV4dCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBiZWhhdmlvclJlc29sdmVyXzEuZGVmYXVsdC5uZXh0VGljayhfdGhpcy5fY29udGV4dCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYmVoYXZpb3JSZXNvbHZlcl8xLmRlZmF1bHQuY3VyclRldHJpc0Rvd24oX3RoaXMuX2NvbnRleHQpO1xyXG4gICAgICAgICAgICBiZWhhdmlvclJlc29sdmVyXzEuZGVmYXVsdC5uZXh0VGljayhfdGhpcy5fY29udGV4dCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5fY29udGV4dC5nYW1lb3Zlcikge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoXCJnYW1lb3ZlclwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IG5ldyBjb250ZXh0XzEuZGVmYXVsdChnYW1lV2luZG93LCBwcmVwYXJlV2luZG93LCBob2xkV2luZG93LCB0aGlzLnVwZGF0ZSk7XHJcbiAgICB9XHJcbiAgICBHYW1lLnByb3RvdHlwZS5yZWdpc3RlclVzZXJCZWhhdmlvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLnVzZXJLZXlEb3duQmVoYXZpb3IpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLnVzZXJLZXlVcEJlaGF2aW9yKTtcclxuICAgIH07XHJcbiAgICBHYW1lLnByb3RvdHlwZS5yZW1vdmVVc2VyQmVoYXZpb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy51c2VyS2V5RG93bkJlaGF2aW9yKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy51c2VyS2V5VXBCZWhhdmlvcik7XHJcbiAgICB9O1xyXG4gICAgR2FtZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NvbnRleHQuZ2FtZW92ZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2NvbnRleHQuZG93blRpbWVyLnN0YXJ0KCk7XHJcbiAgICAgICAgdGhpcy5fY29udGV4dC5yZW5kZXJUaW1lci5zdGFydCgpO1xyXG4gICAgICAgIGJlaGF2aW9yUmVzb2x2ZXJfMS5kZWZhdWx0LnJlbmRlclByZXBhcmVXaW5kb3codGhpcy5fY29udGV4dCk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlclVzZXJCZWhhdmlvcigpO1xyXG4gICAgfTtcclxuICAgIEdhbWUucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fY29udGV4dC5kb3duVGltZXIuc3RvcCgpO1xyXG4gICAgICAgIHRoaXMuX2NvbnRleHQucmVuZGVyVGltZXIuc3RvcCgpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlVXNlckJlaGF2aW9yKCk7XHJcbiAgICB9O1xyXG4gICAgR2FtZS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2EgPSB0aGlzLl9jb250ZXh0LCBnYW1lV2luZG93ID0gX2EuZ2FtZVdpbmRvdywgcHJlcGFyZVdpbmRvdyA9IF9hLnByZXBhcmVXaW5kb3csIGhvbGRXaW5kb3cgPSBfYS5ob2xkV2luZG93O1xyXG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBuZXcgY29udGV4dF8xLmRlZmF1bHQoZ2FtZVdpbmRvdywgcHJlcGFyZVdpbmRvdywgaG9sZFdpbmRvdywgdGhpcy51cGRhdGUpO1xyXG4gICAgICAgIGJlaGF2aW9yUmVzb2x2ZXJfMS5kZWZhdWx0LndpbmRvd0luaXQodGhpcy5fY29udGV4dCk7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVVc2VyQmVoYXZpb3IoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gR2FtZTtcclxufSgpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gR2FtZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5UeXBlcyA9IGV4cG9ydHMuSG9sZFdpbmRvdyA9IGV4cG9ydHMuUHJlcGFyZVdpbmRvdyA9IGV4cG9ydHMuTWFpbldpbmRvdyA9IHZvaWQgMDtcclxudmFyIGdhbWVXaW5kb3dfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vZ2FtZVdpbmRvd1wiKSk7XHJcbnZhciBNYWluV2luZG93ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKE1haW5XaW5kb3csIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBNYWluV2luZG93KCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIE1haW5XaW5kb3cucHJvdG90eXBlLnJlbmRlclRldHJpcyA9IGZ1bmN0aW9uICh0ZXRyaXNlcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VTdHlsZSA9IFwiIzU1NTU1NVwiO1xyXG4gICAgICAgIHRldHJpc2VzLmZvckVhY2goZnVuY3Rpb24gKHRldHJpcykge1xyXG4gICAgICAgICAgICB0ZXRyaXMuY3ViZXMuZm9yRWFjaChmdW5jdGlvbiAoY3ViZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjdWJlLmlzQ2xlYXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IGN1YmUucG9zO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gcC54ICogX3RoaXMuX3VuaXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBwLnkgKiBfdGhpcy5fdW5pdDtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fY29udGV4dC5yZWN0KHgsIHksIF90aGlzLl91bml0LCBfdGhpcy5fdW5pdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2NvbnRleHQuZmlsbFN0eWxlID0gdGV0cmlzLmNvbG9yO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9jb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTWFpbldpbmRvdy5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB3aWR0aCA9IHRoaXMud2lkdGggKiB0aGlzLl91bml0O1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodCAqIHRoaXMuX3VuaXQ7XHJcbiAgICAgICAgdGhpcy5fY2FudmFzLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHdpZHRoLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIHRoaXMuX2NhbnZhcy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgaGVpZ2h0LnRvU3RyaW5nKCkpO1xyXG4gICAgfTtcclxuICAgIE1haW5XaW5kb3cucHJvdG90eXBlLnJlbmRlckRlZmluZSA9IGZ1bmN0aW9uICh0ZXRyaXNlcykge1xyXG4gICAgICAgIHRoaXMucmVuZGVyVGV0cmlzKHRldHJpc2VzKTtcclxuICAgICAgICB0aGlzLnJlbmRlckdyaWQoKTtcclxuICAgIH07XHJcbiAgICBNYWluV2luZG93LnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMucmVzaXplKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJHcmlkKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1haW5XaW5kb3c7XHJcbn0oZ2FtZVdpbmRvd18xLmRlZmF1bHQpKTtcclxuZXhwb3J0cy5NYWluV2luZG93ID0gTWFpbldpbmRvdztcclxudmFyIE5vdEdyaWRXaW5kb3cgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoTm90R3JpZFdpbmRvdywgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE5vdEdyaWRXaW5kb3coY2FudmFzLCB1bml0KSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGNhbnZhcywgMCwgMCwgdW5pdCkgfHwgdGhpcztcclxuICAgIH1cclxuICAgIE5vdEdyaWRXaW5kb3cucHJvdG90eXBlLnJlbmRlclRldHJpcyA9IGZ1bmN0aW9uICh0ZXRyaXNlcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRldHJpcyA9IHRldHJpc2VzWzBdO1xyXG4gICAgICAgIHRoaXMuX2NvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiM1NTU1NTVcIjtcclxuICAgICAgICB0ZXRyaXMuY3ViZXMuZm9yRWFjaChmdW5jdGlvbiAoY3ViZSkge1xyXG4gICAgICAgICAgICB2YXIgdHAgPSB0ZXRyaXMucG9zO1xyXG4gICAgICAgICAgICB2YXIgcCA9IGN1YmUucG9zO1xyXG4gICAgICAgICAgICBfdGhpcy5fY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgLy/lgY/np7tcclxuICAgICAgICAgICAgdmFyIHggPSAocC54IC0gdHAueCkgKiBfdGhpcy5fdW5pdDtcclxuICAgICAgICAgICAgdmFyIHkgPSAocC55IC0gdHAueSkgKiBfdGhpcy5fdW5pdDtcclxuICAgICAgICAgICAgX3RoaXMuX2NvbnRleHQucmVjdCh4LCB5LCBfdGhpcy5fdW5pdCwgX3RoaXMuX3VuaXQpO1xyXG4gICAgICAgICAgICBfdGhpcy5fY29udGV4dC5maWxsU3R5bGUgPSB0ZXRyaXMuY29sb3I7XHJcbiAgICAgICAgICAgIF90aGlzLl9jb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgX3RoaXMuX2NvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTm90R3JpZFdpbmRvdy5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24gKHRldHJpcykge1xyXG4gICAgICAgIHZhciB3aWR0aCA9IHRldHJpcy5vcmlnaW5XaWR0aCAqIHRoaXMuX3VuaXQ7XHJcbiAgICAgICAgdmFyIGhlaWdodCA9IHRldHJpcy5vcmlnaW5IZWlnaHQgKiB0aGlzLl91bml0O1xyXG4gICAgICAgIHRoaXMuX2NhbnZhcy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCB3aWR0aC50b1N0cmluZygpKTtcclxuICAgICAgICB0aGlzLl9jYW52YXMuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsIGhlaWdodC50b1N0cmluZygpKTtcclxuICAgIH07XHJcbiAgICBOb3RHcmlkV2luZG93LnByb3RvdHlwZS5yZW5kZXJEZWZpbmUgPSBmdW5jdGlvbiAodGV0cmlzZXMpIHtcclxuICAgICAgICB0aGlzLnJlc2l6ZSh0ZXRyaXNlc1swXSk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJUZXRyaXModGV0cmlzZXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBOb3RHcmlkV2luZG93O1xyXG59KGdhbWVXaW5kb3dfMS5kZWZhdWx0KSk7XHJcbnZhciBQcmVwYXJlV2luZG93ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKFByZXBhcmVXaW5kb3csIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBQcmVwYXJlV2luZG93KCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIHJldHVybiBQcmVwYXJlV2luZG93O1xyXG59KE5vdEdyaWRXaW5kb3cpKTtcclxuZXhwb3J0cy5QcmVwYXJlV2luZG93ID0gUHJlcGFyZVdpbmRvdztcclxudmFyIEhvbGRXaW5kb3cgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoSG9sZFdpbmRvdywgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEhvbGRXaW5kb3coKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEhvbGRXaW5kb3c7XHJcbn0oTm90R3JpZFdpbmRvdykpO1xyXG5leHBvcnRzLkhvbGRXaW5kb3cgPSBIb2xkV2luZG93O1xyXG5leHBvcnRzLlR5cGVzID0geyBNYWluV2luZG93OiBNYWluV2luZG93LCBQcmVwYXJlV2luZG93OiBQcmVwYXJlV2luZG93LCBIb2xkV2luZG93OiBIb2xkV2luZG93IH07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciBHYW1lV2luZG93ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gR2FtZVdpbmRvdyhjYW52YXMsIHdpZHRoLCBoZWlnaHQsIHVuaXQpIHtcclxuICAgICAgICB0aGlzLl9jYW52YXMgPSBjYW52YXM7XHJcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgdGhpcy5fd2lkdGggPSB3aWR0aDtcclxuICAgICAgICB0aGlzLl9oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5fdW5pdCA9IHVuaXQ7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2FtZVdpbmRvdy5wcm90b3R5cGUsIFwid2lkdGhcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdhbWVXaW5kb3cucHJvdG90eXBlLCBcImhlaWdodFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgR2FtZVdpbmRvdy5wcm90b3R5cGUucmVuZGVyR3JpZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjNzc3Nzc3XCI7XHJcbiAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQubW92ZVRvKDAsIHkgKiB0aGlzLl91bml0ICsgdGhpcy5fdW5pdCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQubGluZVRvKHRoaXMud2lkdGggKiB0aGlzLl91bml0LCB5ICogdGhpcy5fdW5pdCArIHRoaXMuX3VuaXQpO1xyXG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHRoaXMud2lkdGg7IHgrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0Lm1vdmVUbyh4ICogdGhpcy5fdW5pdCArIHRoaXMuX3VuaXQsIDApO1xyXG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LmxpbmVUbyh4ICogdGhpcy5fdW5pdCArIHRoaXMuX3VuaXQsIHRoaXMuX2NhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBHYW1lV2luZG93LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAodGV0cmlzZXMpIHtcclxuICAgICAgICB0aGlzLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJEZWZpbmUodGV0cmlzZXMpO1xyXG4gICAgfTtcclxuICAgIEdhbWVXaW5kb3cucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMuX2NhbnZhcy53aWR0aCwgdGhpcy5fY2FudmFzLmhlaWdodCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEdhbWVXaW5kb3c7XHJcbn0oKSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IEdhbWVXaW5kb3c7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciBBcnJheUhlbHBlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFycmF5SGVscGVyKCkge1xyXG4gICAgfVxyXG4gICAgQXJyYXlIZWxwZXIuY3JlYXRlMkQgPSBmdW5jdGlvbiAocm93LCBjb2wsIGZpbGwpIHtcclxuICAgICAgICB2YXIgYXJyID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCByb3c7IHIrKykge1xyXG4gICAgICAgICAgICBhcnIucHVzaChbXSk7XHJcbiAgICAgICAgICAgIGlmIChjb2wpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyW3JdID0gbmV3IEFycmF5KGNvbCkuZmlsbChmaWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBcnJheUhlbHBlcjtcclxufSgpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gQXJyYXlIZWxwZXI7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciBnYW1lV2luZG93XzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vZmFjdG9yeS9nYW1lV2luZG93XCIpKTtcclxudmFyIGdhbWVXaW5kb3dfMiA9IHJlcXVpcmUoXCIuL2dhbWUvd2luZG93L2NvbmNyZXRlL2dhbWVXaW5kb3dcIik7XHJcbnZhciBnYW1lXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vZ2FtZS9nYW1lXCIpKTtcclxuLy8g56aB5q2i54m55a6a5oyJ6Y216Ke455m86aCB6Z2i5ru+5YuVXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIHZhciBkaXNhYmxlS2V5ID0gW1wiQXJyb3dVcFwiLCBcIkFycm93RG93blwiLCBcIkFycm93TGVmdFwiLCBcIkFycm93UmlnaHRcIiwgXCIgXCJdO1xyXG4gICAgaWYgKGRpc2FibGVLZXkuaW5jbHVkZXMoZXZlbnQua2V5KSkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9XHJcbn0pO1xyXG52YXIgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNnYW1lV2luZG93XCIpO1xyXG52YXIgcHJlcGFyZUNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjbmV4dC1hcmVhID4gLmNhbnZhcy13cmFwcGVyID4gY2FudmFzXCIpO1xyXG52YXIgaG9sZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaG9sZFwiKTtcclxudmFyIHN0YXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzdGFydFwiKTtcclxudmFyIHN0b3AgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3N0b3BcIik7XHJcbnZhciByZXNldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcmVzZXRcIik7XHJcbnZhciB1bml0ID0gMjA7XHJcbnZhciB1bml0MiA9IDEzO1xyXG52YXIgZ2FtZVdpbmRvdyA9IGdhbWVXaW5kb3dfMS5kZWZhdWx0LmNyZWF0ZShnYW1lV2luZG93XzIuTWFpbldpbmRvdy5uYW1lLCBjYW52YXMsIDE0LCAyNCwgdW5pdCk7XHJcbnZhciBwcmVwYXJlV2luZG93cyA9IFtdO1xyXG5wcmVwYXJlQ2FudmFzLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcclxuICAgIGMuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsICh1bml0MiAqIDQpLnRvU3RyaW5nKCkpO1xyXG4gICAgYy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgKHVuaXQyICogNCkudG9TdHJpbmcoKSk7XHJcbiAgICBwcmVwYXJlV2luZG93cy5wdXNoKGdhbWVXaW5kb3dfMS5kZWZhdWx0LmNyZWF0ZShnYW1lV2luZG93XzIuUHJlcGFyZVdpbmRvdy5uYW1lLCBjLCB1bml0MikpO1xyXG59KTtcclxuaG9sZC5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgKHVuaXQyICogNCkudG9TdHJpbmcoKSk7XHJcbmhvbGQuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsICh1bml0MiAqIDQpLnRvU3RyaW5nKCkpO1xyXG52YXIgaG9sZFdpbmRvdyA9IGdhbWVXaW5kb3dfMS5kZWZhdWx0LmNyZWF0ZShnYW1lV2luZG93XzIuSG9sZFdpbmRvdy5uYW1lLCBob2xkLCB1bml0Mik7XHJcbmdhbWVXaW5kb3cuaW5pdGlhbGl6ZSgpO1xyXG52YXIgZ2FtZSA9IG5ldyBnYW1lXzEuZGVmYXVsdChnYW1lV2luZG93LCBwcmVwYXJlV2luZG93cywgaG9sZFdpbmRvdyk7XHJcbnN0YXJ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBnYW1lLnN0YXJ0KCk7XHJcbiAgICBzdGFydC5zdHlsZS5jb2xvciA9IFwid2hpdGVcIjtcclxuICAgIHN0b3Auc3R5bGUuY29sb3IgPSBcIiM4ODg4ODhcIjtcclxuICAgIHJlc2V0LnN0eWxlLmNvbG9yID0gXCIjODg4ODg4XCI7XHJcbn0pO1xyXG5zdG9wLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBnYW1lLnN0b3AoKTtcclxuICAgIHN0b3Auc3R5bGUuY29sb3IgPSBcIndoaXRlXCI7XHJcbiAgICBzdGFydC5zdHlsZS5jb2xvciA9IFwiIzg4ODg4OFwiO1xyXG4gICAgcmVzZXQuc3R5bGUuY29sb3IgPSBcIiM4ODg4ODhcIjtcclxufSk7XHJcbnJlc2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIGdhbWUuc3RvcCgpO1xyXG4gICAgZ2FtZS5pbml0aWFsaXplKCk7XHJcbiAgICByZXNldC5zdHlsZS5jb2xvciA9IFwid2hpdGVcIjtcclxuICAgIHN0YXJ0LnN0eWxlLmNvbG9yID0gXCIjODg4ODg4XCI7XHJcbiAgICBzdG9wLnN0eWxlLmNvbG9yID0gXCIjODg4ODg4XCI7XHJcbn0pO1xyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcInBcIikge1xyXG4gICAgICAgIHN0b3AuY2xpY2soKTtcclxuICAgIH1cclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICAgIHN0YXJ0LmNsaWNrKCk7XHJcbiAgICB9XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcInJcIikge1xyXG4gICAgICAgIHJlc2V0LmNsaWNrKCk7XHJcbiAgICB9XHJcbn0pO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgUG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQb2ludCh4LCB5KSB7XHJcbiAgICAgICAgdGhpcy5feCA9IHg7XHJcbiAgICAgICAgdGhpcy5feSA9IHk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUG9pbnQucHJvdG90eXBlLCBcInhcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5feDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICA7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUG9pbnQucHJvdG90eXBlLCBcInlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5feTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBQb2ludC5wcm90b3R5cGUucGx1cyA9IGZ1bmN0aW9uIChwKSB7XHJcbiAgICAgICAgdmFyIHggPSB0aGlzLl94ICsgcC54O1xyXG4gICAgICAgIHZhciB5ID0gdGhpcy5feSArIHAueTtcclxuICAgICAgICByZXR1cm4gbmV3IFBvaW50KHgsIHkpO1xyXG4gICAgfTtcclxuICAgIFBvaW50LnByb3RvdHlwZS5wbHVzV2l0aCA9IGZ1bmN0aW9uICh4LCB5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQb2ludCh0aGlzLl94ICsgeCwgdGhpcy5feSArIHkpO1xyXG4gICAgfTtcclxuICAgIFBvaW50LnByb3RvdHlwZS5zdWJ0cmFjdCA9IGZ1bmN0aW9uIChwKSB7XHJcbiAgICAgICAgdmFyIHggPSB0aGlzLl94IC0gcC54O1xyXG4gICAgICAgIHZhciB5ID0gdGhpcy5feSAtIHAueTtcclxuICAgICAgICByZXR1cm4gbmV3IFBvaW50KHgsIHkpO1xyXG4gICAgfTtcclxuICAgIFBvaW50LnByb3RvdHlwZS5zdWJ0cmFjdFdpdGggPSBmdW5jdGlvbiAoeCwgeSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUG9pbnQodGhpcy5feCAtIHgsIHRoaXMuX3kgLSB5KTtcclxuICAgIH07XHJcbiAgICBQb2ludC5wcm90b3R5cGUucGx1c1ggPSBmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUG9pbnQodGhpcy5feCArIHgsIHRoaXMueSk7XHJcbiAgICB9O1xyXG4gICAgUG9pbnQucHJvdG90eXBlLnBsdXNZID0gZnVuY3Rpb24gKHkpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBvaW50KHRoaXMueCwgdGhpcy5feSArIHkpO1xyXG4gICAgfTtcclxuICAgIFBvaW50LnByb3RvdHlwZS5zdWJ0cmFjdFggPSBmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUG9pbnQodGhpcy5feCAtIHgsIHRoaXMueSk7XHJcbiAgICB9O1xyXG4gICAgUG9pbnQucHJvdG90eXBlLnN1YnRyYWN0WSA9IGZ1bmN0aW9uICh5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQb2ludCh0aGlzLngsIHRoaXMuX3kgLSB5KTtcclxuICAgIH07XHJcbiAgICBQb2ludC5wcm90b3R5cGUuZXF1YWwgPSBmdW5jdGlvbiAocCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnggPT09IHAueCAmJiB0aGlzLnkgPT09IHAueTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUG9pbnQ7XHJcbn0oKSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IFBvaW50O1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgVGltZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUaW1lcihoYW5kbGUsIG1zKSB7XHJcbiAgICAgICAgdGhpcy5fdGltZXJJRCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fbXMgPSBtcztcclxuICAgICAgICB0aGlzLl9oYW5kbGUgPSBoYW5kbGU7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGltZXIucHJvdG90eXBlLCBcIm1zXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21zO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX21zID0gdmFsO1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFRpbWVyLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3RpbWVySUQpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZXJJRCA9IHNldEludGVydmFsKHRoaXMuX2hhbmRsZSwgdGhpcy5fbXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBUaW1lci5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fdGltZXJJRCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuX3RpbWVySUQpO1xyXG4gICAgICAgICAgICB0aGlzLl90aW1lcklEID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRpbWVyO1xyXG59KCkpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBUaW1lcjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5UeXBlcyA9IGV4cG9ydHMuWlRldHJpcyA9IGV4cG9ydHMuVFRldHJpcyA9IGV4cG9ydHMuU1RldHJpcyA9IGV4cG9ydHMuT1RldHJpcyA9IGV4cG9ydHMuTFRldHJpcyA9IGV4cG9ydHMuSlRldHJpcyA9IGV4cG9ydHMuSVRldHJpcyA9IHZvaWQgMDtcclxudmFyIHRldHJpc18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi90ZXRyaXNcIikpO1xyXG52YXIgSVRldHJpcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhJVGV0cmlzLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gSVRldHJpcygpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBJVGV0cmlzLnByb3RvdHlwZS5jb2xvckRlZmluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCIjNDJiMGY1XCI7XHJcbiAgICB9O1xyXG4gICAgSVRldHJpcy5wcm90b3R5cGUuc2hhcGVEZWZpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgWzAsIDAsIDAsIDBdLFxyXG4gICAgICAgICAgICBbMSwgMSwgMSwgMV0sXHJcbiAgICAgICAgICAgIFswLCAwLCAwLCAwXSxcclxuICAgICAgICAgICAgWzAsIDAsIDAsIDBdLFxyXG4gICAgICAgIF07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIElUZXRyaXM7XHJcbn0odGV0cmlzXzEuZGVmYXVsdCkpO1xyXG5leHBvcnRzLklUZXRyaXMgPSBJVGV0cmlzO1xyXG52YXIgSlRldHJpcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhKVGV0cmlzLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gSlRldHJpcygpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBKVGV0cmlzLnByb3RvdHlwZS5jb2xvckRlZmluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCIjMzg3NGZmXCI7XHJcbiAgICB9O1xyXG4gICAgSlRldHJpcy5wcm90b3R5cGUuc2hhcGVEZWZpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgWzEsIDAsIDBdLFxyXG4gICAgICAgICAgICBbMSwgMSwgMV0sXHJcbiAgICAgICAgICAgIFswLCAwLCAwXSxcclxuICAgICAgICBdO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBKVGV0cmlzO1xyXG59KHRldHJpc18xLmRlZmF1bHQpKTtcclxuZXhwb3J0cy5KVGV0cmlzID0gSlRldHJpcztcclxudmFyIExUZXRyaXMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoTFRldHJpcywgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIExUZXRyaXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgTFRldHJpcy5wcm90b3R5cGUuY29sb3JEZWZpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiI2ZmOGUyNFwiO1xyXG4gICAgfTtcclxuICAgIExUZXRyaXMucHJvdG90eXBlLnNoYXBlRGVmaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIFswLCAwLCAxXSxcclxuICAgICAgICAgICAgWzEsIDEsIDFdLFxyXG4gICAgICAgICAgICBbMCwgMCwgMF0sXHJcbiAgICAgICAgXTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTFRldHJpcztcclxufSh0ZXRyaXNfMS5kZWZhdWx0KSk7XHJcbmV4cG9ydHMuTFRldHJpcyA9IExUZXRyaXM7XHJcbnZhciBPVGV0cmlzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKE9UZXRyaXMsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBPVGV0cmlzKCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIE9UZXRyaXMucHJvdG90eXBlLmNvbG9yRGVmaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBcIiNmZmYyNDJcIjtcclxuICAgIH07XHJcbiAgICBPVGV0cmlzLnByb3RvdHlwZS5zaGFwZURlZmluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICBbMSwgMV0sXHJcbiAgICAgICAgICAgIFsxLCAxXSxcclxuICAgICAgICBdO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPVGV0cmlzO1xyXG59KHRldHJpc18xLmRlZmF1bHQpKTtcclxuZXhwb3J0cy5PVGV0cmlzID0gT1RldHJpcztcclxudmFyIFNUZXRyaXMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoU1RldHJpcywgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNUZXRyaXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgU1RldHJpcy5wcm90b3R5cGUuY29sb3JEZWZpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiIzAwZGUzZlwiO1xyXG4gICAgfTtcclxuICAgIFNUZXRyaXMucHJvdG90eXBlLnNoYXBlRGVmaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIFswLCAxLCAxXSxcclxuICAgICAgICAgICAgWzEsIDEsIDBdLFxyXG4gICAgICAgICAgICBbMCwgMCwgMF0sXHJcbiAgICAgICAgXTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU1RldHJpcztcclxufSh0ZXRyaXNfMS5kZWZhdWx0KSk7XHJcbmV4cG9ydHMuU1RldHJpcyA9IFNUZXRyaXM7XHJcbnZhciBUVGV0cmlzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKFRUZXRyaXMsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUVGV0cmlzKCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFRUZXRyaXMucHJvdG90eXBlLmNvbG9yRGVmaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBcIiNlNTU3ZjdcIjtcclxuICAgIH07XHJcbiAgICBUVGV0cmlzLnByb3RvdHlwZS5zaGFwZURlZmluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICBbMCwgMSwgMF0sXHJcbiAgICAgICAgICAgIFsxLCAxLCAxXSxcclxuICAgICAgICAgICAgWzAsIDAsIDBdLFxyXG4gICAgICAgIF07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRUZXRyaXM7XHJcbn0odGV0cmlzXzEuZGVmYXVsdCkpO1xyXG5leHBvcnRzLlRUZXRyaXMgPSBUVGV0cmlzO1xyXG52YXIgWlRldHJpcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhaVGV0cmlzLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gWlRldHJpcygpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBaVGV0cmlzLnByb3RvdHlwZS5jb2xvckRlZmluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCIjZmYxZjFmXCI7XHJcbiAgICB9O1xyXG4gICAgWlRldHJpcy5wcm90b3R5cGUuc2hhcGVEZWZpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgWzEsIDEsIDBdLFxyXG4gICAgICAgICAgICBbMCwgMSwgMV0sXHJcbiAgICAgICAgICAgIFswLCAwLCAwXSxcclxuICAgICAgICBdO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBaVGV0cmlzO1xyXG59KHRldHJpc18xLmRlZmF1bHQpKTtcclxuZXhwb3J0cy5aVGV0cmlzID0gWlRldHJpcztcclxuZXhwb3J0cy5UeXBlcyA9IHtcclxuICAgIElUZXRyaXM6IElUZXRyaXMsXHJcbiAgICBKVGV0cmlzOiBKVGV0cmlzLFxyXG4gICAgTFRldHJpczogTFRldHJpcyxcclxuICAgIE9UZXRyaXM6IE9UZXRyaXMsXHJcbiAgICBTVGV0cmlzOiBTVGV0cmlzLFxyXG4gICAgVFRldHJpczogVFRldHJpcyxcclxuICAgIFpUZXRyaXM6IFpUZXRyaXNcclxufTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIEN1YmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDdWJlKHJlbGF0aW9uUG9zLCBwb3MpIHtcclxuICAgICAgICB0aGlzLmlzQ2xlYXIgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnJlbGF0aW9uUG9zID0gcmVsYXRpb25Qb3M7XHJcbiAgICAgICAgdGhpcy5wb3MgPSBwb3M7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQ3ViZTtcclxufSgpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gQ3ViZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5TaGFwZVZhbHVlID0gdm9pZCAwO1xyXG52YXIgY3ViZV8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9mYWN0b3J5L2N1YmVcIikpO1xyXG52YXIgcG9pbnRfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vZmFjdG9yeS9wb2ludFwiKSk7XHJcbnZhciBhcnJheV8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9oZWxwZXIvYXJyYXlcIikpO1xyXG52YXIgU2hhcGVWYWx1ZTtcclxuKGZ1bmN0aW9uIChTaGFwZVZhbHVlKSB7XHJcbiAgICBTaGFwZVZhbHVlW1NoYXBlVmFsdWVbXCJVTkRFRklORURcIl0gPSAtMV0gPSBcIlVOREVGSU5FRFwiO1xyXG4gICAgU2hhcGVWYWx1ZVtTaGFwZVZhbHVlW1wiREVGSU5FRFwiXSA9IDFdID0gXCJERUZJTkVEXCI7XHJcbiAgICBTaGFwZVZhbHVlW1NoYXBlVmFsdWVbXCJFTVBUWVwiXSA9IDBdID0gXCJFTVBUWVwiO1xyXG59KShTaGFwZVZhbHVlID0gZXhwb3J0cy5TaGFwZVZhbHVlIHx8IChleHBvcnRzLlNoYXBlVmFsdWUgPSB7fSkpO1xyXG52YXIgVGV0cmlzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVGV0cmlzKCkge1xyXG4gICAgICAgIHRoaXMuX29yaWdpblBvcyA9IHBvaW50XzEuZGVmYXVsdC5jcmVhdGVNaW4oKTtcclxuICAgICAgICB0aGlzLl9wb3MgPSBwb2ludF8xLmRlZmF1bHQuY3JlYXRlTWluKCk7XHJcbiAgICAgICAgdGhpcy5fbmV4dFBvcyA9IHBvaW50XzEuZGVmYXVsdC5jcmVhdGVNaW4oKTtcclxuICAgICAgICB0aGlzLl9jdWJlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX2NvbG9yID0gdGhpcy5jb2xvckRlZmluZSgpO1xyXG4gICAgICAgIHRoaXMuX29yaWdpblNoYXBlID0gdGhpcy5zaGFwZURlZmluZSgpO1xyXG4gICAgICAgIHRoaXMuX25leHRTaGFwZSA9IHRoaXMuX29yaWdpblNoYXBlLnNsaWNlKCk7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudFNoYXBlID0gdGhpcy5fb3JpZ2luU2hhcGUuc2xpY2UoKTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXRyaXMucHJvdG90eXBlLCBcIndpZHRoXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRTaGFwZVswXS5sZW5ndGg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRldHJpcy5wcm90b3R5cGUsIFwiaGVpZ2h0XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRTaGFwZS5sZW5ndGg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRldHJpcy5wcm90b3R5cGUsIFwicG9zXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BvcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BvcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLl9jdWJlcyA9IHRoaXMuZ2VuZXJhdGVDdWJlcyh0aGlzLnBvcywgdGhpcy5fY3VycmVudFNoYXBlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV0cmlzLnByb3RvdHlwZSwgXCJvcmlnaW5Qb3NcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3JpZ2luUG9zO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAocCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vcmlnaW5Qb3MueCA9PT0gTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIgJiYgdGhpcy5vcmlnaW5Qb3MueSA9PT0gTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX29yaWdpblBvcyA9IHBvaW50XzEuZGVmYXVsdC5jcmVhdGVCeVBvaW50KHApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3MgPSBwb2ludF8xLmRlZmF1bHQuY3JlYXRlQnlQb2ludChwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25leHRQb3MgPSBwb2ludF8xLmRlZmF1bHQuY3JlYXRlQnlQb2ludChwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXRyaXMucHJvdG90eXBlLCBcIm9yaWdpbldpZHRoXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29yaWdpblNoYXBlWzBdLmxlbmd0aDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV0cmlzLnByb3RvdHlwZSwgXCJvcmlnaW5IZWlnaHRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3JpZ2luU2hhcGUubGVuZ3RoO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXRyaXMucHJvdG90eXBlLCBcImN1YmVzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1YmVzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXRyaXMucHJvdG90eXBlLCBcIm5leHRDdWJlc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlQ3ViZXModGhpcy5fbmV4dFBvcywgdGhpcy5fbmV4dFNoYXBlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV0cmlzLnByb3RvdHlwZSwgXCJjb2xvclwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb2xvcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV0cmlzLnByb3RvdHlwZSwgXCJjdXJyZW50U2hhcGVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudFNoYXBlLnNsaWNlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgVGV0cmlzLnByb3RvdHlwZS5nZW5lcmF0ZUN1YmVzID0gZnVuY3Rpb24gKHBvcywgc2hhcGUpIHtcclxuICAgICAgICB2YXIgY3ViZXMgPSBbXTtcclxuICAgICAgICBzaGFwZS5mb3JFYWNoKGZ1bmN0aW9uIChyb3csIHIpIHtcclxuICAgICAgICAgICAgcm93LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50ID09PSBTaGFwZVZhbHVlLkRFRklORUQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVsYXRpb25Qb3MgPSBwb2ludF8xLmRlZmF1bHQuY3JlYXRlKGMsIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlbGF0aW9uUG9zLnBsdXMocG9zKTtcclxuICAgICAgICAgICAgICAgICAgICBjdWJlcy5wdXNoKGN1YmVfMS5kZWZhdWx0LmNyZWF0ZShyZWxhdGlvblBvcywgcG9zaXRpb24pKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGN1YmVzO1xyXG4gICAgfTtcclxuICAgIFRldHJpcy5wcm90b3R5cGUuZmluZEN1YmVCeVBvcyA9IGZ1bmN0aW9uIChwb3MsIGlzQ2xlYXIpIHtcclxuICAgICAgICBpZiAoaXNDbGVhciA9PT0gdm9pZCAwKSB7IGlzQ2xlYXIgPSBmYWxzZTsgfVxyXG4gICAgICAgIHZhciBjdWJlID0gdGhpcy5fY3ViZXMuZmluZChmdW5jdGlvbiAoY3ViZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY3ViZS5wb3MuZXF1YWwocG9zKSAmJiBjdWJlLmlzQ2xlYXIgPT09IGlzQ2xlYXI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGN1YmU7XHJcbiAgICB9O1xyXG4gICAgVGV0cmlzLnByb3RvdHlwZS5maW5kQ3ViZSA9IGZ1bmN0aW9uIChjdWJlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1YmVzLmZpbmQoZnVuY3Rpb24gKGVsKSB7IHJldHVybiBlbCA9PT0gY3ViZTsgfSk7XHJcbiAgICB9O1xyXG4gICAgVGV0cmlzLnByb3RvdHlwZS5yb3RhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHJvdyA9IHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBjb2wgPSB0aGlzLndpZHRoO1xyXG4gICAgICAgIHZhciBuZXdTaGFwZSA9IGFycmF5XzEuZGVmYXVsdC5jcmVhdGUyRChjb2wsIHJvdywgU2hhcGVWYWx1ZS5FTVBUWSk7XHJcbiAgICAgICAgdmFyIG5ld1JvdyA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCByb3c7IHIrKykge1xyXG4gICAgICAgICAgICBuZXdSb3cgPSAwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGNvbDsgYysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gdGhpcy5fY3VycmVudFNoYXBlW3JdW2NdO1xyXG4gICAgICAgICAgICAgICAgbmV3U2hhcGVbbmV3Um93XVtyb3cgLSByIC0gMV0gPSB2YWw7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsID09PSBTaGFwZVZhbHVlLkRFRklORUQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ2luQ3ViZSA9IHRoaXMuZmluZEN1YmVCeVBvcyhwb2ludF8xLmRlZmF1bHQuY3JlYXRlKGMsIHIpKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3JpZ2luQ3ViZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q3ViZSA9IGN1YmVfMS5kZWZhdWx0LmNyZWF0ZShwb2ludF8xLmRlZmF1bHQuY3JlYXRlKHIsIG5ld1JvdykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RldHJpc+W3puS4iuinkuS5i+W6p+aomSArIOWBj+enu+mHj1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDdWJlLnBvcyA9IHRoaXMucG9zLnBsdXNXaXRoKHIsIGMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG5ld1JvdysrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX25leHRTaGFwZSA9IG5ld1NoYXBlO1xyXG4gICAgfTtcclxuICAgIFRldHJpcy5wcm90b3R5cGUubGVmdCA9IGZ1bmN0aW9uIChhbW91bnQpIHtcclxuICAgICAgICBpZiAoYW1vdW50ID09PSB2b2lkIDApIHsgYW1vdW50ID0gMTsgfVxyXG4gICAgICAgIHRoaXMuX25leHRQb3MgPSB0aGlzLnBvcy5zdWJ0cmFjdFgoYW1vdW50KTtcclxuICAgIH07XHJcbiAgICBUZXRyaXMucHJvdG90eXBlLnJpZ2h0ID0gZnVuY3Rpb24gKGFtb3VudCkge1xyXG4gICAgICAgIGlmIChhbW91bnQgPT09IHZvaWQgMCkgeyBhbW91bnQgPSAxOyB9XHJcbiAgICAgICAgdGhpcy5fbmV4dFBvcyA9IHRoaXMucG9zLnBsdXNYKGFtb3VudCk7XHJcbiAgICB9O1xyXG4gICAgVGV0cmlzLnByb3RvdHlwZS51cCA9IGZ1bmN0aW9uIChhbW91bnQpIHtcclxuICAgICAgICBpZiAoYW1vdW50ID09PSB2b2lkIDApIHsgYW1vdW50ID0gMTsgfVxyXG4gICAgICAgIHRoaXMuX25leHRQb3MgPSB0aGlzLnBvcy5zdWJ0cmFjdFkoYW1vdW50KTtcclxuICAgIH07XHJcbiAgICBUZXRyaXMucHJvdG90eXBlLmRvd24gPSBmdW5jdGlvbiAoYW1vdW50KSB7XHJcbiAgICAgICAgaWYgKGFtb3VudCA9PT0gdm9pZCAwKSB7IGFtb3VudCA9IDE7IH1cclxuICAgICAgICB0aGlzLl9uZXh0UG9zID0gdGhpcy5wb3MucGx1c1koYW1vdW50KTtcclxuICAgIH07XHJcbiAgICBUZXRyaXMucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9jdXJyZW50U2hhcGUgPSB0aGlzLl9uZXh0U2hhcGUuc2xpY2UoKTtcclxuICAgICAgICB0aGlzLnBvcyA9IHBvaW50XzEuZGVmYXVsdC5jcmVhdGVCeVBvaW50KHRoaXMuX25leHRQb3MpO1xyXG4gICAgfTtcclxuICAgIFRldHJpcy5wcm90b3R5cGUuYmFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9uZXh0U2hhcGUgPSB0aGlzLl9jdXJyZW50U2hhcGUuc2xpY2UoKTtcclxuICAgICAgICB0aGlzLl9uZXh0UG9zID0gcG9pbnRfMS5kZWZhdWx0LmNyZWF0ZUJ5UG9pbnQodGhpcy5wb3MpO1xyXG4gICAgfTtcclxuICAgIFRldHJpcy5wcm90b3R5cGUucG9zSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnBvcyA9IHBvaW50XzEuZGVmYXVsdC5jcmVhdGVCeVBvaW50KHRoaXMub3JpZ2luUG9zKTtcclxuICAgICAgICB0aGlzLl9uZXh0UG9zID0gcG9pbnRfMS5kZWZhdWx0LmNyZWF0ZUJ5UG9pbnQodGhpcy5vcmlnaW5Qb3MpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUZXRyaXM7XHJcbn0oKSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IFRldHJpcztcclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0dmFyIGV4ZWNPcHRpb25zID0geyBpZDogbW9kdWxlSWQsIG1vZHVsZTogbW9kdWxlLCBmYWN0b3J5OiBfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXSwgcmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfXyB9O1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkuZm9yRWFjaChmdW5jdGlvbihoYW5kbGVyKSB7IGhhbmRsZXIoZXhlY09wdGlvbnMpOyB9KTtcblx0bW9kdWxlID0gZXhlY09wdGlvbnMubW9kdWxlO1xuXHRleGVjT3B0aW9ucy5mYWN0b3J5LmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIGV4ZWNPcHRpb25zLnJlcXVpcmUpO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX187XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlIGV4ZWN1dGlvbiBpbnRlcmNlcHRvclxuX193ZWJwYWNrX3JlcXVpcmVfXy5pID0gW107XG5cbiIsIi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGFsbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uaHUgPSAoY2h1bmtJZCkgPT4ge1xuXHQvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcblx0cmV0dXJuIFwiXCIgKyBjaHVua0lkICsgXCIuXCIgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLmgoKSArIFwiLmhvdC11cGRhdGUuanNcIjtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5obXJGID0gKCkgPT4gKFwibWFpbi5cIiArIF9fd2VicGFja19yZXF1aXJlX18uaCgpICsgXCIuaG90LXVwZGF0ZS5qc29uXCIpOyIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcImFiYmE1ZjVlNjJkNTk5NDM0YjkwXCIpIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwidmFyIGluUHJvZ3Jlc3MgPSB7fTtcbnZhciBkYXRhV2VicGFja1ByZWZpeCA9IFwiVGV0cmlzOlwiO1xuLy8gbG9hZFNjcmlwdCBmdW5jdGlvbiB0byBsb2FkIGEgc2NyaXB0IHZpYSBzY3JpcHQgdGFnXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmwgPSAodXJsLCBkb25lLCBrZXksIGNodW5rSWQpID0+IHtcblx0aWYoaW5Qcm9ncmVzc1t1cmxdKSB7IGluUHJvZ3Jlc3NbdXJsXS5wdXNoKGRvbmUpOyByZXR1cm47IH1cblx0dmFyIHNjcmlwdCwgbmVlZEF0dGFjaDtcblx0aWYoa2V5ICE9PSB1bmRlZmluZWQpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzY3JpcHRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgcyA9IHNjcmlwdHNbaV07XG5cdFx0XHRpZihzLmdldEF0dHJpYnV0ZShcInNyY1wiKSA9PSB1cmwgfHwgcy5nZXRBdHRyaWJ1dGUoXCJkYXRhLXdlYnBhY2tcIikgPT0gZGF0YVdlYnBhY2tQcmVmaXggKyBrZXkpIHsgc2NyaXB0ID0gczsgYnJlYWs7IH1cblx0XHR9XG5cdH1cblx0aWYoIXNjcmlwdCkge1xuXHRcdG5lZWRBdHRhY2ggPSB0cnVlO1xuXHRcdHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuXG5cdFx0c2NyaXB0LmNoYXJzZXQgPSAndXRmLTgnO1xuXHRcdHNjcmlwdC50aW1lb3V0ID0gMTIwO1xuXHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKSB7XG5cdFx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKFwibm9uY2VcIiwgX193ZWJwYWNrX3JlcXVpcmVfXy5uYyk7XG5cdFx0fVxuXHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXdlYnBhY2tcIiwgZGF0YVdlYnBhY2tQcmVmaXggKyBrZXkpO1xuXHRcdHNjcmlwdC5zcmMgPSB1cmw7XG5cdH1cblx0aW5Qcm9ncmVzc1t1cmxdID0gW2RvbmVdO1xuXHR2YXIgb25TY3JpcHRDb21wbGV0ZSA9IChwcmV2LCBldmVudCkgPT4ge1xuXHRcdC8vIGF2b2lkIG1lbSBsZWFrcyBpbiBJRS5cblx0XHRzY3JpcHQub25lcnJvciA9IHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuXHRcdGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0XHR2YXIgZG9uZUZucyA9IGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRkZWxldGUgaW5Qcm9ncmVzc1t1cmxdO1xuXHRcdHNjcmlwdC5wYXJlbnROb2RlICYmIHNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG5cdFx0ZG9uZUZucyAmJiBkb25lRm5zLmZvckVhY2goKGZuKSA9PiAoZm4oZXZlbnQpKSk7XG5cdFx0aWYocHJldikgcmV0dXJuIHByZXYoZXZlbnQpO1xuXHR9XG5cdDtcblx0dmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCB1bmRlZmluZWQsIHsgdHlwZTogJ3RpbWVvdXQnLCB0YXJnZXQ6IHNjcmlwdCB9KSwgMTIwMDAwKTtcblx0c2NyaXB0Lm9uZXJyb3IgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9uZXJyb3IpO1xuXHRzY3JpcHQub25sb2FkID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmxvYWQpO1xuXHRuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbn07IiwidmFyIGN1cnJlbnRNb2R1bGVEYXRhID0ge307XG52YXIgaW5zdGFsbGVkTW9kdWxlcyA9IF9fd2VicGFja19yZXF1aXJlX18uYztcblxuLy8gbW9kdWxlIGFuZCByZXF1aXJlIGNyZWF0aW9uXG52YXIgY3VycmVudENoaWxkTW9kdWxlO1xudmFyIGN1cnJlbnRQYXJlbnRzID0gW107XG5cbi8vIHN0YXR1c1xudmFyIHJlZ2lzdGVyZWRTdGF0dXNIYW5kbGVycyA9IFtdO1xudmFyIGN1cnJlbnRTdGF0dXMgPSBcImlkbGVcIjtcblxuLy8gd2hpbGUgZG93bmxvYWRpbmdcbnZhciBibG9ja2luZ1Byb21pc2VzO1xuXG4vLyBUaGUgdXBkYXRlIGluZm9cbnZhciBjdXJyZW50VXBkYXRlQXBwbHlIYW5kbGVycztcbnZhciBxdWV1ZWRJbnZhbGlkYXRlZE1vZHVsZXM7XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5obXJEID0gY3VycmVudE1vZHVsZURhdGE7XG5cbl9fd2VicGFja19yZXF1aXJlX18uaS5wdXNoKGZ1bmN0aW9uIChvcHRpb25zKSB7XG5cdHZhciBtb2R1bGUgPSBvcHRpb25zLm1vZHVsZTtcblx0dmFyIHJlcXVpcmUgPSBjcmVhdGVSZXF1aXJlKG9wdGlvbnMucmVxdWlyZSwgb3B0aW9ucy5pZCk7XG5cdG1vZHVsZS5ob3QgPSBjcmVhdGVNb2R1bGVIb3RPYmplY3Qob3B0aW9ucy5pZCwgbW9kdWxlKTtcblx0bW9kdWxlLnBhcmVudHMgPSBjdXJyZW50UGFyZW50cztcblx0bW9kdWxlLmNoaWxkcmVuID0gW107XG5cdGN1cnJlbnRQYXJlbnRzID0gW107XG5cdG9wdGlvbnMucmVxdWlyZSA9IHJlcXVpcmU7XG59KTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5obXJDID0ge307XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmhtckkgPSB7fTtcblxuZnVuY3Rpb24gY3JlYXRlUmVxdWlyZShyZXF1aXJlLCBtb2R1bGVJZCkge1xuXHR2YXIgbWUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXTtcblx0aWYgKCFtZSkgcmV0dXJuIHJlcXVpcmU7XG5cdHZhciBmbiA9IGZ1bmN0aW9uIChyZXF1ZXN0KSB7XG5cdFx0aWYgKG1lLmhvdC5hY3RpdmUpIHtcblx0XHRcdGlmIChpbnN0YWxsZWRNb2R1bGVzW3JlcXVlc3RdKSB7XG5cdFx0XHRcdHZhciBwYXJlbnRzID0gaW5zdGFsbGVkTW9kdWxlc1tyZXF1ZXN0XS5wYXJlbnRzO1xuXHRcdFx0XHRpZiAocGFyZW50cy5pbmRleE9mKG1vZHVsZUlkKSA9PT0gLTEpIHtcblx0XHRcdFx0XHRwYXJlbnRzLnB1c2gobW9kdWxlSWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjdXJyZW50UGFyZW50cyA9IFttb2R1bGVJZF07XG5cdFx0XHRcdGN1cnJlbnRDaGlsZE1vZHVsZSA9IHJlcXVlc3Q7XG5cdFx0XHR9XG5cdFx0XHRpZiAobWUuY2hpbGRyZW4uaW5kZXhPZihyZXF1ZXN0KSA9PT0gLTEpIHtcblx0XHRcdFx0bWUuY2hpbGRyZW4ucHVzaChyZXF1ZXN0KTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFxuXHRcdFx0XHRcIltITVJdIHVuZXhwZWN0ZWQgcmVxdWlyZShcIiArXG5cdFx0XHRcdFx0cmVxdWVzdCArXG5cdFx0XHRcdFx0XCIpIGZyb20gZGlzcG9zZWQgbW9kdWxlIFwiICtcblx0XHRcdFx0XHRtb2R1bGVJZFxuXHRcdFx0KTtcblx0XHRcdGN1cnJlbnRQYXJlbnRzID0gW107XG5cdFx0fVxuXHRcdHJldHVybiByZXF1aXJlKHJlcXVlc3QpO1xuXHR9O1xuXHR2YXIgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yID0gZnVuY3Rpb24gKG5hbWUpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlLFxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdGdldDogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXR1cm4gcmVxdWlyZVtuYW1lXTtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdFx0XHRyZXF1aXJlW25hbWVdID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fTtcblx0fTtcblx0Zm9yICh2YXIgbmFtZSBpbiByZXF1aXJlKSB7XG5cdFx0aWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyZXF1aXJlLCBuYW1lKSAmJiBuYW1lICE9PSBcImVcIikge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGZuLCBuYW1lLCBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IobmFtZSkpO1xuXHRcdH1cblx0fVxuXHRmbi5lID0gZnVuY3Rpb24gKGNodW5rSWQpIHtcblx0XHRyZXR1cm4gdHJhY2tCbG9ja2luZ1Byb21pc2UocmVxdWlyZS5lKGNodW5rSWQpKTtcblx0fTtcblx0cmV0dXJuIGZuO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVNb2R1bGVIb3RPYmplY3QobW9kdWxlSWQsIG1lKSB7XG5cdHZhciBob3QgPSB7XG5cdFx0Ly8gcHJpdmF0ZSBzdHVmZlxuXHRcdF9hY2NlcHRlZERlcGVuZGVuY2llczoge30sXG5cdFx0X2RlY2xpbmVkRGVwZW5kZW5jaWVzOiB7fSxcblx0XHRfc2VsZkFjY2VwdGVkOiBmYWxzZSxcblx0XHRfc2VsZkRlY2xpbmVkOiBmYWxzZSxcblx0XHRfc2VsZkludmFsaWRhdGVkOiBmYWxzZSxcblx0XHRfZGlzcG9zZUhhbmRsZXJzOiBbXSxcblx0XHRfbWFpbjogY3VycmVudENoaWxkTW9kdWxlICE9PSBtb2R1bGVJZCxcblx0XHRfcmVxdWlyZVNlbGY6IGZ1bmN0aW9uICgpIHtcblx0XHRcdGN1cnJlbnRQYXJlbnRzID0gbWUucGFyZW50cy5zbGljZSgpO1xuXHRcdFx0Y3VycmVudENoaWxkTW9kdWxlID0gbW9kdWxlSWQ7XG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKTtcblx0XHR9LFxuXG5cdFx0Ly8gTW9kdWxlIEFQSVxuXHRcdGFjdGl2ZTogdHJ1ZSxcblx0XHRhY2NlcHQ6IGZ1bmN0aW9uIChkZXAsIGNhbGxiYWNrKSB7XG5cdFx0XHRpZiAoZGVwID09PSB1bmRlZmluZWQpIGhvdC5fc2VsZkFjY2VwdGVkID0gdHJ1ZTtcblx0XHRcdGVsc2UgaWYgKHR5cGVvZiBkZXAgPT09IFwiZnVuY3Rpb25cIikgaG90Ll9zZWxmQWNjZXB0ZWQgPSBkZXA7XG5cdFx0XHRlbHNlIGlmICh0eXBlb2YgZGVwID09PSBcIm9iamVjdFwiICYmIGRlcCAhPT0gbnVsbClcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZXAubGVuZ3RoOyBpKyspXG5cdFx0XHRcdFx0aG90Ll9hY2NlcHRlZERlcGVuZGVuY2llc1tkZXBbaV1dID0gY2FsbGJhY2sgfHwgZnVuY3Rpb24gKCkge307XG5cdFx0XHRlbHNlIGhvdC5fYWNjZXB0ZWREZXBlbmRlbmNpZXNbZGVwXSA9IGNhbGxiYWNrIHx8IGZ1bmN0aW9uICgpIHt9O1xuXHRcdH0sXG5cdFx0ZGVjbGluZTogZnVuY3Rpb24gKGRlcCkge1xuXHRcdFx0aWYgKGRlcCA9PT0gdW5kZWZpbmVkKSBob3QuX3NlbGZEZWNsaW5lZCA9IHRydWU7XG5cdFx0XHRlbHNlIGlmICh0eXBlb2YgZGVwID09PSBcIm9iamVjdFwiICYmIGRlcCAhPT0gbnVsbClcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZXAubGVuZ3RoOyBpKyspXG5cdFx0XHRcdFx0aG90Ll9kZWNsaW5lZERlcGVuZGVuY2llc1tkZXBbaV1dID0gdHJ1ZTtcblx0XHRcdGVsc2UgaG90Ll9kZWNsaW5lZERlcGVuZGVuY2llc1tkZXBdID0gdHJ1ZTtcblx0XHR9LFxuXHRcdGRpc3Bvc2U6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuXHRcdFx0aG90Ll9kaXNwb3NlSGFuZGxlcnMucHVzaChjYWxsYmFjayk7XG5cdFx0fSxcblx0XHRhZGREaXNwb3NlSGFuZGxlcjogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cdFx0XHRob3QuX2Rpc3Bvc2VIYW5kbGVycy5wdXNoKGNhbGxiYWNrKTtcblx0XHR9LFxuXHRcdHJlbW92ZURpc3Bvc2VIYW5kbGVyOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcblx0XHRcdHZhciBpZHggPSBob3QuX2Rpc3Bvc2VIYW5kbGVycy5pbmRleE9mKGNhbGxiYWNrKTtcblx0XHRcdGlmIChpZHggPj0gMCkgaG90Ll9kaXNwb3NlSGFuZGxlcnMuc3BsaWNlKGlkeCwgMSk7XG5cdFx0fSxcblx0XHRpbnZhbGlkYXRlOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR0aGlzLl9zZWxmSW52YWxpZGF0ZWQgPSB0cnVlO1xuXHRcdFx0c3dpdGNoIChjdXJyZW50U3RhdHVzKSB7XG5cdFx0XHRcdGNhc2UgXCJpZGxlXCI6XG5cdFx0XHRcdFx0Y3VycmVudFVwZGF0ZUFwcGx5SGFuZGxlcnMgPSBbXTtcblx0XHRcdFx0XHRPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmhtckkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuXHRcdFx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5obXJJW2tleV0oXG5cdFx0XHRcdFx0XHRcdG1vZHVsZUlkLFxuXHRcdFx0XHRcdFx0XHRjdXJyZW50VXBkYXRlQXBwbHlIYW5kbGVyc1xuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRzZXRTdGF0dXMoXCJyZWFkeVwiKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcInJlYWR5XCI6XG5cdFx0XHRcdFx0T2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5obXJJKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcblx0XHRcdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18uaG1ySVtrZXldKFxuXHRcdFx0XHRcdFx0XHRtb2R1bGVJZCxcblx0XHRcdFx0XHRcdFx0Y3VycmVudFVwZGF0ZUFwcGx5SGFuZGxlcnNcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJwcmVwYXJlXCI6XG5cdFx0XHRcdGNhc2UgXCJjaGVja1wiOlxuXHRcdFx0XHRjYXNlIFwiZGlzcG9zZVwiOlxuXHRcdFx0XHRjYXNlIFwiYXBwbHlcIjpcblx0XHRcdFx0XHQocXVldWVkSW52YWxpZGF0ZWRNb2R1bGVzID0gcXVldWVkSW52YWxpZGF0ZWRNb2R1bGVzIHx8IFtdKS5wdXNoKFxuXHRcdFx0XHRcdFx0bW9kdWxlSWRcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdC8vIGlnbm9yZSByZXF1ZXN0cyBpbiBlcnJvciBzdGF0ZXNcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0Ly8gTWFuYWdlbWVudCBBUElcblx0XHRjaGVjazogaG90Q2hlY2ssXG5cdFx0YXBwbHk6IGhvdEFwcGx5LFxuXHRcdHN0YXR1czogZnVuY3Rpb24gKGwpIHtcblx0XHRcdGlmICghbCkgcmV0dXJuIGN1cnJlbnRTdGF0dXM7XG5cdFx0XHRyZWdpc3RlcmVkU3RhdHVzSGFuZGxlcnMucHVzaChsKTtcblx0XHR9LFxuXHRcdGFkZFN0YXR1c0hhbmRsZXI6IGZ1bmN0aW9uIChsKSB7XG5cdFx0XHRyZWdpc3RlcmVkU3RhdHVzSGFuZGxlcnMucHVzaChsKTtcblx0XHR9LFxuXHRcdHJlbW92ZVN0YXR1c0hhbmRsZXI6IGZ1bmN0aW9uIChsKSB7XG5cdFx0XHR2YXIgaWR4ID0gcmVnaXN0ZXJlZFN0YXR1c0hhbmRsZXJzLmluZGV4T2YobCk7XG5cdFx0XHRpZiAoaWR4ID49IDApIHJlZ2lzdGVyZWRTdGF0dXNIYW5kbGVycy5zcGxpY2UoaWR4LCAxKTtcblx0XHR9LFxuXG5cdFx0Ly9pbmhlcml0IGZyb20gcHJldmlvdXMgZGlzcG9zZSBjYWxsXG5cdFx0ZGF0YTogY3VycmVudE1vZHVsZURhdGFbbW9kdWxlSWRdXG5cdH07XG5cdGN1cnJlbnRDaGlsZE1vZHVsZSA9IHVuZGVmaW5lZDtcblx0cmV0dXJuIGhvdDtcbn1cblxuZnVuY3Rpb24gc2V0U3RhdHVzKG5ld1N0YXR1cykge1xuXHRjdXJyZW50U3RhdHVzID0gbmV3U3RhdHVzO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IHJlZ2lzdGVyZWRTdGF0dXNIYW5kbGVycy5sZW5ndGg7IGkrKylcblx0XHRyZWdpc3RlcmVkU3RhdHVzSGFuZGxlcnNbaV0uY2FsbChudWxsLCBuZXdTdGF0dXMpO1xufVxuXG5mdW5jdGlvbiB0cmFja0Jsb2NraW5nUHJvbWlzZShwcm9taXNlKSB7XG5cdHN3aXRjaCAoY3VycmVudFN0YXR1cykge1xuXHRcdGNhc2UgXCJyZWFkeVwiOlxuXHRcdFx0c2V0U3RhdHVzKFwicHJlcGFyZVwiKTtcblx0XHRcdGJsb2NraW5nUHJvbWlzZXMucHVzaChwcm9taXNlKTtcblx0XHRcdHdhaXRGb3JCbG9ja2luZ1Byb21pc2VzKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0c2V0U3RhdHVzKFwicmVhZHlcIik7XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiBwcm9taXNlO1xuXHRcdGNhc2UgXCJwcmVwYXJlXCI6XG5cdFx0XHRibG9ja2luZ1Byb21pc2VzLnB1c2gocHJvbWlzZSk7XG5cdFx0XHRyZXR1cm4gcHJvbWlzZTtcblx0XHRkZWZhdWx0OlxuXHRcdFx0cmV0dXJuIHByb21pc2U7XG5cdH1cbn1cblxuZnVuY3Rpb24gd2FpdEZvckJsb2NraW5nUHJvbWlzZXMoZm4pIHtcblx0aWYgKGJsb2NraW5nUHJvbWlzZXMubGVuZ3RoID09PSAwKSByZXR1cm4gZm4oKTtcblx0dmFyIGJsb2NrZXIgPSBibG9ja2luZ1Byb21pc2VzO1xuXHRibG9ja2luZ1Byb21pc2VzID0gW107XG5cdHJldHVybiBQcm9taXNlLmFsbChibG9ja2VyKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gd2FpdEZvckJsb2NraW5nUHJvbWlzZXMoZm4pO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24gaG90Q2hlY2soYXBwbHlPblVwZGF0ZSkge1xuXHRpZiAoY3VycmVudFN0YXR1cyAhPT0gXCJpZGxlXCIpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJjaGVjaygpIGlzIG9ubHkgYWxsb3dlZCBpbiBpZGxlIHN0YXR1c1wiKTtcblx0fVxuXHRzZXRTdGF0dXMoXCJjaGVja1wiKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uaG1yTSgpLnRoZW4oZnVuY3Rpb24gKHVwZGF0ZSkge1xuXHRcdGlmICghdXBkYXRlKSB7XG5cdFx0XHRzZXRTdGF0dXMoYXBwbHlJbnZhbGlkYXRlZE1vZHVsZXMoKSA/IFwicmVhZHlcIiA6IFwiaWRsZVwiKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdHNldFN0YXR1cyhcInByZXBhcmVcIik7XG5cblx0XHR2YXIgdXBkYXRlZE1vZHVsZXMgPSBbXTtcblx0XHRibG9ja2luZ1Byb21pc2VzID0gW107XG5cdFx0Y3VycmVudFVwZGF0ZUFwcGx5SGFuZGxlcnMgPSBbXTtcblxuXHRcdHJldHVybiBQcm9taXNlLmFsbChcblx0XHRcdE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uaG1yQykucmVkdWNlKGZ1bmN0aW9uIChcblx0XHRcdFx0cHJvbWlzZXMsXG5cdFx0XHRcdGtleVxuXHRcdFx0KSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18uaG1yQ1trZXldKFxuXHRcdFx0XHRcdHVwZGF0ZS5jLFxuXHRcdFx0XHRcdHVwZGF0ZS5yLFxuXHRcdFx0XHRcdHVwZGF0ZS5tLFxuXHRcdFx0XHRcdHByb21pc2VzLFxuXHRcdFx0XHRcdGN1cnJlbnRVcGRhdGVBcHBseUhhbmRsZXJzLFxuXHRcdFx0XHRcdHVwZGF0ZWRNb2R1bGVzXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHJldHVybiBwcm9taXNlcztcblx0XHRcdH0sXG5cdFx0XHRbXSlcblx0XHQpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuIHdhaXRGb3JCbG9ja2luZ1Byb21pc2VzKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0aWYgKGFwcGx5T25VcGRhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4gaW50ZXJuYWxBcHBseShhcHBseU9uVXBkYXRlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRzZXRTdGF0dXMoXCJyZWFkeVwiKTtcblxuXHRcdFx0XHRcdHJldHVybiB1cGRhdGVkTW9kdWxlcztcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBob3RBcHBseShvcHRpb25zKSB7XG5cdGlmIChjdXJyZW50U3RhdHVzICE9PSBcInJlYWR5XCIpIHtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJhcHBseSgpIGlzIG9ubHkgYWxsb3dlZCBpbiByZWFkeSBzdGF0dXNcIik7XG5cdFx0fSk7XG5cdH1cblx0cmV0dXJuIGludGVybmFsQXBwbHkob3B0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIGludGVybmFsQXBwbHkob3B0aW9ucykge1xuXHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuXHRhcHBseUludmFsaWRhdGVkTW9kdWxlcygpO1xuXG5cdHZhciByZXN1bHRzID0gY3VycmVudFVwZGF0ZUFwcGx5SGFuZGxlcnMubWFwKGZ1bmN0aW9uIChoYW5kbGVyKSB7XG5cdFx0cmV0dXJuIGhhbmRsZXIob3B0aW9ucyk7XG5cdH0pO1xuXHRjdXJyZW50VXBkYXRlQXBwbHlIYW5kbGVycyA9IHVuZGVmaW5lZDtcblxuXHR2YXIgZXJyb3JzID0gcmVzdWx0c1xuXHRcdC5tYXAoZnVuY3Rpb24gKHIpIHtcblx0XHRcdHJldHVybiByLmVycm9yO1xuXHRcdH0pXG5cdFx0LmZpbHRlcihCb29sZWFuKTtcblxuXHRpZiAoZXJyb3JzLmxlbmd0aCA+IDApIHtcblx0XHRzZXRTdGF0dXMoXCJhYm9ydFwiKTtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHR0aHJvdyBlcnJvcnNbMF07XG5cdFx0fSk7XG5cdH1cblxuXHQvLyBOb3cgaW4gXCJkaXNwb3NlXCIgcGhhc2Vcblx0c2V0U3RhdHVzKFwiZGlzcG9zZVwiKTtcblxuXHRyZXN1bHRzLmZvckVhY2goZnVuY3Rpb24gKHJlc3VsdCkge1xuXHRcdGlmIChyZXN1bHQuZGlzcG9zZSkgcmVzdWx0LmRpc3Bvc2UoKTtcblx0fSk7XG5cblx0Ly8gTm93IGluIFwiYXBwbHlcIiBwaGFzZVxuXHRzZXRTdGF0dXMoXCJhcHBseVwiKTtcblxuXHR2YXIgZXJyb3I7XG5cdHZhciByZXBvcnRFcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0XHRpZiAoIWVycm9yKSBlcnJvciA9IGVycjtcblx0fTtcblxuXHR2YXIgb3V0ZGF0ZWRNb2R1bGVzID0gW107XG5cdHJlc3VsdHMuZm9yRWFjaChmdW5jdGlvbiAocmVzdWx0KSB7XG5cdFx0aWYgKHJlc3VsdC5hcHBseSkge1xuXHRcdFx0dmFyIG1vZHVsZXMgPSByZXN1bHQuYXBwbHkocmVwb3J0RXJyb3IpO1xuXHRcdFx0aWYgKG1vZHVsZXMpIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0b3V0ZGF0ZWRNb2R1bGVzLnB1c2gobW9kdWxlc1tpXSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdC8vIGhhbmRsZSBlcnJvcnMgaW4gYWNjZXB0IGhhbmRsZXJzIGFuZCBzZWxmIGFjY2VwdGVkIG1vZHVsZSBsb2FkXG5cdGlmIChlcnJvcikge1xuXHRcdHNldFN0YXR1cyhcImZhaWxcIik7XG5cdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAocXVldWVkSW52YWxpZGF0ZWRNb2R1bGVzKSB7XG5cdFx0cmV0dXJuIGludGVybmFsQXBwbHkob3B0aW9ucykudGhlbihmdW5jdGlvbiAobGlzdCkge1xuXHRcdFx0b3V0ZGF0ZWRNb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZUlkKSB7XG5cdFx0XHRcdGlmIChsaXN0LmluZGV4T2YobW9kdWxlSWQpIDwgMCkgbGlzdC5wdXNoKG1vZHVsZUlkKTtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGxpc3Q7XG5cdFx0fSk7XG5cdH1cblxuXHRzZXRTdGF0dXMoXCJpZGxlXCIpO1xuXHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG91dGRhdGVkTW9kdWxlcyk7XG59XG5cbmZ1bmN0aW9uIGFwcGx5SW52YWxpZGF0ZWRNb2R1bGVzKCkge1xuXHRpZiAocXVldWVkSW52YWxpZGF0ZWRNb2R1bGVzKSB7XG5cdFx0aWYgKCFjdXJyZW50VXBkYXRlQXBwbHlIYW5kbGVycykgY3VycmVudFVwZGF0ZUFwcGx5SGFuZGxlcnMgPSBbXTtcblx0XHRPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmhtckkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuXHRcdFx0cXVldWVkSW52YWxpZGF0ZWRNb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZUlkKSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18uaG1ySVtrZXldKFxuXHRcdFx0XHRcdG1vZHVsZUlkLFxuXHRcdFx0XHRcdGN1cnJlbnRVcGRhdGVBcHBseUhhbmRsZXJzXG5cdFx0XHRcdCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0XHRxdWV1ZWRJbnZhbGlkYXRlZE1vZHVsZXMgPSB1bmRlZmluZWQ7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cbn0iLCJ2YXIgc2NyaXB0VXJsO1xuaWYgKF9fd2VicGFja19yZXF1aXJlX18uZy5pbXBvcnRTY3JpcHRzKSBzY3JpcHRVcmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcubG9jYXRpb24gKyBcIlwiO1xudmFyIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmRvY3VtZW50O1xuaWYgKCFzY3JpcHRVcmwgJiYgZG9jdW1lbnQpIHtcblx0aWYgKGRvY3VtZW50LmN1cnJlbnRTY3JpcHQpXG5cdFx0c2NyaXB0VXJsID0gZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmNcblx0aWYgKCFzY3JpcHRVcmwpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGlmKHNjcmlwdHMubGVuZ3RoKSBzY3JpcHRVcmwgPSBzY3JpcHRzW3NjcmlwdHMubGVuZ3RoIC0gMV0uc3JjXG5cdH1cbn1cbi8vIFdoZW4gc3VwcG9ydGluZyBicm93c2VycyB3aGVyZSBhbiBhdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIHlvdSBtdXN0IHNwZWNpZnkgYW4gb3V0cHV0LnB1YmxpY1BhdGggbWFudWFsbHkgdmlhIGNvbmZpZ3VyYXRpb25cbi8vIG9yIHBhc3MgYW4gZW1wdHkgc3RyaW5nIChcIlwiKSBhbmQgc2V0IHRoZSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyB2YXJpYWJsZSBmcm9tIHlvdXIgY29kZSB0byB1c2UgeW91ciBvd24gbG9naWMuXG5pZiAoIXNjcmlwdFVybCkgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXJcIik7XG5zY3JpcHRVcmwgPSBzY3JpcHRVcmwucmVwbGFjZSgvIy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcPy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgXCIvXCIpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2NyaXB0VXJsOyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gUHJvbWlzZSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdFwibWFpblwiOiAwXG59O1xuXG5cbi8vIG5vIGNodW5rIG9uIGRlbWFuZCBsb2FkaW5nXG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG52YXIgY3VycmVudFVwZGF0ZWRNb2R1bGVzTGlzdDtcbnZhciB3YWl0aW5nVXBkYXRlUmVzb2x2ZXMgPSB7fTtcbmZ1bmN0aW9uIGxvYWRVcGRhdGVDaHVuayhjaHVua0lkKSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0d2FpdGluZ1VwZGF0ZVJlc29sdmVzW2NodW5rSWRdID0gcmVzb2x2ZTtcblx0XHQvLyBzdGFydCB1cGRhdGUgY2h1bmsgbG9hZGluZ1xuXHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLmh1KGNodW5rSWQpO1xuXHRcdC8vIGNyZWF0ZSBlcnJvciBiZWZvcmUgc3RhY2sgdW53b3VuZCB0byBnZXQgdXNlZnVsIHN0YWNrdHJhY2UgbGF0ZXJcblx0XHR2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTtcblx0XHR2YXIgbG9hZGluZ0VuZGVkID0gKGV2ZW50KSA9PiB7XG5cdFx0XHRpZih3YWl0aW5nVXBkYXRlUmVzb2x2ZXNbY2h1bmtJZF0pIHtcblx0XHRcdFx0d2FpdGluZ1VwZGF0ZVJlc29sdmVzW2NodW5rSWRdID0gdW5kZWZpbmVkXG5cdFx0XHRcdHZhciBlcnJvclR5cGUgPSBldmVudCAmJiAoZXZlbnQudHlwZSA9PT0gJ2xvYWQnID8gJ21pc3NpbmcnIDogZXZlbnQudHlwZSk7XG5cdFx0XHRcdHZhciByZWFsU3JjID0gZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5zcmM7XG5cdFx0XHRcdGVycm9yLm1lc3NhZ2UgPSAnTG9hZGluZyBob3QgdXBkYXRlIGNodW5rICcgKyBjaHVua0lkICsgJyBmYWlsZWQuXFxuKCcgKyBlcnJvclR5cGUgKyAnOiAnICsgcmVhbFNyYyArICcpJztcblx0XHRcdFx0ZXJyb3IubmFtZSA9ICdDaHVua0xvYWRFcnJvcic7XG5cdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdGVycm9yLnJlcXVlc3QgPSByZWFsU3JjO1xuXHRcdFx0XHRyZWplY3QoZXJyb3IpO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkKTtcblx0fSk7XG59XG5cbnNlbGZbXCJ3ZWJwYWNrSG90VXBkYXRlVGV0cmlzXCJdID0gKGNodW5rSWQsIG1vcmVNb2R1bGVzLCBydW50aW1lKSA9PiB7XG5cdGZvcih2YXIgbW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0Y3VycmVudFVwZGF0ZVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0XHRpZihjdXJyZW50VXBkYXRlZE1vZHVsZXNMaXN0KSBjdXJyZW50VXBkYXRlZE1vZHVsZXNMaXN0LnB1c2gobW9kdWxlSWQpO1xuXHRcdH1cblx0fVxuXHRpZihydW50aW1lKSBjdXJyZW50VXBkYXRlUnVudGltZS5wdXNoKHJ1bnRpbWUpO1xuXHRpZih3YWl0aW5nVXBkYXRlUmVzb2x2ZXNbY2h1bmtJZF0pIHtcblx0XHR3YWl0aW5nVXBkYXRlUmVzb2x2ZXNbY2h1bmtJZF0oKTtcblx0XHR3YWl0aW5nVXBkYXRlUmVzb2x2ZXNbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG5cdH1cbn07XG5cbnZhciBjdXJyZW50VXBkYXRlQ2h1bmtzO1xudmFyIGN1cnJlbnRVcGRhdGU7XG52YXIgY3VycmVudFVwZGF0ZVJlbW92ZWRDaHVua3M7XG52YXIgY3VycmVudFVwZGF0ZVJ1bnRpbWU7XG5mdW5jdGlvbiBhcHBseUhhbmRsZXIob3B0aW9ucykge1xuXHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5mKSBkZWxldGUgX193ZWJwYWNrX3JlcXVpcmVfXy5mLmpzb25wSG1yO1xuXHRjdXJyZW50VXBkYXRlQ2h1bmtzID0gdW5kZWZpbmVkO1xuXHRmdW5jdGlvbiBnZXRBZmZlY3RlZE1vZHVsZUVmZmVjdHModXBkYXRlTW9kdWxlSWQpIHtcblx0XHR2YXIgb3V0ZGF0ZWRNb2R1bGVzID0gW3VwZGF0ZU1vZHVsZUlkXTtcblx0XHR2YXIgb3V0ZGF0ZWREZXBlbmRlbmNpZXMgPSB7fTtcblxuXHRcdHZhciBxdWV1ZSA9IG91dGRhdGVkTW9kdWxlcy5tYXAoZnVuY3Rpb24gKGlkKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRjaGFpbjogW2lkXSxcblx0XHRcdFx0aWQ6IGlkXG5cdFx0XHR9O1xuXHRcdH0pO1xuXHRcdHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7XG5cdFx0XHR2YXIgcXVldWVJdGVtID0gcXVldWUucG9wKCk7XG5cdFx0XHR2YXIgbW9kdWxlSWQgPSBxdWV1ZUl0ZW0uaWQ7XG5cdFx0XHR2YXIgY2hhaW4gPSBxdWV1ZUl0ZW0uY2hhaW47XG5cdFx0XHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jW21vZHVsZUlkXTtcblx0XHRcdGlmIChcblx0XHRcdFx0IW1vZHVsZSB8fFxuXHRcdFx0XHQobW9kdWxlLmhvdC5fc2VsZkFjY2VwdGVkICYmICFtb2R1bGUuaG90Ll9zZWxmSW52YWxpZGF0ZWQpXG5cdFx0XHQpXG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0aWYgKG1vZHVsZS5ob3QuX3NlbGZEZWNsaW5lZCkge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHR5cGU6IFwic2VsZi1kZWNsaW5lZFwiLFxuXHRcdFx0XHRcdGNoYWluOiBjaGFpbixcblx0XHRcdFx0XHRtb2R1bGVJZDogbW9kdWxlSWRcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHRcdGlmIChtb2R1bGUuaG90Ll9tYWluKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0dHlwZTogXCJ1bmFjY2VwdGVkXCIsXG5cdFx0XHRcdFx0Y2hhaW46IGNoYWluLFxuXHRcdFx0XHRcdG1vZHVsZUlkOiBtb2R1bGVJZFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBtb2R1bGUucGFyZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgcGFyZW50SWQgPSBtb2R1bGUucGFyZW50c1tpXTtcblx0XHRcdFx0dmFyIHBhcmVudCA9IF9fd2VicGFja19yZXF1aXJlX18uY1twYXJlbnRJZF07XG5cdFx0XHRcdGlmICghcGFyZW50KSBjb250aW51ZTtcblx0XHRcdFx0aWYgKHBhcmVudC5ob3QuX2RlY2xpbmVkRGVwZW5kZW5jaWVzW21vZHVsZUlkXSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHR0eXBlOiBcImRlY2xpbmVkXCIsXG5cdFx0XHRcdFx0XHRjaGFpbjogY2hhaW4uY29uY2F0KFtwYXJlbnRJZF0pLFxuXHRcdFx0XHRcdFx0bW9kdWxlSWQ6IG1vZHVsZUlkLFxuXHRcdFx0XHRcdFx0cGFyZW50SWQ6IHBhcmVudElkXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAob3V0ZGF0ZWRNb2R1bGVzLmluZGV4T2YocGFyZW50SWQpICE9PSAtMSkgY29udGludWU7XG5cdFx0XHRcdGlmIChwYXJlbnQuaG90Ll9hY2NlcHRlZERlcGVuZGVuY2llc1ttb2R1bGVJZF0pIHtcblx0XHRcdFx0XHRpZiAoIW91dGRhdGVkRGVwZW5kZW5jaWVzW3BhcmVudElkXSlcblx0XHRcdFx0XHRcdG91dGRhdGVkRGVwZW5kZW5jaWVzW3BhcmVudElkXSA9IFtdO1xuXHRcdFx0XHRcdGFkZEFsbFRvU2V0KG91dGRhdGVkRGVwZW5kZW5jaWVzW3BhcmVudElkXSwgW21vZHVsZUlkXSk7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZGVsZXRlIG91dGRhdGVkRGVwZW5kZW5jaWVzW3BhcmVudElkXTtcblx0XHRcdFx0b3V0ZGF0ZWRNb2R1bGVzLnB1c2gocGFyZW50SWQpO1xuXHRcdFx0XHRxdWV1ZS5wdXNoKHtcblx0XHRcdFx0XHRjaGFpbjogY2hhaW4uY29uY2F0KFtwYXJlbnRJZF0pLFxuXHRcdFx0XHRcdGlkOiBwYXJlbnRJZFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZTogXCJhY2NlcHRlZFwiLFxuXHRcdFx0bW9kdWxlSWQ6IHVwZGF0ZU1vZHVsZUlkLFxuXHRcdFx0b3V0ZGF0ZWRNb2R1bGVzOiBvdXRkYXRlZE1vZHVsZXMsXG5cdFx0XHRvdXRkYXRlZERlcGVuZGVuY2llczogb3V0ZGF0ZWREZXBlbmRlbmNpZXNcblx0XHR9O1xuXHR9XG5cblx0ZnVuY3Rpb24gYWRkQWxsVG9TZXQoYSwgYikge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYi5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGl0ZW0gPSBiW2ldO1xuXHRcdFx0aWYgKGEuaW5kZXhPZihpdGVtKSA9PT0gLTEpIGEucHVzaChpdGVtKTtcblx0XHR9XG5cdH1cblxuXHQvLyBhdCBiZWdpbiBhbGwgdXBkYXRlcyBtb2R1bGVzIGFyZSBvdXRkYXRlZFxuXHQvLyB0aGUgXCJvdXRkYXRlZFwiIHN0YXR1cyBjYW4gcHJvcGFnYXRlIHRvIHBhcmVudHMgaWYgdGhleSBkb24ndCBhY2NlcHQgdGhlIGNoaWxkcmVuXG5cdHZhciBvdXRkYXRlZERlcGVuZGVuY2llcyA9IHt9O1xuXHR2YXIgb3V0ZGF0ZWRNb2R1bGVzID0gW107XG5cdHZhciBhcHBsaWVkVXBkYXRlID0ge307XG5cblx0dmFyIHdhcm5VbmV4cGVjdGVkUmVxdWlyZSA9IGZ1bmN0aW9uIHdhcm5VbmV4cGVjdGVkUmVxdWlyZShtb2R1bGUpIHtcblx0XHRjb25zb2xlLndhcm4oXG5cdFx0XHRcIltITVJdIHVuZXhwZWN0ZWQgcmVxdWlyZShcIiArIG1vZHVsZS5pZCArIFwiKSB0byBkaXNwb3NlZCBtb2R1bGVcIlxuXHRcdCk7XG5cdH07XG5cblx0Zm9yICh2YXIgbW9kdWxlSWQgaW4gY3VycmVudFVwZGF0ZSkge1xuXHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm8oY3VycmVudFVwZGF0ZSwgbW9kdWxlSWQpKSB7XG5cdFx0XHR2YXIgbmV3TW9kdWxlRmFjdG9yeSA9IGN1cnJlbnRVcGRhdGVbbW9kdWxlSWRdO1xuXHRcdFx0LyoqIEB0eXBlIHtUT0RPfSAqL1xuXHRcdFx0dmFyIHJlc3VsdDtcblx0XHRcdGlmIChuZXdNb2R1bGVGYWN0b3J5KSB7XG5cdFx0XHRcdHJlc3VsdCA9IGdldEFmZmVjdGVkTW9kdWxlRWZmZWN0cyhtb2R1bGVJZCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXN1bHQgPSB7XG5cdFx0XHRcdFx0dHlwZTogXCJkaXNwb3NlZFwiLFxuXHRcdFx0XHRcdG1vZHVsZUlkOiBtb2R1bGVJZFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdFx0LyoqIEB0eXBlIHtFcnJvcnxmYWxzZX0gKi9cblx0XHRcdHZhciBhYm9ydEVycm9yID0gZmFsc2U7XG5cdFx0XHR2YXIgZG9BcHBseSA9IGZhbHNlO1xuXHRcdFx0dmFyIGRvRGlzcG9zZSA9IGZhbHNlO1xuXHRcdFx0dmFyIGNoYWluSW5mbyA9IFwiXCI7XG5cdFx0XHRpZiAocmVzdWx0LmNoYWluKSB7XG5cdFx0XHRcdGNoYWluSW5mbyA9IFwiXFxuVXBkYXRlIHByb3BhZ2F0aW9uOiBcIiArIHJlc3VsdC5jaGFpbi5qb2luKFwiIC0+IFwiKTtcblx0XHRcdH1cblx0XHRcdHN3aXRjaCAocmVzdWx0LnR5cGUpIHtcblx0XHRcdFx0Y2FzZSBcInNlbGYtZGVjbGluZWRcIjpcblx0XHRcdFx0XHRpZiAob3B0aW9ucy5vbkRlY2xpbmVkKSBvcHRpb25zLm9uRGVjbGluZWQocmVzdWx0KTtcblx0XHRcdFx0XHRpZiAoIW9wdGlvbnMuaWdub3JlRGVjbGluZWQpXG5cdFx0XHRcdFx0XHRhYm9ydEVycm9yID0gbmV3IEVycm9yKFxuXHRcdFx0XHRcdFx0XHRcIkFib3J0ZWQgYmVjYXVzZSBvZiBzZWxmIGRlY2xpbmU6IFwiICtcblx0XHRcdFx0XHRcdFx0XHRyZXN1bHQubW9kdWxlSWQgK1xuXHRcdFx0XHRcdFx0XHRcdGNoYWluSW5mb1xuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcImRlY2xpbmVkXCI6XG5cdFx0XHRcdFx0aWYgKG9wdGlvbnMub25EZWNsaW5lZCkgb3B0aW9ucy5vbkRlY2xpbmVkKHJlc3VsdCk7XG5cdFx0XHRcdFx0aWYgKCFvcHRpb25zLmlnbm9yZURlY2xpbmVkKVxuXHRcdFx0XHRcdFx0YWJvcnRFcnJvciA9IG5ldyBFcnJvcihcblx0XHRcdFx0XHRcdFx0XCJBYm9ydGVkIGJlY2F1c2Ugb2YgZGVjbGluZWQgZGVwZW5kZW5jeTogXCIgK1xuXHRcdFx0XHRcdFx0XHRcdHJlc3VsdC5tb2R1bGVJZCArXG5cdFx0XHRcdFx0XHRcdFx0XCIgaW4gXCIgK1xuXHRcdFx0XHRcdFx0XHRcdHJlc3VsdC5wYXJlbnRJZCArXG5cdFx0XHRcdFx0XHRcdFx0Y2hhaW5JbmZvXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwidW5hY2NlcHRlZFwiOlxuXHRcdFx0XHRcdGlmIChvcHRpb25zLm9uVW5hY2NlcHRlZCkgb3B0aW9ucy5vblVuYWNjZXB0ZWQocmVzdWx0KTtcblx0XHRcdFx0XHRpZiAoIW9wdGlvbnMuaWdub3JlVW5hY2NlcHRlZClcblx0XHRcdFx0XHRcdGFib3J0RXJyb3IgPSBuZXcgRXJyb3IoXG5cdFx0XHRcdFx0XHRcdFwiQWJvcnRlZCBiZWNhdXNlIFwiICsgbW9kdWxlSWQgKyBcIiBpcyBub3QgYWNjZXB0ZWRcIiArIGNoYWluSW5mb1xuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcImFjY2VwdGVkXCI6XG5cdFx0XHRcdFx0aWYgKG9wdGlvbnMub25BY2NlcHRlZCkgb3B0aW9ucy5vbkFjY2VwdGVkKHJlc3VsdCk7XG5cdFx0XHRcdFx0ZG9BcHBseSA9IHRydWU7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJkaXNwb3NlZFwiOlxuXHRcdFx0XHRcdGlmIChvcHRpb25zLm9uRGlzcG9zZWQpIG9wdGlvbnMub25EaXNwb3NlZChyZXN1bHQpO1xuXHRcdFx0XHRcdGRvRGlzcG9zZSA9IHRydWU7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiVW5leGNlcHRpb24gdHlwZSBcIiArIHJlc3VsdC50eXBlKTtcblx0XHRcdH1cblx0XHRcdGlmIChhYm9ydEVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0ZXJyb3I6IGFib3J0RXJyb3Jcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHRcdGlmIChkb0FwcGx5KSB7XG5cdFx0XHRcdGFwcGxpZWRVcGRhdGVbbW9kdWxlSWRdID0gbmV3TW9kdWxlRmFjdG9yeTtcblx0XHRcdFx0YWRkQWxsVG9TZXQob3V0ZGF0ZWRNb2R1bGVzLCByZXN1bHQub3V0ZGF0ZWRNb2R1bGVzKTtcblx0XHRcdFx0Zm9yIChtb2R1bGVJZCBpbiByZXN1bHQub3V0ZGF0ZWREZXBlbmRlbmNpZXMpIHtcblx0XHRcdFx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5vKHJlc3VsdC5vdXRkYXRlZERlcGVuZGVuY2llcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRcdFx0XHRpZiAoIW91dGRhdGVkRGVwZW5kZW5jaWVzW21vZHVsZUlkXSlcblx0XHRcdFx0XHRcdFx0b3V0ZGF0ZWREZXBlbmRlbmNpZXNbbW9kdWxlSWRdID0gW107XG5cdFx0XHRcdFx0XHRhZGRBbGxUb1NldChcblx0XHRcdFx0XHRcdFx0b3V0ZGF0ZWREZXBlbmRlbmNpZXNbbW9kdWxlSWRdLFxuXHRcdFx0XHRcdFx0XHRyZXN1bHQub3V0ZGF0ZWREZXBlbmRlbmNpZXNbbW9kdWxlSWRdXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKGRvRGlzcG9zZSkge1xuXHRcdFx0XHRhZGRBbGxUb1NldChvdXRkYXRlZE1vZHVsZXMsIFtyZXN1bHQubW9kdWxlSWRdKTtcblx0XHRcdFx0YXBwbGllZFVwZGF0ZVttb2R1bGVJZF0gPSB3YXJuVW5leHBlY3RlZFJlcXVpcmU7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGN1cnJlbnRVcGRhdGUgPSB1bmRlZmluZWQ7XG5cblx0Ly8gU3RvcmUgc2VsZiBhY2NlcHRlZCBvdXRkYXRlZCBtb2R1bGVzIHRvIHJlcXVpcmUgdGhlbSBsYXRlciBieSB0aGUgbW9kdWxlIHN5c3RlbVxuXHR2YXIgb3V0ZGF0ZWRTZWxmQWNjZXB0ZWRNb2R1bGVzID0gW107XG5cdGZvciAodmFyIGogPSAwOyBqIDwgb3V0ZGF0ZWRNb2R1bGVzLmxlbmd0aDsgaisrKSB7XG5cdFx0dmFyIG91dGRhdGVkTW9kdWxlSWQgPSBvdXRkYXRlZE1vZHVsZXNbal07XG5cdFx0aWYgKFxuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jW291dGRhdGVkTW9kdWxlSWRdICYmXG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmNbb3V0ZGF0ZWRNb2R1bGVJZF0uaG90Ll9zZWxmQWNjZXB0ZWQgJiZcblx0XHRcdC8vIHJlbW92ZWQgc2VsZi1hY2NlcHRlZCBtb2R1bGVzIHNob3VsZCBub3QgYmUgcmVxdWlyZWRcblx0XHRcdGFwcGxpZWRVcGRhdGVbb3V0ZGF0ZWRNb2R1bGVJZF0gIT09IHdhcm5VbmV4cGVjdGVkUmVxdWlyZSAmJlxuXHRcdFx0Ly8gd2hlbiBjYWxsZWQgaW52YWxpZGF0ZSBzZWxmLWFjY2VwdGluZyBpcyBub3QgcG9zc2libGVcblx0XHRcdCFfX3dlYnBhY2tfcmVxdWlyZV9fLmNbb3V0ZGF0ZWRNb2R1bGVJZF0uaG90Ll9zZWxmSW52YWxpZGF0ZWRcblx0XHQpIHtcblx0XHRcdG91dGRhdGVkU2VsZkFjY2VwdGVkTW9kdWxlcy5wdXNoKHtcblx0XHRcdFx0bW9kdWxlOiBvdXRkYXRlZE1vZHVsZUlkLFxuXHRcdFx0XHRyZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmNbb3V0ZGF0ZWRNb2R1bGVJZF0uaG90Ll9yZXF1aXJlU2VsZixcblx0XHRcdFx0ZXJyb3JIYW5kbGVyOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmNbb3V0ZGF0ZWRNb2R1bGVJZF0uaG90Ll9zZWxmQWNjZXB0ZWRcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdHZhciBtb2R1bGVPdXRkYXRlZERlcGVuZGVuY2llcztcblxuXHRyZXR1cm4ge1xuXHRcdGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcblx0XHRcdGN1cnJlbnRVcGRhdGVSZW1vdmVkQ2h1bmtzLmZvckVhY2goZnVuY3Rpb24gKGNodW5rSWQpIHtcblx0XHRcdFx0ZGVsZXRlIGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcblx0XHRcdH0pO1xuXHRcdFx0Y3VycmVudFVwZGF0ZVJlbW92ZWRDaHVua3MgPSB1bmRlZmluZWQ7XG5cblx0XHRcdHZhciBpZHg7XG5cdFx0XHR2YXIgcXVldWUgPSBvdXRkYXRlZE1vZHVsZXMuc2xpY2UoKTtcblx0XHRcdHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHZhciBtb2R1bGVJZCA9IHF1ZXVlLnBvcCgpO1xuXHRcdFx0XHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jW21vZHVsZUlkXTtcblx0XHRcdFx0aWYgKCFtb2R1bGUpIGNvbnRpbnVlO1xuXG5cdFx0XHRcdHZhciBkYXRhID0ge307XG5cblx0XHRcdFx0Ly8gQ2FsbCBkaXNwb3NlIGhhbmRsZXJzXG5cdFx0XHRcdHZhciBkaXNwb3NlSGFuZGxlcnMgPSBtb2R1bGUuaG90Ll9kaXNwb3NlSGFuZGxlcnM7XG5cdFx0XHRcdGZvciAoaiA9IDA7IGogPCBkaXNwb3NlSGFuZGxlcnMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRkaXNwb3NlSGFuZGxlcnNbal0uY2FsbChudWxsLCBkYXRhKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmhtckRbbW9kdWxlSWRdID0gZGF0YTtcblxuXHRcdFx0XHQvLyBkaXNhYmxlIG1vZHVsZSAodGhpcyBkaXNhYmxlcyByZXF1aXJlcyBmcm9tIHRoaXMgbW9kdWxlKVxuXHRcdFx0XHRtb2R1bGUuaG90LmFjdGl2ZSA9IGZhbHNlO1xuXG5cdFx0XHRcdC8vIHJlbW92ZSBtb2R1bGUgZnJvbSBjYWNoZVxuXHRcdFx0XHRkZWxldGUgX193ZWJwYWNrX3JlcXVpcmVfXy5jW21vZHVsZUlkXTtcblxuXHRcdFx0XHQvLyB3aGVuIGRpc3Bvc2luZyB0aGVyZSBpcyBubyBuZWVkIHRvIGNhbGwgZGlzcG9zZSBoYW5kbGVyXG5cdFx0XHRcdGRlbGV0ZSBvdXRkYXRlZERlcGVuZGVuY2llc1ttb2R1bGVJZF07XG5cblx0XHRcdFx0Ly8gcmVtb3ZlIFwicGFyZW50c1wiIHJlZmVyZW5jZXMgZnJvbSBhbGwgY2hpbGRyZW5cblx0XHRcdFx0Zm9yIChqID0gMDsgaiA8IG1vZHVsZS5jaGlsZHJlbi5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdHZhciBjaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18uY1ttb2R1bGUuY2hpbGRyZW5bal1dO1xuXHRcdFx0XHRcdGlmICghY2hpbGQpIGNvbnRpbnVlO1xuXHRcdFx0XHRcdGlkeCA9IGNoaWxkLnBhcmVudHMuaW5kZXhPZihtb2R1bGVJZCk7XG5cdFx0XHRcdFx0aWYgKGlkeCA+PSAwKSB7XG5cdFx0XHRcdFx0XHRjaGlsZC5wYXJlbnRzLnNwbGljZShpZHgsIDEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyByZW1vdmUgb3V0ZGF0ZWQgZGVwZW5kZW5jeSBmcm9tIG1vZHVsZSBjaGlsZHJlblxuXHRcdFx0dmFyIGRlcGVuZGVuY3k7XG5cdFx0XHRmb3IgKHZhciBvdXRkYXRlZE1vZHVsZUlkIGluIG91dGRhdGVkRGVwZW5kZW5jaWVzKSB7XG5cdFx0XHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm8ob3V0ZGF0ZWREZXBlbmRlbmNpZXMsIG91dGRhdGVkTW9kdWxlSWQpKSB7XG5cdFx0XHRcdFx0bW9kdWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jW291dGRhdGVkTW9kdWxlSWRdO1xuXHRcdFx0XHRcdGlmIChtb2R1bGUpIHtcblx0XHRcdFx0XHRcdG1vZHVsZU91dGRhdGVkRGVwZW5kZW5jaWVzID1cblx0XHRcdFx0XHRcdFx0b3V0ZGF0ZWREZXBlbmRlbmNpZXNbb3V0ZGF0ZWRNb2R1bGVJZF07XG5cdFx0XHRcdFx0XHRmb3IgKGogPSAwOyBqIDwgbW9kdWxlT3V0ZGF0ZWREZXBlbmRlbmNpZXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdFx0ZGVwZW5kZW5jeSA9IG1vZHVsZU91dGRhdGVkRGVwZW5kZW5jaWVzW2pdO1xuXHRcdFx0XHRcdFx0XHRpZHggPSBtb2R1bGUuY2hpbGRyZW4uaW5kZXhPZihkZXBlbmRlbmN5KTtcblx0XHRcdFx0XHRcdFx0aWYgKGlkeCA+PSAwKSBtb2R1bGUuY2hpbGRyZW4uc3BsaWNlKGlkeCwgMSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRhcHBseTogZnVuY3Rpb24gKHJlcG9ydEVycm9yKSB7XG5cdFx0XHQvLyBpbnNlcnQgbmV3IGNvZGVcblx0XHRcdGZvciAodmFyIHVwZGF0ZU1vZHVsZUlkIGluIGFwcGxpZWRVcGRhdGUpIHtcblx0XHRcdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubyhhcHBsaWVkVXBkYXRlLCB1cGRhdGVNb2R1bGVJZCkpIHtcblx0XHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bdXBkYXRlTW9kdWxlSWRdID0gYXBwbGllZFVwZGF0ZVt1cGRhdGVNb2R1bGVJZF07XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gcnVuIG5ldyBydW50aW1lIG1vZHVsZXNcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgY3VycmVudFVwZGF0ZVJ1bnRpbWUubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0Y3VycmVudFVwZGF0ZVJ1bnRpbWVbaV0oX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNhbGwgYWNjZXB0IGhhbmRsZXJzXG5cdFx0XHRmb3IgKHZhciBvdXRkYXRlZE1vZHVsZUlkIGluIG91dGRhdGVkRGVwZW5kZW5jaWVzKSB7XG5cdFx0XHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm8ob3V0ZGF0ZWREZXBlbmRlbmNpZXMsIG91dGRhdGVkTW9kdWxlSWQpKSB7XG5cdFx0XHRcdFx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19yZXF1aXJlX18uY1tvdXRkYXRlZE1vZHVsZUlkXTtcblx0XHRcdFx0XHRpZiAobW9kdWxlKSB7XG5cdFx0XHRcdFx0XHRtb2R1bGVPdXRkYXRlZERlcGVuZGVuY2llcyA9XG5cdFx0XHRcdFx0XHRcdG91dGRhdGVkRGVwZW5kZW5jaWVzW291dGRhdGVkTW9kdWxlSWRdO1xuXHRcdFx0XHRcdFx0dmFyIGNhbGxiYWNrcyA9IFtdO1xuXHRcdFx0XHRcdFx0dmFyIGRlcGVuZGVuY2llc0ZvckNhbGxiYWNrcyA9IFtdO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBtb2R1bGVPdXRkYXRlZERlcGVuZGVuY2llcy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0XHR2YXIgZGVwZW5kZW5jeSA9IG1vZHVsZU91dGRhdGVkRGVwZW5kZW5jaWVzW2pdO1xuXHRcdFx0XHRcdFx0XHR2YXIgYWNjZXB0Q2FsbGJhY2sgPVxuXHRcdFx0XHRcdFx0XHRcdG1vZHVsZS5ob3QuX2FjY2VwdGVkRGVwZW5kZW5jaWVzW2RlcGVuZGVuY3ldO1xuXHRcdFx0XHRcdFx0XHRpZiAoYWNjZXB0Q2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoY2FsbGJhY2tzLmluZGV4T2YoYWNjZXB0Q2FsbGJhY2spICE9PSAtMSkgY29udGludWU7XG5cdFx0XHRcdFx0XHRcdFx0Y2FsbGJhY2tzLnB1c2goYWNjZXB0Q2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0XHRcdGRlcGVuZGVuY2llc0ZvckNhbGxiYWNrcy5wdXNoKGRlcGVuZGVuY3kpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBrID0gMDsgayA8IGNhbGxiYWNrcy5sZW5ndGg7IGsrKykge1xuXHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdGNhbGxiYWNrc1trXS5jYWxsKG51bGwsIG1vZHVsZU91dGRhdGVkRGVwZW5kZW5jaWVzKTtcblx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9wdGlvbnMub25FcnJvcmVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRvcHRpb25zLm9uRXJyb3JlZCh7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6IFwiYWNjZXB0LWVycm9yZWRcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0bW9kdWxlSWQ6IG91dGRhdGVkTW9kdWxlSWQsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGRlcGVuZGVuY3lJZDogZGVwZW5kZW5jaWVzRm9yQ2FsbGJhY2tzW2tdLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRlcnJvcjogZXJyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCFvcHRpb25zLmlnbm9yZUVycm9yZWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHJlcG9ydEVycm9yKGVycik7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIExvYWQgc2VsZiBhY2NlcHRlZCBtb2R1bGVzXG5cdFx0XHRmb3IgKHZhciBvID0gMDsgbyA8IG91dGRhdGVkU2VsZkFjY2VwdGVkTW9kdWxlcy5sZW5ndGg7IG8rKykge1xuXHRcdFx0XHR2YXIgaXRlbSA9IG91dGRhdGVkU2VsZkFjY2VwdGVkTW9kdWxlc1tvXTtcblx0XHRcdFx0dmFyIG1vZHVsZUlkID0gaXRlbS5tb2R1bGU7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0aXRlbS5yZXF1aXJlKG1vZHVsZUlkKTtcblx0XHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBpdGVtLmVycm9ySGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRpdGVtLmVycm9ySGFuZGxlcihlcnIpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyMikge1xuXHRcdFx0XHRcdFx0XHRpZiAob3B0aW9ucy5vbkVycm9yZWQpIHtcblx0XHRcdFx0XHRcdFx0XHRvcHRpb25zLm9uRXJyb3JlZCh7XG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiBcInNlbGYtYWNjZXB0LWVycm9yLWhhbmRsZXItZXJyb3JlZFwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0bW9kdWxlSWQ6IG1vZHVsZUlkLFxuXHRcdFx0XHRcdFx0XHRcdFx0ZXJyb3I6IGVycjIsXG5cdFx0XHRcdFx0XHRcdFx0XHRvcmlnaW5hbEVycm9yOiBlcnJcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAoIW9wdGlvbnMuaWdub3JlRXJyb3JlZCkge1xuXHRcdFx0XHRcdFx0XHRcdHJlcG9ydEVycm9yKGVycjIpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJlcG9ydEVycm9yKGVycik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmIChvcHRpb25zLm9uRXJyb3JlZCkge1xuXHRcdFx0XHRcdFx0XHRvcHRpb25zLm9uRXJyb3JlZCh7XG5cdFx0XHRcdFx0XHRcdFx0dHlwZTogXCJzZWxmLWFjY2VwdC1lcnJvcmVkXCIsXG5cdFx0XHRcdFx0XHRcdFx0bW9kdWxlSWQ6IG1vZHVsZUlkLFxuXHRcdFx0XHRcdFx0XHRcdGVycm9yOiBlcnJcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoIW9wdGlvbnMuaWdub3JlRXJyb3JlZCkge1xuXHRcdFx0XHRcdFx0XHRyZXBvcnRFcnJvcihlcnIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gb3V0ZGF0ZWRNb2R1bGVzO1xuXHRcdH1cblx0fTtcbn1cbl9fd2VicGFja19yZXF1aXJlX18uaG1ySS5qc29ucCA9IGZ1bmN0aW9uIChtb2R1bGVJZCwgYXBwbHlIYW5kbGVycykge1xuXHRpZiAoIWN1cnJlbnRVcGRhdGUpIHtcblx0XHRjdXJyZW50VXBkYXRlID0ge307XG5cdFx0Y3VycmVudFVwZGF0ZVJ1bnRpbWUgPSBbXTtcblx0XHRjdXJyZW50VXBkYXRlUmVtb3ZlZENodW5rcyA9IFtdO1xuXHRcdGFwcGx5SGFuZGxlcnMucHVzaChhcHBseUhhbmRsZXIpO1xuXHR9XG5cdGlmICghX193ZWJwYWNrX3JlcXVpcmVfXy5vKGN1cnJlbnRVcGRhdGUsIG1vZHVsZUlkKSkge1xuXHRcdGN1cnJlbnRVcGRhdGVbbW9kdWxlSWRdID0gX193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXTtcblx0fVxufTtcbl9fd2VicGFja19yZXF1aXJlX18uaG1yQy5qc29ucCA9IGZ1bmN0aW9uIChcblx0Y2h1bmtJZHMsXG5cdHJlbW92ZWRDaHVua3MsXG5cdHJlbW92ZWRNb2R1bGVzLFxuXHRwcm9taXNlcyxcblx0YXBwbHlIYW5kbGVycyxcblx0dXBkYXRlZE1vZHVsZXNMaXN0XG4pIHtcblx0YXBwbHlIYW5kbGVycy5wdXNoKGFwcGx5SGFuZGxlcik7XG5cdGN1cnJlbnRVcGRhdGVDaHVua3MgPSB7fTtcblx0Y3VycmVudFVwZGF0ZVJlbW92ZWRDaHVua3MgPSByZW1vdmVkQ2h1bmtzO1xuXHRjdXJyZW50VXBkYXRlID0gcmVtb3ZlZE1vZHVsZXMucmVkdWNlKGZ1bmN0aW9uIChvYmosIGtleSkge1xuXHRcdG9ialtrZXldID0gZmFsc2U7XG5cdFx0cmV0dXJuIG9iajtcblx0fSwge30pO1xuXHRjdXJyZW50VXBkYXRlUnVudGltZSA9IFtdO1xuXHRjaHVua0lkcy5mb3JFYWNoKGZ1bmN0aW9uIChjaHVua0lkKSB7XG5cdFx0aWYgKFxuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiZcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSAhPT0gdW5kZWZpbmVkXG5cdFx0KSB7XG5cdFx0XHRwcm9taXNlcy5wdXNoKGxvYWRVcGRhdGVDaHVuayhjaHVua0lkLCB1cGRhdGVkTW9kdWxlc0xpc3QpKTtcblx0XHRcdGN1cnJlbnRVcGRhdGVDaHVua3NbY2h1bmtJZF0gPSB0cnVlO1xuXHRcdH1cblx0fSk7XG5cdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmYpIHtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmYuanNvbnBIbXIgPSBmdW5jdGlvbiAoY2h1bmtJZCwgcHJvbWlzZXMpIHtcblx0XHRcdGlmIChcblx0XHRcdFx0Y3VycmVudFVwZGF0ZUNodW5rcyAmJlxuXHRcdFx0XHQhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGN1cnJlbnRVcGRhdGVDaHVua3MsIGNodW5rSWQpICYmXG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmXG5cdFx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSAhPT0gdW5kZWZpbmVkXG5cdFx0XHQpIHtcblx0XHRcdFx0cHJvbWlzZXMucHVzaChsb2FkVXBkYXRlQ2h1bmsoY2h1bmtJZCkpO1xuXHRcdFx0XHRjdXJyZW50VXBkYXRlQ2h1bmtzW2NodW5rSWRdID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9O1xuXHR9XG59O1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmhtck0gPSAoKSA9PiB7XG5cdGlmICh0eXBlb2YgZmV0Y2ggPT09IFwidW5kZWZpbmVkXCIpIHRocm93IG5ldyBFcnJvcihcIk5vIGJyb3dzZXIgc3VwcG9ydDogbmVlZCBmZXRjaCBBUElcIik7XG5cdHJldHVybiBmZXRjaChfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLmhtckYoKSkudGhlbigocmVzcG9uc2UpID0+IHtcblx0XHRpZihyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkgcmV0dXJuOyAvLyBubyB1cGRhdGUgYXZhaWxhYmxlXG5cdFx0aWYoIXJlc3BvbnNlLm9rKSB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXBkYXRlIG1hbmlmZXN0IFwiICsgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG5cdFx0cmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcblx0fSk7XG59O1xuXG4vLyBubyBkZWZlcnJlZCBzdGFydHVwXG5cbi8vIG5vIGpzb25wIGZ1bmN0aW9uXG5cbi8vIG5vIGRlZmVycmVkIHN0YXJ0dXAiLCIvLyBtb2R1bGUgY2FjaGUgYXJlIHVzZWQgc28gZW50cnkgaW5saW5pbmcgaXMgZGlzYWJsZWRcbi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwiLi9zcmMvdHMvbWFpbi50c1wiKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=